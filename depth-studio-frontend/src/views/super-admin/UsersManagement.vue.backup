<template>
  <v-container fluid>
    <!-- Page Header -->
    <v-row class="mb-6">
      <v-col cols="12">
        <div class="d-flex align-center justify-space-between mb-4">
          <div>
            <h1 class="text-h4 font-weight-bold text-primary">
              <v-icon start size="32">mdi-account-group</v-icon>
              Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…ÙŠÙ†
            </h1>
            <p class="text-subtitle-1 text-medium-emphasis mt-2">
              Ù…Ø±Ø§Ø¬Ø¹Ø© Ø§Ù„Ø·Ù„Ø¨Ø§Øª Ø§Ù„Ø¬Ø¯ÙŠØ¯Ø© ÙˆØ¥Ø¯Ø§Ø±Ø© Ø¬Ù…ÙŠØ¹ Ù…Ø³ØªØ®Ø¯Ù…ÙŠ Ø§Ù„Ù†Ø¸Ø§Ù…
            </p>
          </div>
          
          <!-- Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª Ø³Ø±ÙŠØ¹Ø© -->
          <div class="d-flex ga-4">
            <v-card variant="outlined" class="pa-3 text-center" min-width="100">
              <div class="text-h6 font-weight-bold text-primary">{{ stats.total }}</div>
              <div class="text-caption">Ø§Ù„Ù…Ø¬Ù…ÙˆØ¹</div>
            </v-card>
            <v-card variant="outlined" class="pa-3 text-center" min-width="100">
              <div class="text-h6 font-weight-bold text-success">{{ stats.active }}</div>
              <div class="text-caption">Ù†Ø´Ø·</div>
            </v-card>
            <v-card variant="outlined" class="pa-3 text-center" min-width="100">
              <div class="text-h6 font-weight-bold text-warning">{{ stats.pending }}</div>
              <div class="text-caption">Ù…Ø¹Ù„Ù‚</div>
            </v-card>
          </div>
        </div>
      </v-col>
    </v-row>

    <!-- Tabs Navigation -->
    <v-row>
      <v-col cols="12">
        <v-card elevation="2">
          <v-tabs
            v-model="currentTab"
            bg-color="primary"
            color="white"
            fixed-tabs
            show-arrows
          >
            <v-tab value="pending" class="font-weight-bold">
              <v-icon start>mdi-clock-alert</v-icon>
              Ø·Ù„Ø¨Ø§Øª Ù…Ø¹Ù„Ù‚Ø©
              <v-chip 
                v-if="pendingUsers.length > 0"
                color="error"
                size="small"
                class="ms-2"
              >
                {{ pendingUsers.length }}
              </v-chip>
            </v-tab>
            
            <v-tab value="active" class="font-weight-bold">
              <v-icon start>mdi-check-circle</v-icon>
              Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…ÙˆÙ† Ø§Ù„Ù†Ø´Ø·ÙˆÙ†
            </v-tab>
            
            <v-tab value="all" class="font-weight-bold">
              <v-icon start>mdi-account-multiple</v-icon>
              Ø¬Ù…ÙŠØ¹ Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…ÙŠÙ†
            </v-tab>
            
            <v-tab value="reports" class="font-weight-bold">
              <v-icon start>mdi-chart-line</v-icon>
              Ø§Ù„ØªÙ‚Ø§Ø±ÙŠØ±
            </v-tab>
          </v-tabs>

          <!-- Tab Content -->
          <v-card-text class="pa-6">
            <!-- Pending Approvals Tab -->
            <div v-if="currentTab === 'pending'">
              <!-- Header with bulk actions -->
              <div class="d-flex align-center justify-space-between mb-6">
                <h2 class="text-h5 font-weight-bold">
                  Ø·Ù„Ø¨Ø§Øª Ø§Ù„ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ù…Ø¹Ù„Ù‚Ø© ({{ pendingUsers.length }})
                </h2>
                
                <div class="d-flex ga-2" v-if="pendingUsers.length > 0">
                  <v-btn 
                    color="success"
                    prepend-icon="mdi-check-all"
                    :disabled="selectedUsers.length === 0 || isProcessing"
                    @click="approveBulk"
                  >
                    Ù…ÙˆØ§ÙÙ‚Ø© Ø§Ù„Ù…Ø­Ø¯Ø¯ ({{ selectedUsers.length }})
                  </v-btn>
                  
                  <v-btn 
                    color="error"
                    variant="outlined"
                    prepend-icon="mdi-close-circle"
                    :disabled="selectedUsers.length === 0 || isProcessing"
                    @click="rejectBulk"
                  >
                    Ø±ÙØ¶ Ø§Ù„Ù…Ø­Ø¯Ø¯
                  </v-btn>
                </div>
              </div>

              <!-- Pending Users List -->
              <div v-if="pendingUsers.length === 0" class="text-center py-8">
                <v-icon size="64" color="success" class="mb-4">mdi-check-all</v-icon>
                <h3 class="text-h5 mb-2">Ù„Ø§ ØªÙˆØ¬Ø¯ Ø·Ù„Ø¨Ø§Øª Ù…Ø¹Ù„Ù‚Ø©!</h3>
                <p class="text-body-1 text-medium-emphasis">
                  Ø¬Ù…ÙŠØ¹ Ø·Ù„Ø¨Ø§Øª Ø§Ù„ØªØ³Ø¬ÙŠÙ„ ØªÙ…Øª Ù…Ø±Ø§Ø¬Ø¹ØªÙ‡Ø§ Ø¨Ù†Ø¬Ø§Ø­.
                </p>
              </div>

              <v-row v-else>
                <v-col 
                  v-for="user in pendingUsers" 
                  :key="user.id" 
                  cols="12" 
                  md="6" 
                  lg="4"
                >
                  <v-card
                    elevation="3"
                    class="pending-user-card"
                    :class="{ 'selected': selectedUsers.includes(user.id) }"
                  >
                    <!-- Card Header -->
                    <v-card-title class="pb-2">
                      <div class="d-flex align-center justify-space-between w-100">
                        <div class="d-flex align-center">
                          <v-checkbox
                            v-model="selectedUsers"
                            :value="user.id"
                            color="primary"
                            hide-details
                            class="ms-2"
                          />
                          <div>
                            <h3 class="text-h6">{{ user.display_name || user.full_name }}</h3>
                            <p class="text-caption text-medium-emphasis">{{ user.email }}</p>
                          </div>
                        </div>
                        
                        <v-chip 
                          :color="getRoleColor(user.primary_role)"
                          size="small"
                          variant="outlined"
                        >
                          <v-icon start size="12">{{ getRoleIcon(user.primary_role) }}</v-icon>
                          {{ getRoleName(user.primary_role) }}
                        </v-chip>
                      </div>
                    </v-card-title>

                    <!-- Card Content -->
                    <v-card-text>
                      <!-- Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø¥Ø¶Ø§ÙÙŠØ© Ø­Ø³Ø¨ Ø§Ù„Ø¯ÙˆØ± -->
                      <div v-if="user.primary_role === 'brand_coordinator'" class="mb-3">
                        <v-alert type="info" variant="outlined" density="compact">
                          <strong>Ø¨Ø±Ø§Ù†Ø¯ Ù…Ø·Ù„ÙˆØ¨:</strong> {{ getBrandName(user.requested_brand_id) }}
                        </v-alert>
                        
                        <v-expansion-panels variant="accordion" class="mt-2">
                          <v-expansion-panel>
                            <v-expansion-panel-title>
                              <v-icon start>mdi-text</v-icon>
                              Ø§Ù„Ø®Ø¨Ø±Ø© ÙˆØ§Ù„Ù…Ø¤Ù‡Ù„Ø§Øª
                            </v-expansion-panel-title>
                            <v-expansion-panel-text>
                              <p class="text-body-2">{{ user.brand_experience || 'Ù„Ù… ÙŠØªÙ… ØªÙ‚Ø¯ÙŠÙ… Ù…Ø¹Ù„ÙˆÙ…Ø§Øª' }}</p>
                              <p class="text-caption mt-2">
                                <strong>Ø³Ù†ÙˆØ§Øª Ø§Ù„Ø®Ø¨Ø±Ø©:</strong> {{ user.previous_experience_years || 0 }} Ø³Ù†Ø©
                              </p>
                            </v-expansion-panel-text>
                          </v-expansion-panel>
                        </v-expansion-panels>
                      </div>

                      <div v-if="user.primary_role === 'marketing_coordinator'" class="mb-3">
                        <v-alert type="warning" variant="outlined" density="compact">
                          <strong>ÙŠØ­ØªØ§Ø¬ Ù…ÙˆØ§ÙÙ‚Ø© Ø®Ø§ØµØ©</strong>
                        </v-alert>
                        
                        <v-expansion-panels variant="accordion" class="mt-2">
                          <v-expansion-panel>
                            <v-expansion-panel-title>
                              <v-icon start>mdi-text</v-icon>
                              Ø³Ø¨Ø¨ Ø§Ù„Ø·Ù„Ø¨ ÙˆØ§Ù„Ø®Ø¨Ø±Ø©
                            </v-expansion-panel-title>
                            <v-expansion-panel-text>
                              <p class="text-body-2">{{ user.marketing_reason || 'Ù„Ù… ÙŠØªÙ… ØªÙ‚Ø¯ÙŠÙ… Ø³Ø¨Ø¨' }}</p>
                              <p class="text-caption mt-2">
                                <strong>Ø³Ù†ÙˆØ§Øª Ø§Ù„Ø®Ø¨Ø±Ø©:</strong> {{ user.marketing_experience_years || 0 }} Ø³Ù†Ø©
                              </p>
                              <div v-if="user.marketing_specializations?.length" class="mt-2">
                                <strong class="text-caption">Ø§Ù„ØªØ®ØµØµØ§Øª:</strong>
                                <v-chip-group class="mt-1">
                                  <v-chip 
                                    v-for="spec in user.marketing_specializations" 
                                    :key="spec" 
                                    size="x-small"
                                    variant="outlined"
                                  >
                                    {{ getSpecializationName(spec) }}
                                  </v-chip>
                                </v-chip-group>
                              </div>
                            </v-expansion-panel-text>
                          </v-expansion-panel>
                        </v-expansion-panels>
                      </div>

                      <!-- Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø¹Ø§Ù…Ø© -->
                      <div class="d-flex justify-space-between text-caption text-medium-emphasis mb-3">
                        <span>ØªØ§Ø±ÙŠØ® Ø§Ù„ØªØ³Ø¬ÙŠÙ„: {{ formatDate(user.created_at) }}</span>
                        <span v-if="user.phone">ğŸ“± {{ user.phone }}</span>
                      </div>
                    </v-card-text>

                    <!-- Card Actions -->
                    <v-card-actions class="pt-0">
                      <v-btn
                        color="success"
                        variant="flat"
                        size="small"
                        :loading="isProcessing && processingUsers.includes(user.id)"
                        @click="approveUser(user)"
                      >
                        <v-icon start size="16">mdi-check</v-icon>
                        Ù…ÙˆØ§ÙÙ‚Ø©
                      </v-btn>
                      
                      <v-btn
                        color="error"
                        variant="outlined"
                        size="small"
                        :loading="isProcessing && processingUsers.includes(user.id)"
                        @click="showRejectDialog(user)"
                      >
                        <v-icon start size="16">mdi-close</v-icon>
                        Ø±ÙØ¶
                      </v-btn>
                      
                      <v-spacer />
                      
                      <v-btn
                        color="grey"
                        variant="text"
                        size="small"
                        @click="viewUserDetails(user)"
                      >
                        <v-icon start size="16">mdi-eye</v-icon>
                        Ø§Ù„ØªÙØ§ØµÙŠÙ„
                      </v-btn>
                    </v-card-actions>
                  </v-card>
                </v-col>
              </v-row>
            </div>

            <!-- Active Users Tab -->
            <div v-if="currentTab === 'active'">
              <div class="d-flex align-center justify-space-between mb-6">
                <h2 class="text-h5 font-weight-bold">
                  Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…ÙˆÙ† Ø§Ù„Ù†Ø´Ø·ÙˆÙ† ({{ activeUsers.length }})
                </h2>
                
                <!-- Ø®ÙŠØ§Ø±Ø§Øª Ø³Ø±ÙŠØ¹Ø© Ù„Ù„Ù…Ø³ØªØ®Ø¯Ù…ÙŠÙ† Ø§Ù„Ù†Ø´Ø·ÙŠÙ† -->
                <div class="d-flex ga-2">
                  <v-text-field
                    v-model="activeUsersSearch"
                    prepend-inner-icon="mdi-magnify"
                    label="Ø§Ù„Ø¨Ø­Ø« ÙÙŠ Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…ÙŠÙ† Ø§Ù„Ù†Ø´Ø·ÙŠÙ†..."
                    variant="outlined"
                    density="compact"
                    hide-details
                    clearable
                    style="max-width: 300px;"
                  />
                  <v-btn 
                    color="primary"
                    prepend-icon="mdi-refresh"
                    @click="loadAllUsers"
                    :loading="isProcessing"
                  >
                    ØªØ­Ø¯ÙŠØ«
                  </v-btn>
                </div>
              </div>

              <!-- Ø¬Ø¯ÙˆÙ„ Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…ÙŠÙ† Ø§Ù„Ù†Ø´Ø·ÙŠÙ† -->
              <v-card elevation="2" class="users-table-card">
                <v-data-table
                  :headers="activeUsersHeaders"
                  :items="activeUsers"
                  :search="activeUsersSearch"
                  :items-per-page="10"
                  :items-per-page-options="[5, 10, 25, 50]"
                  class="elevation-0"
                  item-value="id"
                  show-current-page
                >
                  <!-- Ø±Ø£Ø³ Ø§Ù„Ø¬Ø¯ÙˆÙ„ Ù…Ø®ØµØµ -->
                  <template v-slot:top>
                    <v-toolbar flat color="surface">
                      <v-toolbar-title class="text-h6 font-weight-bold">
                        <v-icon start color="success">mdi-check-circle</v-icon>
                        Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…ÙˆÙ† Ø§Ù„Ù…ÙØ¹Ù„ÙˆÙ†
                      </v-toolbar-title>
                      <v-spacer></v-spacer>
                      <v-chip color="success" variant="outlined">
                        {{ activeUsers.length }} Ù…Ø³ØªØ®Ø¯Ù… Ù†Ø´Ø·
                      </v-chip>
                    </v-toolbar>
                    <v-divider></v-divider>
                  </template>

                  <!-- Ø¹Ù…ÙˆØ¯ Ø§Ù„ØµÙˆØ±Ø© ÙˆØ§Ù„Ø§Ø³Ù… -->
                  <template v-slot:item.user_info="{ item }">
                    <div class="d-flex align-center py-2">
                      <v-avatar size="40" class="me-3">
                        <v-img 
                          :src="item.profile_photo_url" 
                          :alt="item.display_name"
                          v-if="item.profile_photo_url"
                        />
                        <v-icon v-else size="24" color="grey">mdi-account-circle</v-icon>
                      </v-avatar>
                      <div>
                        <div class="text-body-1 font-weight-medium">
                          {{ item.display_name || item.full_name }}
                        </div>
                        <div class="text-caption text-medium-emphasis">
                          {{ item.email }}
                        </div>
                      </div>
                    </div>
                  </template>

                  <!-- Ø¹Ù…ÙˆØ¯ Ø§Ù„Ø¯ÙˆØ± -->
                  <template v-slot:item.primary_role="{ item }">
                    <v-chip 
                      :color="getRoleColor(item.primary_role)"
                      variant="tonal"
                      size="small"
                      class="font-weight-medium"
                    >
                      <v-icon start size="16">{{ getRoleIcon(item.primary_role) }}</v-icon>
                      {{ getRoleName(item.primary_role) }}
                    </v-chip>
                  </template>

                  <!-- Ø¹Ù…ÙˆØ¯ Ø§Ù„Ù‡Ø§ØªÙ -->
                  <template v-slot:item.phone="{ item }">
                    <div v-if="item.phone" class="d-flex align-center">
                      <v-icon size="16" color="success" class="me-1">mdi-phone</v-icon>
                      <span class="text-body-2">{{ item.phone }}</span>
                    </div>
                    <span v-else class="text-caption text-medium-emphasis">ØºÙŠØ± Ù…Ø­Ø¯Ø¯</span>
                  </template>

                  <!-- Ø¹Ù…ÙˆØ¯ ØªØ§Ø±ÙŠØ® Ø§Ù„ØªÙØ¹ÙŠÙ„ -->
                  <template v-slot:item.approved_at="{ item }">
                    <div v-if="item.approved_at">
                      <div class="text-body-2">{{ formatDate(item.approved_at) }}</div>
                      <div class="text-caption text-success">Ù…ÙØ¹Ù„</div>
                    </div>
                    <div v-else>
                      <div class="text-body-2">{{ formatDate(item.created_at) }}</div>
                      <div class="text-caption text-medium-emphasis">ØªØ§Ø±ÙŠØ® Ø§Ù„ØªØ³Ø¬ÙŠÙ„</div>
                    </div>
                  </template>

                  <!-- Ø¹Ù…ÙˆØ¯ Ø§Ù„Ø­Ø§Ù„Ø© -->
                  <template v-slot:item.status="{ item }">
                    <v-chip 
                      color="success"
                      variant="tonal"
                      size="small"
                      prepend-icon="mdi-check-circle"
                    >
                      Ù†Ø´Ø·
                    </v-chip>
                  </template>

                  <!-- Ø¹Ù…ÙˆØ¯ Ø§Ù„Ø¥Ø¬Ø±Ø§Ø¡Ø§Øª -->
                  <template v-slot:item.actions="{ item }">
                    <div class="d-flex ga-1">
                      <v-btn
                        icon
                        size="small"
                        color="primary"
                        variant="text"
                        @click="viewUserDetails(item)"
                      >
                        <v-icon size="18">mdi-eye</v-icon>
                        <v-tooltip activator="parent" location="top">Ø¹Ø±Ø¶ Ø§Ù„ØªÙØ§ØµÙŠÙ„</v-tooltip>
                      </v-btn>
                      
                      <v-btn
                        icon
                        size="small"
                        color="warning"
                        variant="text"
                        @click="editUser(item)"
                      >
                        <v-icon size="18">mdi-pencil</v-icon>
                        <v-tooltip activator="parent" location="top">ØªØ¹Ø¯ÙŠÙ„ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª</v-tooltip>
                      </v-btn>
                      
                      <v-btn
                        icon
                        size="small"
                        color="error"
                        variant="text"
                        @click="suspendUser(item)"
                      >
                        <v-icon size="18">mdi-pause-circle</v-icon>
                        <v-tooltip activator="parent" location="top">ØªØ¹Ù„ÙŠÙ‚ Ø§Ù„Ø­Ø³Ø§Ø¨</v-tooltip>
                      </v-btn>
                    </div>
                  </template>

                  <!-- Ø±Ø³Ø§Ù„Ø© Ø¹Ø¯Ù… ÙˆØ¬ÙˆØ¯ Ø¨ÙŠØ§Ù†Ø§Øª -->
                  <template v-slot:no-data>
                    <div class="text-center py-8">
                      <v-icon size="64" color="grey" class="mb-4">mdi-account-off</v-icon>
                      <h3 class="text-h6 mb-2">Ù„Ø§ ÙŠÙˆØ¬Ø¯ Ù…Ø³ØªØ®Ø¯Ù…ÙˆÙ† Ù†Ø´Ø·ÙˆÙ†</h3>
                      <p class="text-body-2 text-medium-emphasis">
                        Ù„Ù… ÙŠØªÙ… ØªÙØ¹ÙŠÙ„ Ø£ÙŠ Ù…Ø³ØªØ®Ø¯Ù…ÙŠÙ† Ø¨Ø¹Ø¯.
                      </p>
                    </div>
                  </template>
                </v-data-table>
              </v-card>
            </div>

            <!-- All Users Tab -->
            <div v-if="currentTab === 'all'">
              <div class="d-flex align-center justify-space-between mb-6">
                <h2 class="text-h5 font-weight-bold">
                  Ø¬Ù…ÙŠØ¹ Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…ÙŠÙ† ({{ filteredAllUsers.length }} Ù…Ù† {{ allUsers.length }})
                </h2>
                
                <!-- Ø£Ø¯ÙˆØ§Øª Ø§Ù„ØªØ­ÙƒÙ… ÙˆØ§Ù„ÙÙ„ØªØ±Ø© -->
                <div class="d-flex ga-2 flex-wrap">
                  <v-text-field
                    v-model="allUsersSearch"
                    prepend-inner-icon="mdi-magnify"
                    label="Ø§Ù„Ø¨Ø­Ø« Ø§Ù„Ø¹Ø§Ù…..."
                    variant="outlined"
                    density="compact"
                    hide-details
                    clearable
                    style="max-width: 250px;"
                  />
                  
                  <v-select
                    v-model="statusFilter"
                    :items="statusFilterOptions"
                    label="Ø§Ù„Ø­Ø§Ù„Ø©"
                    variant="outlined"
                    density="compact"
                    hide-details
                    clearable
                    style="max-width: 150px;"
                  />
                  
                  <v-select
                    v-model="roleFilter"
                    :items="roleFilterOptions"
                    label="Ø§Ù„Ø¯ÙˆØ±"
                    variant="outlined"
                    density="compact"
                    hide-details
                    clearable
                    style="max-width: 150px;"
                  />
                  
                  <v-btn 
                    color="primary"
                    prepend-icon="mdi-refresh"
                    @click="loadAllUsers"
                    :loading="isProcessing"
                  >
                    ØªØ­Ø¯ÙŠØ«
                  </v-btn>
                </div>
              </div>

              <!-- Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª Ø³Ø±ÙŠØ¹Ø© -->
              <v-row class="mb-4">
                <v-col cols="12" sm="6" md="3">
                  <v-card variant="outlined" class="pa-3 text-center">
                    <div class="text-h6 font-weight-bold text-success">{{ activeUsers.length }}</div>
                    <div class="text-caption">Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…ÙˆÙ† Ø§Ù„Ù†Ø´Ø·ÙˆÙ†</div>
                  </v-card>
                </v-col>
                <v-col cols="12" sm="6" md="3">
                  <v-card variant="outlined" class="pa-3 text-center">
                    <div class="text-h6 font-weight-bold text-warning">{{ pendingUsers.length }}</div>
                    <div class="text-caption">ÙÙŠ Ø§Ù†ØªØ¸Ø§Ø± Ø§Ù„Ù…ÙˆØ§ÙÙ‚Ø©</div>
                  </v-card>
                </v-col>
                <v-col cols="12" sm="6" md="3">
                  <v-card variant="outlined" class="pa-3 text-center">
                    <div class="text-h6 font-weight-bold text-primary">{{ photographersCount }}</div>
                    <div class="text-caption">Ø§Ù„Ù…ØµÙˆØ±ÙˆÙ†</div>
                  </v-card>
                </v-col>
                <v-col cols="12" sm="6" md="3">
                  <v-card variant="outlined" class="pa-3 text-center">
                    <div class="text-h6 font-weight-bold text-info">{{ coordinatorsCount }}</div>
                    <div class="text-caption">Ø§Ù„Ù…Ù†Ø³Ù‚ÙˆÙ†</div>
                  </v-card>
                </v-col>
              </v-row>

              <!-- Ø¬Ø¯ÙˆÙ„ Ø¬Ù…ÙŠØ¹ Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…ÙŠÙ† -->
              <v-card elevation="2" class="users-table-card">
                <v-data-table
                  :headers="allUsersHeaders"
                  :items="filteredAllUsers"
                  :search="allUsersSearch"
                  :items-per-page="15"
                  :items-per-page-options="[10, 15, 25, 50, 100]"
                  class="elevation-0"
                  item-value="id"
                  show-current-page
                  show-select
                  v-model="selectedAllUsers"
                >
                  <!-- Ø±Ø£Ø³ Ø§Ù„Ø¬Ø¯ÙˆÙ„ Ù…Ø®ØµØµ -->
                  <template v-slot:top>
                    <v-toolbar flat color="surface">
                      <v-toolbar-title class="text-h6 font-weight-bold">
                        <v-icon start color="primary">mdi-account-multiple</v-icon>
                        Ø¬Ø¯ÙˆÙ„ Ø´Ø§Ù…Ù„ Ù„ÙƒØ§ÙØ© Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…ÙŠÙ†
                      </v-toolbar-title>
                      <v-spacer></v-spacer>
                      
                      <!-- Ø¥Ø¬Ø±Ø§Ø¡Ø§Øª Ø¬Ù…Ø§Ø¹ÙŠØ© -->
                      <div v-if="selectedAllUsers.length > 0" class="d-flex ga-2">
                        <v-chip color="primary" variant="outlined">
                          {{ selectedAllUsers.length }} Ù…Ø­Ø¯Ø¯
                        </v-chip>
                        <v-btn 
                          color="warning"
                          size="small"
                          prepend-icon="mdi-pause"
                          @click="bulkSuspendUsers"
                        >
                          ØªØ¹Ù„ÙŠÙ‚ Ø§Ù„Ù…Ø­Ø¯Ø¯
                        </v-btn>
                        <v-btn 
                          color="success"
                          size="small"
                          prepend-icon="mdi-play"
                          @click="bulkActivateUsers"
                        >
                          ØªÙØ¹ÙŠÙ„ Ø§Ù„Ù…Ø­Ø¯Ø¯
                        </v-btn>
                      </div>
                    </v-toolbar>
                    <v-divider></v-divider>
                  </template>

                  <!-- Ø¹Ù…ÙˆØ¯ Ø§Ù„ØµÙˆØ±Ø© ÙˆØ§Ù„Ø§Ø³Ù… -->
                  <template v-slot:item.user_info="{ item }">
                    <div class="d-flex align-center py-2">
                      <v-avatar size="36" class="me-3">
                        <v-img 
                          :src="item.profile_photo_url" 
                          :alt="item.display_name"
                          v-if="item.profile_photo_url"
                        />
                        <v-icon v-else size="20" color="grey">mdi-account-circle</v-icon>
                      </v-avatar>
                      <div>
                        <div class="text-body-2 font-weight-medium">
                          {{ item.display_name || item.full_name }}
                        </div>
                        <div class="text-caption text-medium-emphasis">
                          {{ item.email }}
                        </div>
                      </div>
                    </div>
                  </template>

                  <!-- Ø¹Ù…ÙˆØ¯ Ø§Ù„Ø¯ÙˆØ± -->
                  <template v-slot:item.primary_role="{ item }">
                    <v-chip 
                      :color="getRoleColor(item.primary_role)"
                      variant="tonal"
                      size="x-small"
                      class="font-weight-medium"
                    >
                      <v-icon start size="12">{{ getRoleIcon(item.primary_role) }}</v-icon>
                      {{ getRoleName(item.primary_role) }}
                    </v-chip>
                  </template>

                  <!-- Ø¹Ù…ÙˆØ¯ Ø§Ù„Ø­Ø§Ù„Ø© -->
                  <template v-slot:item.status="{ item }">
                    <v-chip 
                      :color="getStatusColor(item.status)"
                      variant="tonal"
                      size="x-small"
                      :prepend-icon="getStatusIcon(item.status)"
                    >
                      {{ getStatusName(item.status) }}
                    </v-chip>
                  </template>

                  <!-- Ø¹Ù…ÙˆØ¯ Ø§Ù„Ù‡Ø§ØªÙ -->
                  <template v-slot:item.phone="{ item }">
                    <span v-if="item.phone" class="text-body-2">{{ item.phone }}</span>
                    <span v-else class="text-caption text-medium-emphasis">ØºÙŠØ± Ù…Ø­Ø¯Ø¯</span>
                  </template>

                  <!-- Ø¹Ù…ÙˆØ¯ ØªØ§Ø±ÙŠØ® Ø§Ù„ØªØ³Ø¬ÙŠÙ„ -->
                  <template v-slot:item.created_at="{ item }">
                    <div class="text-body-2">{{ formatDate(item.created_at) }}</div>
                    <div class="text-caption text-medium-emphasis">
                      {{ getTimeDifference(item.created_at) }}
                    </div>
                  </template>

                  <!-- Ø¹Ù…ÙˆØ¯ Ø§Ù„Ø¥Ø¬Ø±Ø§Ø¡Ø§Øª -->
                  <template v-slot:item.actions="{ item }">
                    <div class="d-flex ga-1">
                      <v-btn
                        icon
                        size="x-small"
                        color="primary"
                        variant="text"
                        @click="viewUserDetails(item)"
                      >
                        <v-icon size="16">mdi-eye</v-icon>
                        <v-tooltip activator="parent" location="top">Ø§Ù„ØªÙØ§ØµÙŠÙ„</v-tooltip>
                      </v-btn>
                      
                      <v-btn
                        icon
                        size="x-small"
                        color="warning"
                        variant="text"
                        @click="editUser(item)"
                        v-if="item.status === 'active'"
                      >
                        <v-icon size="16">mdi-pencil</v-icon>
                        <v-tooltip activator="parent" location="top">ØªØ¹Ø¯ÙŠÙ„</v-tooltip>
                      </v-btn>
                      
                      <v-btn
                        icon
                        size="x-small"
                        :color="item.status === 'active' ? 'error' : 'success'"
                        variant="text"
                        @click="toggleUserStatus(item)"
                        v-if="item.status !== 'pending_approval'"
                      >
                        <v-icon size="16">
                          {{ item.status === 'active' ? 'mdi-pause' : 'mdi-play' }}
                        </v-icon>
                        <v-tooltip activator="parent" location="top">
                          {{ item.status === 'active' ? 'ØªØ¹Ù„ÙŠÙ‚' : 'ØªÙØ¹ÙŠÙ„' }}
                        </v-tooltip>
                      </v-btn>
                      
                      <v-btn
                        icon
                        size="x-small"
                        color="success"
                        variant="text"
                        @click="approveUser(item)"
                        v-if="item.status === 'pending_approval'"
                      >
                        <v-icon size="16">mdi-check</v-icon>
                        <v-tooltip activator="parent" location="top">Ù…ÙˆØ§ÙÙ‚Ø©</v-tooltip>
                      </v-btn>
                    </div>
                  </template>

                  <!-- Ø±Ø³Ø§Ù„Ø© Ø¹Ø¯Ù… ÙˆØ¬ÙˆØ¯ Ø¨ÙŠØ§Ù†Ø§Øª -->
                  <template v-slot:no-data>
                    <div class="text-center py-8">
                      <v-icon size="64" color="grey" class="mb-4">mdi-database-search</v-icon>
                      <h3 class="text-h6 mb-2">Ù„Ø§ ØªÙˆØ¬Ø¯ Ù†ØªØ§Ø¦Ø¬</h3>
                      <p class="text-body-2 text-medium-emphasis">
                        Ø¬Ø±Ø¨ ØªØºÙŠÙŠØ± Ù…Ø¹Ø§ÙŠÙŠØ± Ø§Ù„Ø¨Ø­Ø« Ø£Ùˆ Ø§Ù„ÙÙ„ØªØ±Ø©.
                      </p>
                    </div>
                  </template>
                </v-data-table>
              </v-card>
            </div>

            <!-- Reports Tab -->
            <div v-if="currentTab === 'reports'">
              <h2 class="text-h5 font-weight-bold mb-4">
                ØªÙ‚Ø§Ø±ÙŠØ± Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…ÙŠÙ†
              </h2>
              
              <!-- Reports would go here -->
              <v-alert type="info" variant="outlined">
                <v-icon start>mdi-information</v-icon>
                Ø§Ù„ØªÙ‚Ø§Ø±ÙŠØ± Ù‚ÙŠØ¯ Ø§Ù„ØªØ·ÙˆÙŠØ±...
              </v-alert>
            </div>
          </v-card-text>
        </v-card>
      </v-col>
    </v-row>

    <!-- Reject Dialog -->
    <v-dialog v-model="rejectDialog" max-width="500">
      <v-card>
        <v-card-title class="text-h5">
          <v-icon start color="error">mdi-alert-circle</v-icon>
          Ø±ÙØ¶ Ø·Ù„Ø¨ Ø§Ù„ØªØ³Ø¬ÙŠÙ„
        </v-card-title>
        <v-card-text>
          <p class="mb-4">
            Ù‡Ù„ Ø£Ù†Øª Ù…ØªØ£ÙƒØ¯ Ù…Ù† Ø±ÙØ¶ Ø·Ù„Ø¨ Ø§Ù„ØªØ³Ø¬ÙŠÙ„ Ù„Ù€ 
            <strong>{{ userToReject?.display_name }}</strong>ØŸ
          </p>
          
          <v-textarea
            v-model="rejectReason"
            label="Ø³Ø¨Ø¨ Ø§Ù„Ø±ÙØ¶ (Ø§Ø®ØªÙŠØ§Ø±ÙŠ)"
            variant="outlined"
            rows="3"
            placeholder="Ø§ÙƒØªØ¨ Ø§Ù„Ø³Ø¨Ø¨ Ù„ÙŠØªÙ… Ø¥Ø±Ø³Ø§Ù„Ù‡ Ù„Ù„Ù…Ø³ØªØ®Ø¯Ù…..."
          />
          
          <v-alert type="warning" variant="outlined" class="mt-3">
            <strong>ØªÙ†Ø¨ÙŠÙ‡:</strong> Ø³ÙŠØªÙ… Ø­Ø°Ù Ø§Ù„Ø­Ø³Ø§Ø¨ Ù†Ù‡Ø§Ø¦ÙŠØ§Ù‹ ÙˆÙ„Ù† ÙŠØªÙ…ÙƒÙ† Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… Ù…Ù† ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„.
          </v-alert>
        </v-card-text>
        <v-card-actions>
          <v-spacer />
          <v-btn color="grey" @click="rejectDialog = false">
            Ø¥Ù„ØºØ§Ø¡
          </v-btn>
          <v-btn 
            color="error" 
            :loading="isProcessing"
            @click="confirmReject"
          >
            ØªØ£ÙƒÙŠØ¯ Ø§Ù„Ø±ÙØ¶
          </v-btn>
        </v-card-actions>
      </v-card>
    </v-dialog>

    <!-- User Details Dialog -->
    <v-dialog v-model="detailsDialog" max-width="700" scrollable>
      <v-card>
        <v-card-title class="text-h5 bg-primary text-white">
          <v-icon start>mdi-account-details</v-icon>
          ØªÙØ§ØµÙŠÙ„ Ø·Ù„Ø¨ Ø§Ù„ØªØ³Ø¬ÙŠÙ„
          <v-spacer />
          <v-btn icon variant="text" @click="detailsDialog = false">
            <v-icon>mdi-close</v-icon>
          </v-btn>
        </v-card-title>
        
        <v-card-text class="pa-6" v-if="selectedUserForDetails">
          <!-- Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø£Ø³Ø§Ø³ÙŠØ© -->
          <v-card variant="outlined" class="mb-4">
            <v-card-title class="text-h6 bg-grey-lighten-4">
              <v-icon start>mdi-account</v-icon>
              Ø§Ù„Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø§Ù„Ø£Ø³Ø§Ø³ÙŠØ©
            </v-card-title>
            <v-card-text>
              <v-row>
                <v-col cols="12" md="6">
                  <div class="mb-3">
                    <strong>Ø§Ù„Ø§Ø³Ù… Ø§Ù„ÙƒØ§Ù…Ù„:</strong>
                    <p class="mt-1">{{ selectedUserForDetails.display_name || selectedUserForDetails.full_name }}</p>
                  </div>
                  <div class="mb-3">
                    <strong>Ø§Ù„Ø¨Ø±ÙŠØ¯ Ø§Ù„Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠ:</strong>
                    <p class="mt-1">{{ selectedUserForDetails.email }}</p>
                  </div>
                  <div class="mb-3">
                    <strong>Ø§Ù„Ù‡Ø§ØªÙ:</strong>
                    <p class="mt-1">{{ selectedUserForDetails.phone || 'ØºÙŠØ± Ù…Ø­Ø¯Ø¯' }}</p>
                  </div>
                </v-col>
                <v-col cols="12" md="6">
                  <div class="mb-3">
                    <strong>Ø§Ù„Ø¯ÙˆØ± Ø§Ù„Ù…Ø·Ù„ÙˆØ¨:</strong>
                    <v-chip 
                      :color="getRoleColor(selectedUserForDetails.primary_role)"
                      class="mt-1"
                    >
                      <v-icon start size="16">{{ getRoleIcon(selectedUserForDetails.primary_role) }}</v-icon>
                      {{ getRoleName(selectedUserForDetails.primary_role) }}
                    </v-chip>
                  </div>
                  <div class="mb-3">
                    <strong>ØªØ§Ø±ÙŠØ® Ø§Ù„ØªØ³Ø¬ÙŠÙ„:</strong>
                    <p class="mt-1">{{ formatDate(selectedUserForDetails.created_at) }}</p>
                  </div>
                  <div class="mb-3">
                    <strong>Ø·Ø±ÙŠÙ‚Ø© Ø§Ù„ØªØ³Ø¬ÙŠÙ„:</strong>
                    <v-chip size="small" variant="outlined" class="mt-1">
                      {{ selectedUserForDetails.auth_provider || 'email' }}
                    </v-chip>
                  </div>
                </v-col>
              </v-row>
            </v-card-text>
          </v-card>

          <!-- ØªÙØ§ØµÙŠÙ„ Ø®Ø§ØµØ© Ø¨Ø§Ù„Ø¯ÙˆØ± -->
          <v-card v-if="selectedUserForDetails.primary_role === 'brand_coordinator'" variant="outlined" class="mb-4">
            <v-card-title class="text-h6 bg-warning-lighten-4">
              <v-icon start>mdi-domain</v-icon>
              ØªÙØ§ØµÙŠÙ„ Ù…Ù†Ø³Ù‚ Ø§Ù„Ø¨Ø±Ø§Ù†Ø¯
            </v-card-title>
            <v-card-text>
              <div class="mb-3">
                <strong>Ø§Ù„Ø¨Ø±Ø§Ù†Ø¯ Ø§Ù„Ù…Ø·Ù„ÙˆØ¨:</strong>
                <p class="mt-1">{{ getBrandName(selectedUserForDetails.requested_brand_id) }}</p>
              </div>
              <div class="mb-3">
                <strong>Ø³Ù†ÙˆØ§Øª Ø§Ù„Ø®Ø¨Ø±Ø©:</strong>
                <p class="mt-1">{{ selectedUserForDetails.previous_experience_years || 0 }} Ø³Ù†Ø©</p>
              </div>
              <div class="mb-3">
                <strong>Ø§Ù„Ø®Ø¨Ø±Ø© ÙˆØ§Ù„Ù…Ø¤Ù‡Ù„Ø§Øª:</strong>
                <p class="mt-1">{{ selectedUserForDetails.brand_experience || 'Ù„Ù… ÙŠØªÙ… ØªÙ‚Ø¯ÙŠÙ… Ù…Ø¹Ù„ÙˆÙ…Ø§Øª' }}</p>
              </div>
            </v-card-text>
          </v-card>

          <v-card v-if="selectedUserForDetails.primary_role === 'marketing_coordinator'" variant="outlined" class="mb-4">
            <v-card-title class="text-h6 bg-error-lighten-4">
              <v-icon start>mdi-bullhorn</v-icon>
              ØªÙØ§ØµÙŠÙ„ Ù…Ù†Ø³Ù‚ Ø§Ù„ØªØ³ÙˆÙŠÙ‚
            </v-card-title>
            <v-card-text>
              <div class="mb-3">
                <strong>Ø³Ù†ÙˆØ§Øª Ø§Ù„Ø®Ø¨Ø±Ø© ÙÙŠ Ø§Ù„ØªØ³ÙˆÙŠÙ‚:</strong>
                <p class="mt-1">{{ selectedUserForDetails.marketing_experience_years || 0 }} Ø³Ù†Ø©</p>
              </div>
              <div class="mb-3">
                <strong>Ø³Ø¨Ø¨ Ø·Ù„Ø¨ Ø§Ù„Ø¯ÙˆØ±:</strong>
                <p class="mt-1">{{ selectedUserForDetails.marketing_reason || 'Ù„Ù… ÙŠØªÙ… ØªÙ‚Ø¯ÙŠÙ… Ø³Ø¨Ø¨' }}</p>
              </div>
              <div v-if="selectedUserForDetails.marketing_specializations?.length" class="mb-3">
                <strong>Ø§Ù„ØªØ®ØµØµØ§Øª Ø§Ù„ØªØ³ÙˆÙŠÙ‚ÙŠØ©:</strong>
                <v-chip-group class="mt-2">
                  <v-chip 
                    v-for="spec in selectedUserForDetails.marketing_specializations" 
                    :key="spec"
                    size="small"
                    variant="outlined"
                  >
                    {{ getSpecializationName(spec) }}
                  </v-chip>
                </v-chip-group>
              </div>
            </v-card-text>
          </v-card>

          <v-card v-if="selectedUserForDetails.primary_role === 'photographer'" variant="outlined" class="mb-4">
            <v-card-title class="text-h6 bg-primary-lighten-4">
              <v-icon start>mdi-camera</v-icon>
              ØªÙØ§ØµÙŠÙ„ Ø§Ù„Ù…ØµÙˆØ±
            </v-card-title>
            <v-card-text>
              <div class="mb-3">
                <strong>Ù†ÙˆØ¹ Ø§Ù„Ø¹Ù‚Ø¯:</strong>
                <v-chip 
                  :color="selectedUserForDetails.photographer_contract_type === 'freelancer' ? 'success' : 'info'"
                  size="small"
                  class="mt-1"
                >
                  {{ selectedUserForDetails.photographer_contract_type === 'freelancer' ? 'ÙØ±ÙŠÙ„Ø§Ù†Ø³Ø±' : 'Ø±Ø§ØªØ¨ Ø«Ø§Ø¨Øª' }}
                </v-chip>
              </div>
              <div v-if="selectedUserForDetails.photographer_specializations?.length" class="mb-3">
                <strong>Ø§Ù„ØªØ®ØµØµØ§Øª:</strong>
                <v-chip-group class="mt-2">
                  <v-chip 
                    v-for="spec in selectedUserForDetails.photographer_specializations" 
                    :key="spec"
                    size="small"
                    variant="outlined"
                  >
                    {{ getPhotographerSpecialization(spec) }}
                  </v-chip>
                </v-chip-group>
              </div>
              <div v-if="selectedUserForDetails.photographer_availability?.length" class="mb-3">
                <strong>Ø£ÙˆÙ‚Ø§Øª Ø§Ù„ØªÙˆÙØ±:</strong>
                <v-chip-group class="mt-2">
                  <v-chip 
                    v-for="time in selectedUserForDetails.photographer_availability" 
                    :key="time"
                    size="small"
                    variant="outlined"
                  >
                    {{ getAvailabilityTime(time) }}
                  </v-chip>
                </v-chip-group>
              </div>
              <div v-if="selectedUserForDetails.photographer_notes" class="mb-3">
                <strong>Ù…Ù„Ø§Ø­Ø¸Ø§Øª Ø¥Ø¶Ø§ÙÙŠØ©:</strong>
                <p class="mt-1">{{ selectedUserForDetails.photographer_notes }}</p>
              </div>
            </v-card-text>
          </v-card>

          <!-- Ù…Ø¹Ù„ÙˆÙ…Ø§Øª ØªÙ‚Ù†ÙŠØ© -->
          <v-card variant="outlined">
            <v-card-title class="text-h6 bg-grey-lighten-4">
              <v-icon start>mdi-information</v-icon>
              Ù…Ø¹Ù„ÙˆÙ…Ø§Øª ØªÙ‚Ù†ÙŠØ©
            </v-card-title>
            <v-card-text>
              <v-row>
                <v-col cols="12" md="6">
                  <div class="mb-2">
                    <strong>Ù…Ø¹Ø±Ù Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…:</strong>
                    <code class="text-caption bg-grey-lighten-3 pa-1 rounded">{{ selectedUserForDetails.firebase_uid || selectedUserForDetails.id }}</code>
                  </div>
                  <div class="mb-2">
                    <strong>Ø§Ù„Ø­Ø§Ù„Ø©:</strong>
                    <v-chip 
                      :color="selectedUserForDetails.status === 'active' ? 'success' : 'warning'"
                      size="small"
                    >
                      {{ selectedUserForDetails.status }}
                    </v-chip>
                  </div>
                </v-col>
                <v-col cols="12" md="6">
                  <div class="mb-2">
                    <strong>ØªØ§Ø±ÙŠØ® Ø¢Ø®Ø± ØªØ­Ø¯ÙŠØ«:</strong>
                    <p class="text-caption">{{ formatDate(selectedUserForDetails.updated_at) }}</p>
                  </div>
                </v-col>
              </v-row>
            </v-card-text>
          </v-card>
        </v-card-text>

        <v-card-actions class="pa-4 bg-grey-lighten-5">
          <v-spacer />
          <v-btn color="grey" @click="detailsDialog = false">
            Ø¥ØºÙ„Ø§Ù‚
          </v-btn>
          <v-btn 
            v-if="selectedUserForDetails?.status === 'pending_approval'"
            color="success"
            @click="approveUserFromDetails"
          >
            <v-icon start>mdi-check</v-icon>
            Ù…ÙˆØ§ÙÙ‚Ø© Ø§Ù„Ø¢Ù†
          </v-btn>
        </v-card-actions>
      </v-card>
    </v-dialog>

  </v-container>
</template>

<script setup lang="ts">
import { ref, onMounted, computed } from 'vue'
import { useRoute } from 'vue-router'
import { db } from '@/firebase/config'
import { 
  collection, 
  query, 
  where, 
  getDocs, 
  updateDoc, 
  deleteDoc,
  doc, 
  writeBatch,
  setDoc,
  addDoc,
  orderBy,
  serverTimestamp
} from 'firebase/firestore'

// === Route ===
const route = useRoute()

// === Reactive Data ===
const currentTab = ref('pending')
const allUsers = ref<any[]>([])
const pendingUsers = ref<any[]>([])
const activeUsers = ref<any[]>([])
const selectedUsers = ref<string[]>([])
const isProcessing = ref(false)
const processingUsers = ref<string[]>([])

// Reject dialog
const rejectDialog = ref(false)
const userToReject = ref<any>(null)
const rejectReason = ref('')

// User details dialog
const detailsDialog = ref(false)
const selectedUserForDetails = ref<any>(null)

// === Ø¬Ø¯ÙŠØ¯: Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø¬Ø¯Ø§ÙˆÙ„ Ø§Ù„Ø¬Ø¯ÙŠØ¯Ø© ===
// Ø¨Ø­Ø« Ù„Ù„Ù…Ø³ØªØ®Ø¯Ù…ÙŠÙ† Ø§Ù„Ù†Ø´Ø·ÙŠÙ†
const activeUsersSearch = ref('')

// Ø¨Ø­Ø« ÙˆÙÙ„ØªØ±Ø© Ù„Ø¬Ù…ÙŠØ¹ Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…ÙŠÙ†
const allUsersSearch = ref('')
const statusFilter = ref('')
const roleFilter = ref('')
const selectedAllUsers = ref<string[]>([])

// Ø®ÙŠØ§Ø±Ø§Øª Ø§Ù„ÙÙ„ØªØ±Ø©
const statusFilterOptions = [
  { title: 'Ø§Ù„ÙƒÙ„', value: '' },
  { title: 'Ù†Ø´Ø·', value: 'active' },
  { title: 'Ù…Ø¹Ù„Ù‚', value: 'pending_approval' },
  { title: 'Ù…Ø¹Ø·Ù„', value: 'suspended' },
  { title: 'Ù…Ø­Ø°ÙˆÙ', value: 'deleted' }
]

const roleFilterOptions = [
  { title: 'Ø§Ù„ÙƒÙ„', value: '' },
  { title: 'Ù…ØµÙˆØ±', value: 'photographer' },
  { title: 'Ù…Ù†Ø³Ù‚ Ø¨Ø±Ø§Ù†Ø¯', value: 'brand_coordinator' },
  { title: 'Ù…Ù†Ø³Ù‚ ØªØ³ÙˆÙŠÙ‚', value: 'marketing_coordinator' },
  { title: 'Ù…Ø¯ÙŠØ± Ø¹Ø§Ù…', value: 'super_admin' }
]

// ØªØ¹Ø±ÙŠÙ Ø£Ø¹Ù…Ø¯Ø© Ø¬Ø¯ÙˆÙ„ Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…ÙŠÙ† Ø§Ù„Ù†Ø´Ø·ÙŠÙ†
const activeUsersHeaders = [
  {
    title: 'Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…',
    key: 'user_info',
    sortable: false,
    width: '250px'
  },
  {
    title: 'Ø§Ù„Ø¯ÙˆØ±',
    key: 'primary_role',
    sortable: true,
    width: '150px'
  },
  {
    title: 'Ø§Ù„Ù‡Ø§ØªÙ',
    key: 'phone',
    sortable: false,
    width: '130px'
  },
  {
    title: 'ØªØ§Ø±ÙŠØ® Ø§Ù„ØªÙØ¹ÙŠÙ„',
    key: 'approved_at',
    sortable: true,
    width: '150px'
  },
  {
    title: 'Ø§Ù„Ø­Ø§Ù„Ø©',
    key: 'status',
    sortable: false,
    width: '100px'
  },
  {
    title: 'Ø§Ù„Ø¥Ø¬Ø±Ø§Ø¡Ø§Øª',
    key: 'actions',
    sortable: false,
    width: '150px',
    align: 'center' as const
  }
] as const

// ØªØ¹Ø±ÙŠÙ Ø£Ø¹Ù…Ø¯Ø© Ø¬Ø¯ÙˆÙ„ Ø¬Ù…ÙŠØ¹ Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…ÙŠÙ†
const allUsersHeaders = [
  {
    title: 'Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…',
    key: 'user_info',
    sortable: false,
    width: '220px'
  },
  {
    title: 'Ø§Ù„Ø¯ÙˆØ±',
    key: 'primary_role',
    sortable: true,
    width: '130px'
  },
  {
    title: 'Ø§Ù„Ø­Ø§Ù„Ø©',
    key: 'status',
    sortable: true,
    width: '120px'
  },
  {
    title: 'Ø§Ù„Ù‡Ø§ØªÙ',
    key: 'phone',
    sortable: false,
    width: '120px'
  },
  {
    title: 'ØªØ§Ø±ÙŠØ® Ø§Ù„ØªØ³Ø¬ÙŠÙ„',
    key: 'created_at',
    sortable: true,
    width: '140px'
  },
  {
    title: 'Ø§Ù„Ø¥Ø¬Ø±Ø§Ø¡Ø§Øª',
    key: 'actions',
    sortable: false,
    width: '120px',
    align: 'center' as const
  }
] as const

// === Computed Properties ===
const stats = computed(() => ({
  total: allUsers.value.length,
  active: activeUsers.value.length,
  pending: pendingUsers.value.length
}))

// === Ø¬Ø¯ÙŠØ¯: Computed Properties Ù„Ù„Ø¬Ø¯Ø§ÙˆÙ„ Ø§Ù„Ø¬Ø¯ÙŠØ¯Ø© ===
// ÙÙ„ØªØ±Ø© Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…ÙŠÙ† Ù„Ø¬Ø¯ÙˆÙ„ "Ø¬Ù…ÙŠØ¹ Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…ÙŠÙ†"
const filteredAllUsers = computed(() => {
  let filtered = [...allUsers.value]
  
  // ÙÙ„ØªØ±Ø© Ø­Ø³Ø¨ Ø§Ù„Ø­Ø§Ù„Ø©
  if (statusFilter.value) {
    filtered = filtered.filter(user => user.status === statusFilter.value)
  }
  
  // ÙÙ„ØªØ±Ø© Ø­Ø³Ø¨ Ø§Ù„Ø¯ÙˆØ±
  if (roleFilter.value) {
    filtered = filtered.filter(user => user.primary_role === roleFilter.value)
  }
  
  return filtered
})

// Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª Ø¥Ø¶Ø§ÙÙŠØ© Ù„Ù„Ø¬Ø¯ÙˆÙ„ Ø§Ù„Ø´Ø§Ù…Ù„
const photographersCount = computed(() => 
  allUsers.value.filter(user => user.primary_role === 'photographer').length
)

const coordinatorsCount = computed(() => 
  allUsers.value.filter(user => 
    user.primary_role === 'brand_coordinator' || 
    user.primary_role === 'marketing_coordinator'
  ).length
)

// === Methods ===
// Ø¬Ù„Ø¨ Ø¬Ù…ÙŠØ¹ Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…ÙŠÙ†
const loadAllUsers = async () => {
  try {
    const usersSnapshot = await getDocs(collection(db, 'users'))
    allUsers.value = usersSnapshot.docs.map(doc => ({
      id: doc.id,
      ...doc.data()
    }))
    
    // ØªØµÙ†ÙŠÙ Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…ÙŠÙ†
    pendingUsers.value = allUsers.value.filter(user => user.status === 'pending_approval')
    activeUsers.value = allUsers.value.filter(user => user.status === 'active')
    
    console.log(`ğŸ“Š ØªÙ… Ø¬Ù„Ø¨ ${allUsers.value.length} Ù…Ø³ØªØ®Ø¯Ù…`)
  } catch (error) {
    console.error('Ø®Ø·Ø£ ÙÙŠ Ø¬Ù„Ø¨ Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…ÙŠÙ†:', error)
  }
}

// Ø§Ù„Ø­ØµÙˆÙ„ Ø¹Ù„Ù‰ Ù„ÙˆÙ† Ø§Ù„Ø¯ÙˆØ±
const getRoleColor = (role: string) => {
  switch (role) {
    case 'photographer': return 'primary'
    case 'brand_coordinator': return 'warning'
    case 'marketing_coordinator': return 'error'
    case 'super_admin': return 'purple'
    default: return 'grey'
  }
}

// Ø§Ù„Ø­ØµÙˆÙ„ Ø¹Ù„Ù‰ Ø£ÙŠÙ‚ÙˆÙ†Ø© Ø§Ù„Ø¯ÙˆØ±
const getRoleIcon = (role: string) => {
  switch (role) {
    case 'photographer': return 'mdi-camera'
    case 'brand_coordinator': return 'mdi-domain'
    case 'marketing_coordinator': return 'mdi-bullhorn'
    case 'super_admin': return 'mdi-crown'
    default: return 'mdi-account'
  }
}

// Ø§Ù„Ø­ØµÙˆÙ„ Ø¹Ù„Ù‰ Ø§Ø³Ù… Ø§Ù„Ø¯ÙˆØ±
const getRoleName = (role: string) => {
  switch (role) {
    case 'photographer': return 'Ù…ØµÙˆØ±'
    case 'brand_coordinator': return 'Ù…Ù†Ø³Ù‚ Ø¨Ø±Ø§Ù†Ø¯'
    case 'marketing_coordinator': return 'Ù…Ù†Ø³Ù‚ ØªØ³ÙˆÙŠÙ‚'
    case 'super_admin': return 'Ù…Ø¯ÙŠØ± Ø¹Ø§Ù…'
    default: return 'ØºÙŠØ± Ù…Ø­Ø¯Ø¯'
  }
}

// Ø§Ù„Ø­ØµÙˆÙ„ Ø¹Ù„Ù‰ Ø§Ø³Ù… Ø§Ù„Ø¨Ø±Ø§Ù†Ø¯
const getBrandName = (brandId: string) => {
  // TODO: Ø¬Ù„Ø¨ Ø§Ø³Ù… Ø§Ù„Ø¨Ø±Ø§Ù†Ø¯ Ù…Ù† Ù‚Ø§Ø¹Ø¯Ø© Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª
  return brandId || 'ØºÙŠØ± Ù…Ø­Ø¯Ø¯'
}

// Ø§Ù„Ø­ØµÙˆÙ„ Ø¹Ù„Ù‰ Ø§Ø³Ù… Ø§Ù„ØªØ®ØµØµ
const getSpecializationName = (spec: string) => {
  const specializations: { [key: string]: string } = {
    'social_media': 'Ø§Ù„Ø³ÙˆØ´Ø§Ù„ Ù…ÙŠØ¯ÙŠØ§',
    'content_creation': 'Ø¥Ù†Ø´Ø§Ø¡ Ø§Ù„Ù…Ø­ØªÙˆÙ‰',
    'campaign_management': 'Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ø­Ù…Ù„Ø§Øª',
    'analytics': 'Ø§Ù„ØªØ­Ù„ÙŠÙ„Ø§Øª',
    'brand_management': 'Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ø¨Ø±Ø§Ù†Ø¯Ø§Øª'
  }
  return specializations[spec] || spec
}

// Ø§Ù„Ø­ØµÙˆÙ„ Ø¹Ù„Ù‰ Ø§Ø³Ù… ØªØ®ØµØµ Ø§Ù„Ù…ØµÙˆØ±
const getPhotographerSpecialization = (spec: string) => {
  const specializations: { [key: string]: string } = {
    'product_photography': 'ØªØµÙˆÙŠØ± Ø§Ù„Ù…Ù†ØªØ¬Ø§Øª',
    'portrait_photography': 'ØªØµÙˆÙŠØ± Ø§Ù„Ø£Ø´Ø®Ø§Øµ',
    'video_production': 'Ø¥Ù†ØªØ§Ø¬ Ø§Ù„ÙÙŠØ¯ÙŠÙˆ',
    'graphic_design': 'Ø§Ù„ØªØµÙ…ÙŠÙ… Ø§Ù„Ø¬Ø±Ø§ÙÙŠÙƒÙŠ',
    'social_media_content': 'Ù…Ø­ØªÙˆÙ‰ Ø§Ù„Ø³ÙˆØ´Ø§Ù„ Ù…ÙŠØ¯ÙŠØ§',
    'commercial_photography': 'Ø§Ù„ØªØµÙˆÙŠØ± Ø§Ù„ØªØ¬Ø§Ø±ÙŠ'
  }
  return specializations[spec] || spec
}

// Ø§Ù„Ø­ØµÙˆÙ„ Ø¹Ù„Ù‰ ÙˆÙ‚Øª Ø§Ù„ØªÙˆÙØ±
const getAvailabilityTime = (time: string) => {
  const times: { [key: string]: string } = {
    'morning': 'Ø§Ù„ÙØªØ±Ø© Ø§Ù„ØµØ¨Ø§Ø­ÙŠØ© (8Øµ - 12Ø¸)',
    'afternoon': 'ÙØªØ±Ø© Ø¨Ø¹Ø¯ Ø§Ù„Ø¸Ù‡Ø± (12Ø¸ - 6Ù…)',
    'evening': 'Ø§Ù„ÙØªØ±Ø© Ø§Ù„Ù…Ø³Ø§Ø¦ÙŠØ© (6Ù… - 10Ù…)',
    'weekend': 'Ø¹Ø·Ù„Ø© Ù†Ù‡Ø§ÙŠØ© Ø§Ù„Ø£Ø³Ø¨ÙˆØ¹'
  }
  return times[time] || time
}

// ØªÙ†Ø³ÙŠÙ‚ Ø§Ù„ØªØ§Ø±ÙŠØ®
const formatDate = (date: any) => {
  if (!date) return 'ØºÙŠØ± Ù…Ø­Ø¯Ø¯'
  
  let dateObj
  if (date.toDate) {
    dateObj = date.toDate()
  } else if (date instanceof Date) {
    dateObj = date
  } else {
    dateObj = new Date(date)
  }
  
  return dateObj.toLocaleDateString('ar-EG', {
    year: 'numeric',
    month: 'long',
    day: 'numeric'
  })
}

// Ù…ÙˆØ§ÙÙ‚Ø© Ø¹Ù„Ù‰ Ù…Ø³ØªØ®Ø¯Ù… ÙˆØ§Ø­Ø¯ - Ù†Ø¸Ø§Ù… Ø´Ø§Ù…Ù„
const approveUser = async (user: any) => {
  try {
    processingUsers.value.push(user.id)
    isProcessing.value = true
    
    console.log(`ğŸ”„ Ø¨Ø¯Ø¡ Ø¹Ù…Ù„ÙŠØ© Ø§Ù„Ù…ÙˆØ§ÙÙ‚Ø© Ø§Ù„Ø´Ø§Ù…Ù„Ø© Ù„Ù€ ${user.display_name}...`)
    
    // 1. ØªØ­Ø¯ÙŠØ« Ø­Ø§Ù„Ø© Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… ÙÙŠ users collection
    await updateDoc(doc(db, 'users', user.id), {
      status: 'active',
      approved_at: new Date(),
      approved_by: 'current_admin_uid', // TODO: Ø§Ø³ØªØ®Ø¯Ø§Ù… UID Ø§Ù„Ø­Ù‚ÙŠÙ‚ÙŠ
      updated_at: new Date()
    })
    
    console.log(`âœ… ØªÙ… ØªØ­Ø¯ÙŠØ« Ø­Ø§Ù„Ø© Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… ÙÙŠ users`)
    
    // 2. Ø¥Ù†Ø´Ø§Ø¡ Ø§Ù„ØµÙ„Ø§Ø­ÙŠØ§Øª Ø§Ù„Ø£Ø³Ø§Ø³ÙŠØ© Ù„Ù„Ù…Ø³ØªØ®Ø¯Ù…
    await createUserPermissions(user)
    
    // 3. Ø¥Ù†Ø´Ø§Ø¡ Ø§Ù„ÙˆØ«Ø§Ø¦Ù‚ Ø§Ù„Ù…Ø±ØªØ¨Ø·Ø© Ø¨Ø§Ù„Ø¯ÙˆØ±
    await createRoleSpecificDocuments(user)
    
    // 4. ØªØ­Ø¯ÙŠØ« Ø§Ù„Ù‚ÙˆØ§Ø¦Ù… Ø§Ù„Ù…Ø­Ù„ÙŠØ©
    const userIndex = pendingUsers.value.findIndex(u => u.id === user.id)
    if (userIndex > -1) {
      const approvedUser = { ...pendingUsers.value[userIndex], status: 'active' }
      pendingUsers.value.splice(userIndex, 1)
      activeUsers.value.push(approvedUser)
    }
    
    console.log(`âœ… ØªÙ… ØªÙØ¹ÙŠÙ„ ${user.display_name} Ø¨Ø§Ù„ÙƒØ§Ù…Ù„ Ù…Ø¹ Ø¬Ù…ÙŠØ¹ Ø§Ù„Ù…Ø³ØªÙ†Ø¯Ø§Øª Ø§Ù„Ù…Ø±ØªØ¨Ø·Ø©`)
    
  } catch (error: any) {
    console.error('âŒ Ø®Ø·Ø£ ÙÙŠ Ø§Ù„Ù…ÙˆØ§ÙÙ‚Ø© Ø§Ù„Ø´Ø§Ù…Ù„Ø©:', error)
    alert(`Ø®Ø·Ø£ ÙÙŠ ØªÙØ¹ÙŠÙ„ ${user.display_name}: ${error?.message || 'Ø®Ø·Ø£ ØºÙŠØ± Ù…Ø¹Ø±ÙˆÙ'}`)
  } finally {
    processingUsers.value = processingUsers.value.filter(id => id !== user.id)
    isProcessing.value = false
  }
}

// Ø¥Ù†Ø´Ø§Ø¡ ØµÙ„Ø§Ø­ÙŠØ§Øª Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…
const createUserPermissions = async (user: any) => {
  try {
    console.log(`ğŸ“‹ Ø¥Ù†Ø´Ø§Ø¡ ØµÙ„Ø§Ø­ÙŠØ§Øª Ù„Ù€ ${user.primary_role}...`)
    
    // ØµÙ„Ø§Ø­ÙŠØ§Øª Ø£Ø³Ø§Ø³ÙŠØ© Ø­Ø³Ø¨ Ø§Ù„Ø¯ÙˆØ±
    let permissions = {
      user_id: user.id,
      role: user.primary_role,
      crud_permissions: {
        users: { read: false, create: false, update: false, delete: false },
        brands: { read: false, create: false, update: false, delete: false },
        campaigns: { read: false, create: false, update: false, delete: false },
        content: { read: false, create: false, update: false, delete: false },
        tasks: { read: false, create: false, update: false, delete: false },
        reports: { read: false, create: false, update: false, delete: false }
      },
      created_at: new Date(),
      updated_at: new Date()
    }
    
    // ØªØ®ØµÙŠØµ Ø§Ù„ØµÙ„Ø§Ø­ÙŠØ§Øª Ø­Ø³Ø¨ Ø§Ù„Ø¯ÙˆØ±
    switch (user.primary_role) {
      case 'photographer':
        permissions.crud_permissions = {
          users: { read: false, create: false, update: false, delete: false },
          brands: { read: true, create: false, update: false, delete: false },
          campaigns: { read: true, create: false, update: false, delete: false },
          content: { read: true, create: true, update: true, delete: true },
          tasks: { read: true, create: false, update: true, delete: false },
          reports: { read: true, create: false, update: false, delete: false }
        }
        break
        
      case 'brand_coordinator':
        permissions.crud_permissions = {
          users: { read: true, create: false, update: false, delete: false },
          brands: { read: true, create: false, update: true, delete: false },
          campaigns: { read: true, create: true, update: true, delete: false },
          content: { read: true, create: false, update: true, delete: false },
          tasks: { read: true, create: true, update: true, delete: false },
          reports: { read: true, create: true, update: false, delete: false }
        }
        break
        
      case 'marketing_coordinator':
        permissions.crud_permissions = {
          users: { read: true, create: true, update: true, delete: false },
          brands: { read: true, create: true, update: true, delete: false },
          campaigns: { read: true, create: true, update: true, delete: true },
          content: { read: true, create: true, update: true, delete: true },
          tasks: { read: true, create: true, update: true, delete: true },
          reports: { read: true, create: true, update: true, delete: false }
        }
        break
    }
    
    // Ø¥Ù†Ø´Ø§Ø¡ ÙˆØ«ÙŠÙ‚Ø© Ø§Ù„ØµÙ„Ø§Ø­ÙŠØ§Øª
    await setDoc(doc(db, 'user_permissions', user.id), permissions)
    console.log(`âœ… ØªÙ… Ø¥Ù†Ø´Ø§Ø¡ ØµÙ„Ø§Ø­ÙŠØ§Øª ${user.primary_role}`)
    
  } catch (error) {
    console.error(`âŒ Ø®Ø·Ø£ ÙÙŠ Ø¥Ù†Ø´Ø§Ø¡ Ø§Ù„ØµÙ„Ø§Ø­ÙŠØ§Øª:`, error)
    throw error
  }
}

// Ø¥Ù†Ø´Ø§Ø¡ Ø§Ù„ÙˆØ«Ø§Ø¦Ù‚ Ø§Ù„Ù…Ø±ØªØ¨Ø·Ø© Ø¨Ø§Ù„Ø¯ÙˆØ±
const createRoleSpecificDocuments = async (user: any) => {
  try {
    console.log(`ğŸ“ Ø¥Ù†Ø´Ø§Ø¡ ÙˆØ«Ø§Ø¦Ù‚ Ø®Ø§ØµØ© Ø¨Ø¯ÙˆØ± ${user.primary_role}...`)
    
    switch (user.primary_role) {
      case 'photographer':
        await createPhotographerProfile(user)
        break
        
      case 'brand_coordinator':
        await createBrandCoordinatorProfile(user)
        break
        
      case 'marketing_coordinator':
        // Ù…Ù†Ø³Ù‚ Ø§Ù„ØªØ³ÙˆÙŠÙ‚ Ù„Ø§ ÙŠØ­ØªØ§Ø¬ ÙˆØ«Ø§Ø¦Ù‚ Ø¥Ø¶Ø§ÙÙŠØ© ÙÙŠ Ø§Ù„ÙˆÙ‚Øª Ø§Ù„Ø­Ø§Ù„ÙŠ
        console.log(`â„¹ï¸ Ù…Ù†Ø³Ù‚ Ø§Ù„ØªØ³ÙˆÙŠÙ‚ Ù„Ø§ ÙŠØ­ØªØ§Ø¬ ÙˆØ«Ø§Ø¦Ù‚ Ø¥Ø¶Ø§ÙÙŠØ©`)
        break
    }
    
  } catch (error) {
    console.error(`âŒ Ø®Ø·Ø£ ÙÙŠ Ø¥Ù†Ø´Ø§Ø¡ ÙˆØ«Ø§Ø¦Ù‚ Ø§Ù„Ø¯ÙˆØ±:`, error)
    throw error
  }
}

// Ø¥Ù†Ø´Ø§Ø¡ Ù…Ù„Ù Ø§Ù„Ù…ØµÙˆØ±
const createPhotographerProfile = async (user: any) => {
  try {
    const photographerProfile = {
      user_id: user.id,
      contract_type: user.photographer_contract_type || 'freelancer',
      specializations: (user.photographer_specializations || []).map((spec: string) => ({
        category_id: spec,
        skill_level: 'intermediate',
        years_experience: 1
      })),
      availability_hours: user.photographer_availability || [],
      notes: user.photographer_notes || '',
      performance_stats: {
        total_tasks_completed: 0,
        average_rating: 0,
        total_content_uploaded: 0,
        on_time_delivery_rate: 0
      },
      financial_info: {
        hourly_rate: user.photographer_contract_type === 'freelancer' ? 50 : null,
        monthly_salary: user.photographer_contract_type === 'salary' ? 3000 : null,
        total_earnings: 0,
        payment_method: 'bank_transfer'
      },
      status: 'active',
      created_at: new Date(),
      updated_at: new Date()
    }
    
    await addDoc(collection(db, 'photographer_profiles'), photographerProfile)
    console.log(`âœ… ØªÙ… Ø¥Ù†Ø´Ø§Ø¡ Ù…Ù„Ù Ø§Ù„Ù…ØµÙˆØ±`)
    
  } catch (error) {
    console.error(`âŒ Ø®Ø·Ø£ ÙÙŠ Ø¥Ù†Ø´Ø§Ø¡ Ù…Ù„Ù Ø§Ù„Ù…ØµÙˆØ±:`, error)
    throw error
  }
}

// Ø¥Ù†Ø´Ø§Ø¡ Ù…Ù„Ù Ù…Ù†Ø³Ù‚ Ø§Ù„Ø¨Ø±Ø§Ù†Ø¯
const createBrandCoordinatorProfile = async (user: any) => {
  try {
    const coordinatorProfile = {
      user_id: user.id,
      brand_id: user.requested_brand_id,
      experience_description: user.brand_experience || '',
      previous_experience_years: user.previous_experience_years || 0,
      access_level: 'standard', // ÙŠÙ…ÙƒÙ† ØªØ¹Ø¯ÙŠÙ„Ù‡ Ù„Ø§Ø­Ù‚Ø§Ù‹
      brand_specific_permissions: {
        content_approval: true,
        campaign_management: true,
        photographer_assignment: false,
        budget_access: false
      },
      performance_metrics: {
        campaigns_managed: 0,
        content_pieces_approved: 0,
        average_campaign_success_rate: 0
      },
      status: 'active',
      assigned_at: new Date(),
      created_at: new Date(),
      updated_at: new Date()
    }
    
    await addDoc(collection(db, 'brand_coordinators'), coordinatorProfile)
    console.log(`âœ… ØªÙ… Ø¥Ù†Ø´Ø§Ø¡ Ù…Ù„Ù Ù…Ù†Ø³Ù‚ Ø§Ù„Ø¨Ø±Ø§Ù†Ø¯`)
    
  } catch (error) {
    console.error(`âŒ Ø®Ø·Ø£ ÙÙŠ Ø¥Ù†Ø´Ø§Ø¡ Ù…Ù„Ù Ù…Ù†Ø³Ù‚ Ø§Ù„Ø¨Ø±Ø§Ù†Ø¯:`, error)
    throw error
  }
}

// Ø±ÙØ¶ Ù…Ø³ØªØ®Ø¯Ù…
const showRejectDialog = (user: any) => {
  userToReject.value = user
  rejectReason.value = ''
  rejectDialog.value = true
}

const confirmReject = async () => {
  if (!userToReject.value) return
  
  try {
    isProcessing.value = true
    
    // Ø­Ø°Ù Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… Ù…Ù† Ù‚Ø§Ø¹Ø¯Ø© Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª
    await deleteDoc(doc(db, 'users', userToReject.value.id))
    
    // ØªØ­Ø¯ÙŠØ« Ø§Ù„Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ù…Ø­Ù„ÙŠØ©
    const userIndex = pendingUsers.value.findIndex(u => u.id === userToReject.value.id)
    if (userIndex > -1) {
      pendingUsers.value.splice(userIndex, 1)
    }
    
    console.log(`âŒ ØªÙ… Ø±ÙØ¶ Ø·Ù„Ø¨ ${userToReject.value.display_name}`)
    
    rejectDialog.value = false
    userToReject.value = null
    
  } catch (error) {
    console.error('Ø®Ø·Ø£ ÙÙŠ Ø§Ù„Ø±ÙØ¶:', error)
  } finally {
    isProcessing.value = false
  }
}

// Ù…ÙˆØ§ÙÙ‚Ø© Ø¬Ù…Ø§Ø¹ÙŠØ© - Ù…Ø­Ø¯Ø«Ø© Ù„ØªØ³ØªØ®Ø¯Ù… Ø§Ù„Ù†Ø¸Ø§Ù… Ø§Ù„Ø´Ø§Ù…Ù„
const approveBulk = async () => {
  if (selectedUsers.value.length === 0) return
  
  try {
    isProcessing.value = true
    
    console.log(`ğŸ”„ Ø¨Ø¯Ø¡ Ø§Ù„Ù…ÙˆØ§ÙÙ‚Ø© Ø§Ù„Ø¬Ù…Ø§Ø¹ÙŠØ© Ø¹Ù„Ù‰ ${selectedUsers.value.length} Ù…Ø³ØªØ®Ø¯Ù…...`)
    
    // Ù…Ø¹Ø§Ù„Ø¬Ø© ÙƒÙ„ Ù…Ø³ØªØ®Ø¯Ù… Ø¨Ø´ÙƒÙ„ ÙØ±Ø¯ÙŠ Ù„Ø¶Ù…Ø§Ù† Ø¥Ù†Ø´Ø§Ø¡ Ø¬Ù…ÙŠØ¹ Ø§Ù„ÙˆØ«Ø§Ø¦Ù‚ Ø§Ù„Ù…Ø±ØªØ¨Ø·Ø©
    for (const userId of selectedUsers.value) {
      const user = pendingUsers.value.find(u => u.id === userId)
      if (user) {
        console.log(`ğŸ“‹ Ù…Ø¹Ø§Ù„Ø¬Ø© ${user.display_name}...`)
        
        // 1. ØªØ­Ø¯ÙŠØ« Ø­Ø§Ù„Ø© Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…
        await updateDoc(doc(db, 'users', userId), {
          status: 'active',
          approved_at: new Date(),
          approved_by: 'current_admin_uid',
          updated_at: new Date()
        })
        
        // 2. Ø¥Ù†Ø´Ø§Ø¡ Ø§Ù„ØµÙ„Ø§Ø­ÙŠØ§Øª
        await createUserPermissions(user)
        
        // 3. Ø¥Ù†Ø´Ø§Ø¡ Ø§Ù„ÙˆØ«Ø§Ø¦Ù‚ Ø§Ù„Ù…Ø±ØªØ¨Ø·Ø© Ø¨Ø§Ù„Ø¯ÙˆØ±
        await createRoleSpecificDocuments(user)
        
        console.log(`âœ… ØªÙ… ØªÙØ¹ÙŠÙ„ ${user.display_name}`)
      }
    }
    
    // ØªØ­Ø¯ÙŠØ« Ø§Ù„Ù‚ÙˆØ§Ø¦Ù… Ø§Ù„Ù…Ø­Ù„ÙŠØ©
    const approvedUsers = pendingUsers.value.filter(user => 
      selectedUsers.value.includes(user.id)
    )
    
    pendingUsers.value = pendingUsers.value.filter(user => 
      !selectedUsers.value.includes(user.id)
    )
    
    activeUsers.value.push(...approvedUsers.map(user => ({ ...user, status: 'active' })))
    
    console.log(`ğŸ‰ ØªÙ… ØªÙØ¹ÙŠÙ„ ${selectedUsers.value.length} Ù…Ø³ØªØ®Ø¯Ù… Ø¨Ø§Ù„ÙƒØ§Ù…Ù„`)
    selectedUsers.value = []
    
  } catch (error: any) {
    console.error('âŒ Ø®Ø·Ø£ ÙÙŠ Ø§Ù„Ù…ÙˆØ§ÙÙ‚Ø© Ø§Ù„Ø¬Ù…Ø§Ø¹ÙŠØ©:', error)
    alert(`Ø®Ø·Ø£ ÙÙŠ Ø§Ù„Ù…ÙˆØ§ÙÙ‚Ø© Ø§Ù„Ø¬Ù…Ø§Ø¹ÙŠØ©: ${error?.message || 'Ø®Ø·Ø£ ØºÙŠØ± Ù…Ø¹Ø±ÙˆÙ'}`)
  } finally {
    isProcessing.value = false
  }
}

// Ø±ÙØ¶ Ø¬Ù…Ø§Ø¹ÙŠ
const rejectBulk = async () => {
  if (selectedUsers.value.length === 0) return
  
  if (!confirm(`Ù‡Ù„ Ø£Ù†Øª Ù…ØªØ£ÙƒØ¯ Ù…Ù† Ø±ÙØ¶ ${selectedUsers.value.length} Ø·Ù„Ø¨ØŸ`)) {
    return
  }
  
  try {
    isProcessing.value = true
    
    const batch = writeBatch(db)
    
    selectedUsers.value.forEach(userId => {
      const userRef = doc(db, 'users', userId)
      batch.delete(userRef)
    })
    
    await batch.commit()
    
    // ØªØ­Ø¯ÙŠØ« Ø§Ù„Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ù…Ø­Ù„ÙŠØ©
    pendingUsers.value = pendingUsers.value.filter(user => 
      !selectedUsers.value.includes(user.id)
    )
    
    console.log(`âŒ ØªÙ… Ø±ÙØ¶ ${selectedUsers.value.length} Ø·Ù„Ø¨`)
    selectedUsers.value = []
    
  } catch (error) {
    console.error('Ø®Ø·Ø£ ÙÙŠ Ø§Ù„Ø±ÙØ¶ Ø§Ù„Ø¬Ù…Ø§Ø¹ÙŠ:', error)
  } finally {
    isProcessing.value = false
  }
}

// Ø¹Ø±Ø¶ ØªÙØ§ØµÙŠÙ„ Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…
const viewUserDetails = (user: any) => {
  selectedUserForDetails.value = user
  detailsDialog.value = true
}

// Approve user from details dialog
const approveUserFromDetails = async () => {
  if (!selectedUserForDetails.value) return
  
  // Ø§Ø³ØªØ®Ø¯Ø§Ù… Ù†ÙØ³ Ø¯Ø§Ù„Ø© Ø§Ù„Ù…ÙˆØ§ÙÙ‚Ø© Ø§Ù„Ø´Ø§Ù…Ù„Ø©
  await approveUser(selectedUserForDetails.value)
  detailsDialog.value = false
}

// === Ø¬Ø¯ÙŠØ¯: ÙˆØ¸Ø§Ø¦Ù Ø§Ù„Ø¬Ø¯Ø§ÙˆÙ„ Ø§Ù„Ø¬Ø¯ÙŠØ¯Ø© ===

// Ø§Ù„Ø­ØµÙˆÙ„ Ø¹Ù„Ù‰ Ù„ÙˆÙ† Ø§Ù„Ø­Ø§Ù„Ø©
const getStatusColor = (status: string) => {
  switch (status) {
    case 'active': return 'success'
    case 'pending_approval': return 'warning'
    case 'suspended': return 'error'
    case 'deleted': return 'grey'
    default: return 'grey'
  }
}

// Ø§Ù„Ø­ØµÙˆÙ„ Ø¹Ù„Ù‰ Ø£ÙŠÙ‚ÙˆÙ†Ø© Ø§Ù„Ø­Ø§Ù„Ø©
const getStatusIcon = (status: string) => {
  switch (status) {
    case 'active': return 'mdi-check-circle'
    case 'pending_approval': return 'mdi-clock-alert'
    case 'suspended': return 'mdi-pause-circle'
    case 'deleted': return 'mdi-delete'
    default: return 'mdi-help-circle'
  }
}

// Ø§Ù„Ø­ØµÙˆÙ„ Ø¹Ù„Ù‰ Ø§Ø³Ù… Ø§Ù„Ø­Ø§Ù„Ø©
const getStatusName = (status: string) => {
  switch (status) {
    case 'active': return 'Ù†Ø´Ø·'
    case 'pending_approval': return 'ÙÙŠ Ø§Ù†ØªØ¸Ø§Ø± Ø§Ù„Ù…ÙˆØ§ÙÙ‚Ø©'
    case 'suspended': return 'Ù…Ø¹Ù„Ù‚'
    case 'deleted': return 'Ù…Ø­Ø°ÙˆÙ'
    default: return 'ØºÙŠØ± Ù…Ø­Ø¯Ø¯'
  }
}

// Ø­Ø³Ø§Ø¨ Ø§Ù„ÙØ±Ù‚ Ø§Ù„Ø²Ù…Ù†ÙŠ
const getTimeDifference = (date: any) => {
  if (!date) return ''
  
  const now = new Date()
  const targetDate = date.toDate ? date.toDate() : new Date(date)
  const diffTime = Math.abs(now.getTime() - targetDate.getTime())
  const diffDays = Math.ceil(diffTime / (1000 * 60 * 60 * 24))
  
  if (diffDays === 1) return 'Ø£Ù…Ø³'
  if (diffDays < 7) return `Ù…Ù†Ø° ${diffDays} Ø£ÙŠØ§Ù…`
  if (diffDays < 30) return `Ù…Ù†Ø° ${Math.ceil(diffDays / 7)} Ø£Ø³Ø§Ø¨ÙŠØ¹`
  if (diffDays < 365) return `Ù…Ù†Ø° ${Math.ceil(diffDays / 30)} Ø£Ø´Ù‡Ø±`
  return `Ù…Ù†Ø° ${Math.ceil(diffDays / 365)} Ø³Ù†ÙˆØ§Øª`
}

// ØªØ¹Ø¯ÙŠÙ„ Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…
const editUser = async (user: any) => {
  console.log('ğŸ”§ ÙØªØ­ Ù†Ø§ÙØ°Ø© ØªØ¹Ø¯ÙŠÙ„ Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…:', user.display_name)
  // TODO: ÙØªØ­ Ù†Ø§ÙØ°Ø© ØªØ¹Ø¯ÙŠÙ„ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª
  alert(`ØªØ¹Ø¯ÙŠÙ„ Ø¨ÙŠØ§Ù†Ø§Øª ${user.display_name}\nÙ‡Ø°Ù‡ Ø§Ù„Ù…ÙŠØ²Ø© Ù‚ÙŠØ¯ Ø§Ù„ØªØ·ÙˆÙŠØ±...`)
}

// ØªØ¹Ù„ÙŠÙ‚/Ø¥ÙŠÙ‚Ø§Ù Ù…Ø³ØªØ®Ø¯Ù…
const suspendUser = async (user: any) => {
  if (!confirm(`Ù‡Ù„ Ø£Ù†Øª Ù…ØªØ£ÙƒØ¯ Ù…Ù† ØªØ¹Ù„ÙŠÙ‚ Ø­Ø³Ø§Ø¨ ${user.display_name}ØŸ`)) {
    return
  }
  
  try {
    console.log('â¸ï¸ ØªØ¹Ù„ÙŠÙ‚ Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…:', user.display_name)
    
    // ØªØ­Ø¯ÙŠØ« Ø­Ø§Ù„Ø© Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… ÙÙŠ Firestore
    await updateDoc(doc(db, 'users', user.id), {
      status: 'suspended',
      suspended_at: new Date(),
      suspended_by: 'current_admin_uid', // TODO: Ø§Ø³ØªØ®Ø¯Ø§Ù… UID Ø§Ù„Ø­Ù‚ÙŠÙ‚ÙŠ
      updated_at: new Date()
    })
    
    // ØªØ­Ø¯ÙŠØ« Ø§Ù„Ù‚ÙˆØ§Ø¦Ù… Ø§Ù„Ù…Ø­Ù„ÙŠØ©
    const userIndex = activeUsers.value.findIndex(u => u.id === user.id)
    if (userIndex > -1) {
      activeUsers.value[userIndex].status = 'suspended'
    }
    
    const allUserIndex = allUsers.value.findIndex(u => u.id === user.id)
    if (allUserIndex > -1) {
      allUsers.value[allUserIndex].status = 'suspended'
    }
    
    console.log(`âœ… ØªÙ… ØªØ¹Ù„ÙŠÙ‚ Ø­Ø³Ø§Ø¨ ${user.display_name}`)
    
  } catch (error: any) {
    console.error('âŒ Ø®Ø·Ø£ ÙÙŠ ØªØ¹Ù„ÙŠÙ‚ Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…:', error)
    alert(`Ø®Ø·Ø£ ÙÙŠ ØªØ¹Ù„ÙŠÙ‚ Ø§Ù„Ø­Ø³Ø§Ø¨: ${error?.message || 'Ø®Ø·Ø£ ØºÙŠØ± Ù…Ø¹Ø±ÙˆÙ'}`)
  }
}

// ØªØ¨Ø¯ÙŠÙ„ Ø­Ø§Ù„Ø© Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… (ØªÙØ¹ÙŠÙ„/ØªØ¹Ù„ÙŠÙ‚)
const toggleUserStatus = async (user: any) => {
  const newStatus = user.status === 'active' ? 'suspended' : 'active'
  const actionText = newStatus === 'active' ? 'ØªÙØ¹ÙŠÙ„' : 'ØªØ¹Ù„ÙŠÙ‚'
  
  if (!confirm(`Ù‡Ù„ Ø£Ù†Øª Ù…ØªØ£ÙƒØ¯ Ù…Ù† ${actionText} Ø­Ø³Ø§Ø¨ ${user.display_name}ØŸ`)) {
    return
  }
  
  try {
    console.log(`ğŸ”„ ${actionText} Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…:`, user.display_name)
    
    // ØªØ­Ø¯ÙŠØ« Ø­Ø§Ù„Ø© Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… ÙÙŠ Firestore
    const updateData: any = {
      status: newStatus,
      updated_at: new Date()
    }
    
    if (newStatus === 'suspended') {
      updateData.suspended_at = new Date()
      updateData.suspended_by = 'current_admin_uid'
    } else {
      updateData.reactivated_at = new Date()
      updateData.reactivated_by = 'current_admin_uid'
    }
    
    await updateDoc(doc(db, 'users', user.id), updateData)
    
    // ØªØ­Ø¯ÙŠØ« Ø§Ù„Ù‚ÙˆØ§Ø¦Ù… Ø§Ù„Ù…Ø­Ù„ÙŠØ©
    const allUserIndex = allUsers.value.findIndex(u => u.id === user.id)
    if (allUserIndex > -1) {
      allUsers.value[allUserIndex].status = newStatus
    }
    
    // Ø¥Ø¹Ø§Ø¯Ø© ØªØµÙ†ÙŠÙ Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…ÙŠÙ†
    if (newStatus === 'active') {
      const userIndex = activeUsers.value.findIndex(u => u.id === user.id)
      if (userIndex === -1) {
        activeUsers.value.push({ ...user, status: newStatus })
      }
    } else {
      const userIndex = activeUsers.value.findIndex(u => u.id === user.id)
      if (userIndex > -1) {
        activeUsers.value.splice(userIndex, 1)
      }
    }
    
    console.log(`âœ… ØªÙ… ${actionText} Ø­Ø³Ø§Ø¨ ${user.display_name}`)
    
  } catch (error: any) {
    console.error(`âŒ Ø®Ø·Ø£ ÙÙŠ ${actionText} Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…:`, error)
    alert(`Ø®Ø·Ø£ ÙÙŠ ${actionText} Ø§Ù„Ø­Ø³Ø§Ø¨: ${error?.message || 'Ø®Ø·Ø£ ØºÙŠØ± Ù…Ø¹Ø±ÙˆÙ'}`)
  }
}

// Ø¥Ø¬Ø±Ø§Ø¡Ø§Øª Ø¬Ù…Ø§Ø¹ÙŠØ© - ØªØ¹Ù„ÙŠÙ‚ Ø§Ù„Ù…Ø­Ø¯Ø¯
const bulkSuspendUsers = async () => {
  if (selectedAllUsers.value.length === 0) return
  
  if (!confirm(`Ù‡Ù„ Ø£Ù†Øª Ù…ØªØ£ÙƒØ¯ Ù…Ù† ØªØ¹Ù„ÙŠÙ‚ ${selectedAllUsers.value.length} Ù…Ø³ØªØ®Ø¯Ù…ØŸ`)) {
    return
  }
  
  try {
    isProcessing.value = true
    console.log(`â¸ï¸ Ø¨Ø¯Ø¡ ØªØ¹Ù„ÙŠÙ‚ ${selectedAllUsers.value.length} Ù…Ø³ØªØ®Ø¯Ù…...`)
    
    const batch = writeBatch(db)
    
    selectedAllUsers.value.forEach(userId => {
      const userRef = doc(db, 'users', userId)
      batch.update(userRef, {
        status: 'suspended',
        suspended_at: new Date(),
        suspended_by: 'current_admin_uid',
        updated_at: new Date()
      })
    })
    
    await batch.commit()
    
    // ØªØ­Ø¯ÙŠØ« Ø§Ù„Ù‚ÙˆØ§Ø¦Ù… Ø§Ù„Ù…Ø­Ù„ÙŠØ©
    selectedAllUsers.value.forEach(userId => {
      const allUserIndex = allUsers.value.findIndex(u => u.id === userId)
      if (allUserIndex > -1) {
        allUsers.value[allUserIndex].status = 'suspended'
      }
      
      const activeUserIndex = activeUsers.value.findIndex(u => u.id === userId)
      if (activeUserIndex > -1) {
        activeUsers.value.splice(activeUserIndex, 1)
      }
    })
    
    console.log(`âœ… ØªÙ… ØªØ¹Ù„ÙŠÙ‚ ${selectedAllUsers.value.length} Ù…Ø³ØªØ®Ø¯Ù…`)
    selectedAllUsers.value = []
    
  } catch (error: any) {
    console.error('âŒ Ø®Ø·Ø£ ÙÙŠ Ø§Ù„ØªØ¹Ù„ÙŠÙ‚ Ø§Ù„Ø¬Ù…Ø§Ø¹ÙŠ:', error)
    alert(`Ø®Ø·Ø£ ÙÙŠ Ø§Ù„ØªØ¹Ù„ÙŠÙ‚ Ø§Ù„Ø¬Ù…Ø§Ø¹ÙŠ: ${error?.message || 'Ø®Ø·Ø£ ØºÙŠØ± Ù…Ø¹Ø±ÙˆÙ'}`)
  } finally {
    isProcessing.value = false
  }
}

// Ø¥Ø¬Ø±Ø§Ø¡Ø§Øª Ø¬Ù…Ø§Ø¹ÙŠØ© - ØªÙØ¹ÙŠÙ„ Ø§Ù„Ù…Ø­Ø¯Ø¯
const bulkActivateUsers = async () => {
  if (selectedAllUsers.value.length === 0) return
  
  if (!confirm(`Ù‡Ù„ Ø£Ù†Øª Ù…ØªØ£ÙƒØ¯ Ù…Ù† ØªÙØ¹ÙŠÙ„ ${selectedAllUsers.value.length} Ù…Ø³ØªØ®Ø¯Ù…ØŸ`)) {
    return
  }
  
  try {
    isProcessing.value = true
    console.log(`âœ… Ø¨Ø¯Ø¡ ØªÙØ¹ÙŠÙ„ ${selectedAllUsers.value.length} Ù…Ø³ØªØ®Ø¯Ù…...`)
    
    const batch = writeBatch(db)
    
    selectedAllUsers.value.forEach(userId => {
      const userRef = doc(db, 'users', userId)
      batch.update(userRef, {
        status: 'active',
        reactivated_at: new Date(),
        reactivated_by: 'current_admin_uid',
        updated_at: new Date()
      })
    })
    
    await batch.commit()
    
    // ØªØ­Ø¯ÙŠØ« Ø§Ù„Ù‚ÙˆØ§Ø¦Ù… Ø§Ù„Ù…Ø­Ù„ÙŠØ©
    selectedAllUsers.value.forEach(userId => {
      const allUserIndex = allUsers.value.findIndex(u => u.id === userId)
      if (allUserIndex > -1) {
        allUsers.value[allUserIndex].status = 'active'
        
        // Ø¥Ø¶Ø§ÙØ© Ù„Ù„Ù…Ø³ØªØ®Ø¯Ù…ÙŠÙ† Ø§Ù„Ù†Ø´Ø·ÙŠÙ† Ø¥Ø°Ø§ Ù„Ù… ÙŠÙƒÙ† Ù…ÙˆØ¬ÙˆØ¯Ø§Ù‹
        const activeUserIndex = activeUsers.value.findIndex(u => u.id === userId)
        if (activeUserIndex === -1) {
          activeUsers.value.push(allUsers.value[allUserIndex])
        }
      }
    })
    
    console.log(`âœ… ØªÙ… ØªÙØ¹ÙŠÙ„ ${selectedAllUsers.value.length} Ù…Ø³ØªØ®Ø¯Ù…`)
    selectedAllUsers.value = []
    
  } catch (error: any) {
    console.error('âŒ Ø®Ø·Ø£ ÙÙŠ Ø§Ù„ØªÙØ¹ÙŠÙ„ Ø§Ù„Ø¬Ù…Ø§Ø¹ÙŠ:', error)
    alert(`Ø®Ø·Ø£ ÙÙŠ Ø§Ù„ØªÙØ¹ÙŠÙ„ Ø§Ù„Ø¬Ù…Ø§Ø¹ÙŠ: ${error?.message || 'Ø®Ø·Ø£ ØºÙŠØ± Ù…Ø¹Ø±ÙˆÙ'}`)
  } finally {
    isProcessing.value = false
  }
}

// === Lifecycle ===
onMounted(async () => {
  // Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ø§Ù„Ù€ tab Ø§Ù„Ù…Ø·Ù„ÙˆØ¨ Ù…Ù† Ø§Ù„Ù€ URL
  if (route.query.tab) {
    currentTab.value = route.query.tab as string
  }
  
  await loadAllUsers()
})
</script>

<style scoped>
.user-management-container {
  max-width: 100%;
  margin: 0 auto;
}

.pending-user-card {
  transition: all 0.3s ease;
  border-radius: 12px;
  overflow: hidden;
}

.pending-user-card:hover {
  transform: translateY(-2px);
  box-shadow: 0 8px 25px rgba(0, 0, 0, 0.15);
}

.pending-user-card.selected {
  border: 2px solid rgb(var(--v-theme-primary));
  background: rgba(var(--v-theme-primary), 0.05);
}

.bulk-action-bar {
  background: rgba(var(--v-theme-primary), 0.1);
  border-radius: 8px;
  padding: 12px;
  margin-bottom: 16px;
}

.role-chip {
  font-weight: 500;
  letter-spacing: 0.025em;
}

.user-avatar {
  border: 2px solid rgba(var(--v-theme-surface), 1);
  box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
}

.details-section {
  margin-bottom: 24px;
}

.detail-label {
  font-weight: 600;
  color: rgba(var(--v-theme-on-surface), 0.8);
  margin-bottom: 4px;
}

.detail-value {
  color: rgba(var(--v-theme-on-surface), 1);
}

/* === Ø¬Ø¯ÙŠØ¯: Ø£Ù†Ù…Ø§Ø· Ø§Ù„Ø¬Ø¯Ø§ÙˆÙ„ Ø§Ù„Ø¬Ø¯ÙŠØ¯Ø© === */

.users-table-card {
  border-radius: 12px;
  overflow: hidden;
  box-shadow: 0 4px 20px rgba(0, 0, 0, 0.08);
}

.users-table-card .v-data-table {
  background: transparent;
}

.users-table-card .v-toolbar {
  background: rgba(var(--v-theme-surface), 1) !important;
  border-bottom: 1px solid rgba(var(--v-theme-outline), 0.12);
}

.users-table-card .v-data-table__wrapper {
  border-radius: 0;
}

/* ØªØ­Ø³ÙŠÙ† Ø¹Ø±Ø¶ ØµÙÙˆÙ Ø§Ù„Ø¬Ø¯ÙˆÙ„ */
.users-table-card :deep(.v-data-table__tr) {
  transition: background-color 0.2s ease;
}

.users-table-card :deep(.v-data-table__tr:hover) {
  background: rgba(var(--v-theme-primary), 0.04) !important;
}

/* ØªØ­Ø³ÙŠÙ† Ø¹Ø±Ø¶ Ø®Ø§Ù†Ø§Øª Ø§Ù„Ø§Ø®ØªÙŠØ§Ø± */
.users-table-card :deep(.v-selection-control) {
  justify-content: center;
}

/* ØªØ­Ø³ÙŠÙ† Ø§Ù„Ø£Ø²Ø±Ø§Ø± ÙÙŠ Ø§Ù„Ø¬Ø¯Ø§ÙˆÙ„ */
.users-table-card .v-btn--icon {
  transition: all 0.2s ease;
}

.users-table-card .v-btn--icon:hover {
  transform: scale(1.1);
}

/* ØªØ­Ø³ÙŠÙ† Ø¹Ø±Ø¶ Ø§Ù„Ù€ chips */
.users-table-card .v-chip {
  font-weight: 500;
  letter-spacing: 0.025em;
}

/* ØªØ­Ø³ÙŠÙ† Pagination */
.users-table-card :deep(.v-data-table-footer) {
  border-top: 1px solid rgba(var(--v-theme-outline), 0.12);
  background: rgba(var(--v-theme-surface-variant), 0.3);
}

/* ØªØ­Ø³ÙŠÙ† Ù…Ø­Ø§Ø°Ø§Ø© Ø§Ù„Ø¹Ù†Ø§ØµØ± */
.users-table-card :deep(.v-data-table__td) {
  vertical-align: middle;
}

/* ØªØ­Ø³ÙŠÙ† Ø¹Ø±Ø¶ Ø±Ø³Ø§Ø¦Ù„ Ø¹Ø¯Ù… ÙˆØ¬ÙˆØ¯ Ø¨ÙŠØ§Ù†Ø§Øª */
.users-table-card :deep(.v-data-table__empty-wrapper) {
  padding: 40px 20px;
}

/* ØªØ­Ø³ÙŠÙ† responsive design */
@media (max-width: 768px) {
  .users-table-card :deep(.v-data-table__wrapper) {
    overflow-x: auto;
  }
  
  .users-table-card :deep(.v-data-table__table) {
    min-width: 800px;
  }
}

/* ØªØ­Ø³ÙŠÙ† Ø§Ù„ØªØ¨Ø¯ÙŠÙ„ Ø¨ÙŠÙ† Ø§Ù„ØªØ¨ÙˆÙŠØ¨Ø§Øª */
.v-tabs-window-item {
  padding-top: 0;
}

/* ØªØ­Ø³ÙŠÙ† Ø£Ø¯ÙˆØ§Øª Ø§Ù„ØªØ­ÙƒÙ… Ø§Ù„Ø¹Ù„ÙˆÙŠØ© */
.d-flex.ga-2 {
  gap: 8px;
}

.d-flex.ga-2.flex-wrap {
  flex-wrap: wrap;
  gap: 8px;
}

/* ØªØ­Ø³ÙŠÙ† ÙƒØ±ÙˆØª Ø§Ù„Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª */
.v-card.pa-3.text-center {
  transition: all 0.3s ease;
  border-radius: 8px;
}

.v-card.pa-3.text-center:hover {
  transform: translateY(-2px);
  box-shadow: 0 6px 20px rgba(0, 0, 0, 0.1);
}
</style> 