/**
 * ==============================================
 * DEPTH STUDIO DESIGN SYSTEM - RTL SUPPORT
 * ==============================================
 * نظام دعم شامل للتوجه من اليمين لليسار (RTL)
 * مخصص للغة العربية مع إصلاح جميع مشاكل التوجيه
 * 
 * يشمل:
 * - توجيه النصوص والعناصر
 * - إصلاح الأيقونات والأزرار
 * - دعم النماذج والجداول
 * - توجيه التخطيطات والقوائم
 */

// === RTL DETECTION & ROOT SETUP ===
// كشف وإعداد التوجيه الأساسي

:root {
  // متغيرات التوجيه الديناميكية
  --direction: ltr;
  --text-align-start: left;
  --text-align-end: right;
  --margin-start: margin-left;
  --margin-end: margin-right;
  --padding-start: padding-left;
  --padding-end: padding-right;
  --border-start: border-left;
  --border-end: border-right;
  --border-start-width: border-left-width;
  --border-end-width: border-right-width;
  --border-start-style: border-left-style;
  --border-end-style: border-right-style;
  --border-start-color: border-left-color;
  --border-end-color: border-right-color;
  --start-position: left;
  --end-position: right;
}

// إعداد التوجيه العربي
[dir="rtl"],
html[dir="rtl"] {
  --direction: rtl;
  --text-align-start: right;
  --text-align-end: left;
  --margin-start: margin-right;
  --margin-end: margin-left;
  --padding-start: padding-right;
  --padding-end: padding-left;
  --border-start: border-right;
  --border-end: border-left;
  --border-start-width: border-right-width;
  --border-end-width: border-left-width;
  --border-start-style: border-right-style;
  --border-end-style: border-left-style;
  --border-start-color: border-right-color;
  --border-end-color: border-left-color;
  --start-position: right;
  --end-position: left;
}

// === RTL MIXINS ===
// خلطات مساعدة للتوجيه

// Margin mixins for logical properties
@mixin margin-start($value) {
  [dir="ltr"] & {
    margin-left: $value;
  }
  [dir="rtl"] & {
    margin-right: $value;
  }
}

@mixin margin-end($value) {
  [dir="ltr"] & {
    margin-right: $value;
  }
  [dir="rtl"] & {
    margin-left: $value;
  }
}

@mixin margin-horizontal($start, $end: $start) {
  @include margin-start($start);
  @include margin-end($end);
}

// Padding mixins for logical properties
@mixin padding-start($value) {
  [dir="ltr"] & {
    padding-left: $value;
  }
  [dir="rtl"] & {
    padding-right: $value;
  }
}

@mixin padding-end($value) {
  [dir="ltr"] & {
    padding-right: $value;
  }
  [dir="rtl"] & {
    padding-left: $value;
  }
}

@mixin padding-horizontal($start, $end: $start) {
  @include padding-start($start);
  @include padding-end($end);
}

// Border mixins for logical properties
@mixin border-start($width, $style: solid, $color: currentColor) {
  [dir="ltr"] & {
    border-left: $width $style $color;
  }
  [dir="rtl"] & {
    border-right: $width $style $color;
  }
}

@mixin border-end($width, $style: solid, $color: currentColor) {
  [dir="ltr"] & {
    border-right: $width $style $color;
  }
  [dir="rtl"] & {
    border-left: $width $style $color;
  }
}

// Position mixins for logical properties
@mixin position-start($value) {
  [dir="ltr"] & {
    left: $value;
  }
  [dir="rtl"] & {
    right: $value;
  }
}

@mixin position-end($value) {
  [dir="ltr"] & {
    right: $value;
  }
  [dir="rtl"] & {
    left: $value;
  }
}

// Transform mixins for RTL
@mixin transform-rtl($ltr-transform, $rtl-transform: null) {
  [dir="ltr"] & {
    transform: #{$ltr-transform};
  }
  [dir="rtl"] & {
    @if $rtl-transform {
      transform: #{$rtl-transform};
    } @else {
      // التحويل التلقائي لانعكاس X
      transform: scaleX(-1) #{$ltr-transform} scaleX(-1);
    }
  }
}

// Text alignment mixin
@mixin text-align-start {
  [dir="ltr"] & {
    text-align: left;
  }
  [dir="rtl"] & {
    text-align: right;
  }
}

@mixin text-align-end {
  [dir="ltr"] & {
    text-align: right;
  }
  [dir="rtl"] & {
    text-align: left;
  }
}

// Float mixins for RTL
@mixin float-start {
  [dir="ltr"] & {
    float: left;
  }
  [dir="rtl"] & {
    float: right;
  }
}

@mixin float-end {
  [dir="ltr"] & {
    float: right;
  }
  [dir="rtl"] & {
    float: left;
  }
}

// === GLOBAL RTL ADJUSTMENTS ===
// تعديلات شاملة للتوجيه

// Basic text direction
[dir="rtl"] {
  direction: rtl;
  text-align: right;
  
  // إصلاح الخطوط العربية
  font-family: 'Cairo', 'Tajawal', 'IBM Plex Sans Arabic', 'Segoe UI', sans-serif;
  
  // تحسين عرض النصوص العربية
  text-rendering: optimizeLegibility;
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

// إصلاح توجيه النصوص المختلطة
[dir="rtl"] {
  .number,
  .english-text,
  .ltr-content {
    direction: ltr;
    text-align: left;
    display: inline-block;
  }
  
  .arabic-text,
  .rtl-content {
    direction: rtl;
    text-align: right;
  }
}

// === LAYOUT COMPONENTS RTL ===
// إصلاح مكونات التخطيط

// Header RTL adjustments
[dir="rtl"] {
  .header,
  .navbar {
    .brand-logo {
      @include margin-start(0);
      @include margin-end(var(--spacing-4));
    }
    
    .nav-items {
      flex-direction: row-reverse;
      
      .nav-item {
        @include margin-start(var(--spacing-3));
        @include margin-end(0);
      }
    }
    
    .user-menu {
      @include position-start(var(--spacing-4));
      @include position-end(auto);
    }
  }
}

// Sidebar RTL adjustments
[dir="rtl"] {
  .sidebar {
    @include position-start(0);
    @include position-end(auto);
    
    .sidebar-toggle {
      @include position-end(var(--spacing-4));
      @include position-start(auto);
    }
    
    .nav-item {
      .nav-icon {
        @include margin-end(var(--spacing-3));
        @include margin-start(0);
      }
      
      .nav-text {
        @include text-align-start;
      }
      
      // إصلاح أيقونة السهم للقوائم الفرعية
      .nav-arrow {
        @include position-start(var(--spacing-3));
        @include position-end(auto);
        transform: rotate(180deg);
      }
    }
    
    // تعديل القوائم الفرعية
    .submenu {
      @include padding-start(var(--spacing-6));
      @include padding-end(var(--spacing-3));
    }
  }
  
  // إزاحة المحتوى الرئيسي للشريط الجانبي
  .main-content {
    @include margin-start(var(--sidebar-width));
    @include margin-end(0);
  }
}

// === FORM COMPONENTS RTL ===
// إصلاح مكونات النماذج

[dir="rtl"] {
  .form-group {
    .form-label {
      @include text-align-start;
    }
    
    .form-control {
      @include text-align-start;
      
      // إصلاح placeholder للعربية
      &::placeholder {
        @include text-align-start;
        opacity: 0.7;
      }
    }
    
    .form-help-text,
    .form-error {
      @include text-align-start;
    }
    
    // إصلاح أيقونات الحقول
    .input-icon {
      &.icon-start {
        @include position-start(var(--spacing-3));
        @include position-end(auto);
      }
      
      &.icon-end {
        @include position-end(var(--spacing-3));
        @include position-start(auto);
      }
    }
    
    // ضبط padding للحقول مع أيقونات
    .form-control {
      &.has-icon-start {
        @include padding-start(var(--spacing-10));
      }
      
      &.has-icon-end {
        @include padding-end(var(--spacing-10));
      }
    }
  }
  
  // إصلاح checkbox و radio
  .form-check {
    @include text-align-start;
    
    .form-check-input {
      @include margin-end(var(--spacing-2));
      @include margin-start(0);
      @include float-start;
    }
    
    .form-check-label {
      @include padding-start(var(--spacing-6));
      @include padding-end(0);
    }
  }
  
  // إصلاح select dropdown
  .form-select {
    background-position: var(--start-position) var(--spacing-3) center;
    @include padding-start(var(--spacing-10));
    @include padding-end(var(--spacing-3));
  }
}

// === TABLE COMPONENTS RTL ===
// إصلاح الجداول

[dir="rtl"] {
  .table {
    th, td {
      @include text-align-start;
      
      &.text-center {
        text-align: center;
      }
      
      &.text-end {
        @include text-align-end;
      }
    }
    
    // إصلاح أيقونات الترتيب
    .sortable {
      .sort-icon {
        @include margin-start(var(--spacing-2));
        @include margin-end(0);
      }
    }
    
    // إصلاح أزرار الإجراءات
    .actions {
      @include text-align-start;
      
      .btn + .btn {
        @include margin-start(var(--spacing-2));
        @include margin-end(0);
      }
    }
  }
  
  // إصلاح pagination
  .pagination {
    justify-content: flex-start;
    
    .page-item {
      .page-link {
        @include margin-end(var(--spacing-1));
        @include margin-start(0);
      }
    }
  }
}

// === CARD COMPONENTS RTL ===
// إصلاح البطاقات

[dir="rtl"] {
  .card {
    .card-header {
      @include text-align-start;
      
      .card-actions {
        @include position-start(var(--spacing-4));
        @include position-end(auto);
      }
    }
    
    .card-body {
      @include text-align-start;
    }
    
    .card-footer {
      @include text-align-start;
      
      .btn + .btn {
        @include margin-start(var(--spacing-2));
        @include margin-end(0);
      }
    }
  }
  
  // إصلاح card مع أيقونات
  .card-icon {
    @include float-start;
    @include margin-end(var(--spacing-3));
    @include margin-start(0);
  }
}

// === BUTTON COMPONENTS RTL ===
// إصلاح الأزرار

[dir="rtl"] {
  .btn {
    // إصلاح أيقونات الأزرار
    .btn-icon {
      &.icon-start {
        @include margin-end(var(--spacing-2));
        @include margin-start(0);
      }
      
      &.icon-end {
        @include margin-start(var(--spacing-2));
        @include margin-end(0);
      }
    }
    
    // إصلاح الأزرار مع نص ورقم
    .btn-badge {
      @include margin-start(var(--spacing-2));
      @include margin-end(0);
    }
  }
  
  // إصلاح مجموعات الأزرار
  .btn-group {
    .btn + .btn {
      @include margin-start(-1px);
      @include margin-end(0);
    }
    
    .btn:first-child {
      border-top-right-radius: 0;
      border-bottom-right-radius: 0;
      border-top-left-radius: var(--border-radius);
      border-bottom-left-radius: var(--border-radius);
    }
    
    .btn:last-child {
      border-top-left-radius: 0;
      border-bottom-left-radius: 0;
      border-top-right-radius: var(--border-radius);
      border-bottom-right-radius: var(--border-radius);
    }
  }
}

// === MODAL & DIALOG RTL ===
// إصلاح النوافذ المنبثقة

[dir="rtl"] {
  .modal {
    .modal-header {
      @include text-align-start;
      
      .modal-close {
        @include position-start(var(--spacing-4));
        @include position-end(auto);
      }
    }
    
    .modal-body {
      @include text-align-start;
    }
    
    .modal-footer {
      justify-content: flex-start;
      
      .btn + .btn {
        @include margin-start(var(--spacing-2));
        @include margin-end(0);
      }
    }
  }
  
  // إصلاح dropdown menus
  .dropdown-menu {
    @include text-align-start;
    
    .dropdown-item {
      @include text-align-start;
      
      .dropdown-icon {
        @include margin-end(var(--spacing-2));
        @include margin-start(0);
      }
    }
  }
}

// === NOTIFICATION & TOAST RTL ===
// إصلاح الإشعارات

[dir="rtl"] {
  .toast,
  .alert,
  .notification {
    @include text-align-start;
    
    .toast-icon,
    .alert-icon {
      @include margin-end(var(--spacing-3));
      @include margin-start(0);
    }
    
    .toast-close,
    .alert-close {
      @include position-start(var(--spacing-3));
      @include position-end(auto);
    }
  }
  
  // إصلاح موضع الإشعارات
  .toast-container {
    &.position-top-start {
      top: var(--spacing-4);
      @include position-start(var(--spacing-4));
      @include position-end(auto);
    }
    
    &.position-top-end {
      top: var(--spacing-4);
      @include position-end(var(--spacing-4));
      @include position-start(auto);
    }
    
    &.position-bottom-start {
      bottom: var(--spacing-4);
      @include position-start(var(--spacing-4));
      @include position-end(auto);
    }
    
    &.position-bottom-end {
      bottom: var(--spacing-4);
      @include position-end(var(--spacing-4));
      @include position-start(auto);
    }
  }
}

// === BREADCRUMB RTL ===
// إصلاح مسار التنقل

[dir="rtl"] {
  .breadcrumb {
    .breadcrumb-item {
      @include float-start;
      
      + .breadcrumb-item {
        @include padding-start(var(--spacing-2));
        @include padding-end(0);
        
        &::before {
          @include position-start(-#{var(--spacing-1)});
          @include position-end(auto);
          content: "\\";
          transform: scaleX(-1);
        }
      }
    }
  }
}

// === PROGRESS & LOADING RTL ===
// إصلاح شرائط التقدم

[dir="rtl"] {
  .progress {
    .progress-bar {
      @include float-start;
    }
    
    .progress-label {
      @include text-align-start;
    }
  }
  
  // إصلاح loading spinners
  .loading {
    .loading-text {
      @include text-align-start;
      @include margin-start(var(--spacing-3));
      @include margin-end(0);
    }
  }
}

// === UTILITY CLASSES RTL ===
// فئات مساعدة للتوجيه

// Text alignment utilities
.text-start {
  @include text-align-start;
}

.text-end {
  @include text-align-end;
}

// Float utilities
.float-start {
  @include float-start;
}

.float-end {
  @include float-end;
}

// Margin utilities
.ms-0 { @include margin-start(0); }
.ms-1 { @include margin-start(var(--spacing-1)); }
.ms-2 { @include margin-start(var(--spacing-2)); }
.ms-3 { @include margin-start(var(--spacing-3)); }
.ms-4 { @include margin-start(var(--spacing-4)); }
.ms-5 { @include margin-start(var(--spacing-5)); }
.ms-auto { 
  [dir="ltr"] & { margin-left: auto; }
  [dir="rtl"] & { margin-right: auto; }
}

.me-0 { @include margin-end(0); }
.me-1 { @include margin-end(var(--spacing-1)); }
.me-2 { @include margin-end(var(--spacing-2)); }
.me-3 { @include margin-end(var(--spacing-3)); }
.me-4 { @include margin-end(var(--spacing-4)); }
.me-5 { @include margin-end(var(--spacing-5)); }
.me-auto { 
  [dir="ltr"] & { margin-right: auto; }
  [dir="rtl"] & { margin-left: auto; }
}

// Padding utilities
.ps-0 { @include padding-start(0); }
.ps-1 { @include padding-start(var(--spacing-1)); }
.ps-2 { @include padding-start(var(--spacing-2)); }
.ps-3 { @include padding-start(var(--spacing-3)); }
.ps-4 { @include padding-start(var(--spacing-4)); }
.ps-5 { @include padding-start(var(--spacing-5)); }

.pe-0 { @include padding-end(0); }
.pe-1 { @include padding-end(var(--spacing-1)); }
.pe-2 { @include padding-end(var(--spacing-2)); }
.pe-3 { @include padding-end(var(--spacing-3)); }
.pe-4 { @include padding-end(var(--spacing-4)); }
.pe-5 { @include padding-end(var(--spacing-5)); }

// Border utilities
.border-start {
  @include border-start(1px, solid, var(--border-color));
}

.border-end {
  @include border-end(1px, solid, var(--border-color));
}

.border-start-0 {
  [dir="ltr"] & { border-left: 0; }
  [dir="rtl"] & { border-right: 0; }
}

.border-end-0 {
  [dir="ltr"] & { border-right: 0; }
  [dir="rtl"] & { border-left: 0; }
}

// Position utilities
.start-0 { @include position-start(0); }
.end-0 { @include position-end(0); }

// === ICONS RTL SUPPORT ===
// دعم الأيقونات للتوجيه العربي

[dir="rtl"] {
  // أيقونات تحتاج انعكاس
  .icon-arrow-left,
  .icon-chevron-left,
  .icon-caret-left,
  .icon-angle-left {
    transform: scaleX(-1);
  }
  
  .icon-arrow-right,
  .icon-chevron-right,
  .icon-caret-right,
  .icon-angle-right {
    transform: scaleX(-1);
  }
  
  // أيقونات الرجوع والتقدم
  .icon-back,
  .icon-prev,
  .icon-previous {
    transform: scaleX(-1);
  }
  
  .icon-forward,
  .icon-next {
    transform: scaleX(-1);
  }
  
  // أيقونات لا تحتاج انعكاس
  .icon-search,
  .icon-close,
  .icon-check,
  .icon-plus,
  .icon-minus,
  .icon-edit,
  .icon-delete,
  .icon-save,
  .icon-settings,
  .icon-home,
  .icon-user,
  .icon-users,
  .icon-camera,
  .icon-image,
  .icon-calendar,
  .icon-clock,
  .icon-star,
  .icon-heart,
  .icon-mail,
  .icon-phone,
  .icon-location,
  .icon-globe,
  .icon-lock,
  .icon-unlock,
  .icon-eye,
  .icon-eye-off,
  .icon-upload,
  .icon-download,
  .icon-print,
  .icon-refresh,
  .icon-loading {
    transform: none;
  }
}

// === RESPONSIVE RTL ===
// دعم RTL للشاشات المختلفة

@media (max-width: 768px) {
  [dir="rtl"] {
    .sidebar {
      transform: translateX(100%);
      
      &.show {
        transform: translateX(0);
      }
    }
    
    .main-content {
      @include margin-start(0);
    }
  }
}

// === ANIMATIONS RTL SUPPORT ===
// دعم الحركات للتوجيه العربي (ربط مع ملف _animations.scss)

[dir="rtl"] {
  .slide-enter-from-left {
    transform: translateX(100%);
  }
  
  .slide-enter-from-right {
    transform: translateX(-100%);
  }
  
  .slide-exit-to-left {
    transform: translateX(100%);
  }
  
  .slide-exit-to-right {
    transform: translateX(-100%);
  }
} 