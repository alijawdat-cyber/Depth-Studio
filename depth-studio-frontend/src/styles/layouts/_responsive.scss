/**
 * ==============================================
 * DEPTH STUDIO - ŸÜÿ∏ÿßŸÖ ÿßŸÑÿßÿ≥ÿ™ÿ¨ÿßÿ®ÿ© ÿßŸÑÿ¥ÿßŸÖŸÑ
 * Comprehensive Responsive System
 * ==============================================
 */

@use "sass:map";
@use '../foundation/_variables' as vars;
@use '../foundation/_colors' as colors;
@use '../foundation/_spacing' as spacing;
@use '../foundation/_typography' as typo;
@use '../foundation/_breakpoints' as breakpoints;
@use '../utilities/_mixins' as mixins;

// ===============================
// üìê RESPONSIVE LAYOUT VARIABLES
// ===============================

$responsive-layout: (
  "mobile": (
    "sidebar-width": 100vw,
    "topbar-height": 56px,
    "content-padding": var(--spacing-sm),
    "section-gap": var(--spacing-md)
  ),
  "tablet": (
    "sidebar-width": 280px,
    "topbar-height": 60px,
    "content-padding": var(--spacing-md),
    "section-gap": var(--spacing-lg)
  ),
  "desktop": (
    "sidebar-width": 280px,
    "topbar-height": 64px,
    "content-padding": var(--spacing-lg),
    "section-gap": var(--spacing-xl)
  )
) !default;

// ===============================
// üì± MOBILE LAYOUT (xs: 0px - sm: 575px)
// ===============================

@include breakpoints.respond-below("sm") {
  :root {
    --sidebar-width: #{map.get(map.get($responsive-layout, "mobile"), "sidebar-width")};
    --topbar-height: #{map.get(map.get($responsive-layout, "mobile"), "topbar-height")};
    --content-padding: #{map.get(map.get($responsive-layout, "mobile"), "content-padding")};
    --section-gap: #{map.get(map.get($responsive-layout, "mobile"), "section-gap")};
  }
  
  // ===============================
  // üèóÔ∏è LAYOUT ADJUSTMENTS
  // ===============================
  
  .layout {
    &--with-sidebar {
      .layout__main {
        margin-left: 0 !important;
        margin-right: 0 !important;
      }
    }
    
    &__sidebar {
      width: 100vw;
      max-width: 320px;
      transform: translateX(-100%);
      z-index: map.get(vars.$z-index, "modal");
      
      [dir="rtl"] & {
        transform: translateX(100%);
      }
      
      &--open {
        transform: translateX(0);
      }
      
      // ÿ™ÿ£ÿ´Ÿäÿ± Overlay ŸÑŸÑŸÇÿßÿ¶ŸÖÿ© ÿßŸÑÿ¨ÿßŸÜÿ®Ÿäÿ©
      &--open::before {
        content: '';
        position: fixed;
        top: 0;
        left: 0;
        right: 0;
        bottom: 0;
        background: rgba(0, 0, 0, 0.5);
        z-index: -1;
      }
    }
    
    &__content {
      padding: var(--spacing-sm) !important;
      
      // ÿ¥ÿ®ŸÉÿßÿ™ ŸÖÿ®ÿ≥ÿ∑ÿ© ŸÑŸÑŸÖŸàÿ®ÿßŸäŸÑ
      &--grid {
        grid-template-columns: 1fr !important;
        gap: var(--spacing-sm) !important;
      }
      
      &--flex {
        flex-direction: column !important;
        gap: var(--spacing-sm) !important;
      }
    }
  }
  
  // ===============================
  // üìä TOPBAR MOBILE OPTIMIZATIONS
  // ===============================
  
  .topbar {
    height: var(--topbar-height);
    padding: 0 var(--spacing-sm);
    gap: var(--spacing-xs);
    
    &__brand {
      &-text {
        display: none;
      }
      
      &-logo {
        @include mixins.size(28px);
      }
    }
    
    &__search {
      display: none;
    }
    
    &__nav {
      display: none;
    }
    
    &__actions {
      gap: var(--spacing-xs);
      margin-left: auto;
      
      [dir="rtl"] & {
        margin-left: 0;
        margin-right: auto;
      }
    }
    
    &__action-btn {
      @include mixins.size(36px);
    }
    
    &__user {
      &-info,
      &-dropdown {
        display: none;
      }
      
      &-avatar {
        @include mixins.size(28px);
      }
    }
  }
  
  // ===============================
  // üìÇ SIDEBAR MOBILE OPTIMIZATIONS
  // ===============================
  
  .sidebar {
    &__header {
      padding: var(--spacing-md);
    }
    
    &__logo {
      &-icon {
        @include mixins.size(28px);
      }
      
      &-text {
        @include mixins.text-style("title-small");
      }
    }
    
    &__menu-item {
      padding: var(--spacing-sm) var(--spacing-md);
      margin: var(--spacing-xs) var(--spacing-sm);
      
      &-icon {
        @include mixins.size(18px);
      }
      
      &-text {
        @include mixins.text-style("body-small");
      }
    }
    
    &__user-info {
      padding: var(--spacing-sm);
      
      &-avatar {
        @include mixins.size(32px);
      }
    }
  }
  
  // ===============================
  // üìÑ PAGE MOBILE OPTIMIZATIONS
  // ===============================
  
  .page {
    &__container {
      padding: 0 var(--spacing-sm);
    }
    
    &__header {
      padding: var(--spacing-md) 0;
      margin-bottom: var(--spacing-md);
      
      &-title {
        @include mixins.text-style("title-large");
        margin-bottom: var(--spacing-xs);
      }
      
      &-subtitle {
        @include mixins.text-style("body");
      }
      
      &-actions {
        flex-direction: column;
        align-items: stretch;
        gap: var(--spacing-sm);
        margin-top: var(--spacing-sm);
      }
    }
    
    &__section {
      margin-bottom: var(--spacing-lg);
      
      &-title {
        @include mixins.text-style("title-medium");
        margin-bottom: var(--spacing-sm);
      }
      
      &-subtitle {
        @include mixins.text-style("body");
        margin-bottom: var(--spacing-md);
      }
    }
  }
  
  // ===============================
  // üìä DASHBOARD MOBILE OPTIMIZATIONS
  // ===============================
  
  .dashboard {
    &__grid {
      grid-template-columns: 1fr;
      gap: var(--spacing-sm);
    }
    
    &__stats {
      grid-template-columns: repeat(2, 1fr);
      gap: var(--spacing-xs);
    }
    
    &__charts {
      grid-template-columns: 1fr;
      gap: var(--spacing-md);
    }
    
    &__widget {
      &-header {
        padding: var(--spacing-sm) var(--spacing-md);
        
        &-title {
          @include mixins.text-style("title-small");
        }
      }
      
      &-content {
        padding: var(--spacing-md);
      }
      
      &-footer {
        padding: var(--spacing-sm) var(--spacing-md);
      }
    }
  }
  
  // ===============================
  // üîç SEARCH MOBILE OPTIMIZATIONS
  // ===============================
  
  .search-layout {
    &__filters {
      padding: var(--spacing-md);
      margin-bottom: var(--spacing-md);
      
      &-title {
        @include mixins.text-style("title-small");
        margin-bottom: var(--spacing-sm);
      }
      
      &-grid {
        grid-template-columns: 1fr;
        gap: var(--spacing-sm);
      }
    }
    
    &__results {
      &-header {
        flex-direction: column;
        align-items: stretch;
        gap: var(--spacing-sm);
        margin-bottom: var(--spacing-md);
        
        &-actions {
          justify-content: stretch;
          
          > * {
            flex: 1;
          }
        }
      }
      
      &-grid {
        grid-template-columns: 1fr;
        gap: var(--spacing-sm);
      }
    }
  }
}

// ===============================
// üì± TABLET LAYOUT (sm: 576px - md: 767px)
// ===============================

@include breakpoints.respond-between("sm", "md") {
  :root {
    --sidebar-width: #{map.get(map.get($responsive-layout, "tablet"), "sidebar-width")};
    --topbar-height: #{map.get(map.get($responsive-layout, "tablet"), "topbar-height")};
    --content-padding: #{map.get(map.get($responsive-layout, "tablet"), "content-padding")};
    --section-gap: #{map.get(map.get($responsive-layout, "tablet"), "section-gap")};
  }
  
  .layout {
    &__sidebar {
      width: 240px;
      
      &--compact {
        --sidebar-width: 60px;
      }
    }
    
    &__content {
      &--grid {
        &-3 {
          grid-template-columns: repeat(2, 1fr);
        }
      }
    }
  }
  
  .topbar {
    &__search {
      max-width: 300px;
    }
    
    &__nav {
      display: none;
    }
  }
  
  .dashboard {
    &__stats {
      grid-template-columns: repeat(3, 1fr);
    }
    
    &__charts {
      grid-template-columns: 1fr;
    }
  }
}

// ===============================
// üíª DESKTOP LAYOUT (md: 768px - lg: 1023px)
// ===============================

@include breakpoints.respond-between("md", "lg") {
  .layout {
    &--with-sidebar {
      flex-direction: row;
      
      .layout__main {
        margin-left: var(--sidebar-width);
        
        [dir="rtl"] & {
          margin-left: 0;
          margin-right: var(--sidebar-width);
        }
      }
    }
    
    &__sidebar {
      position: static;
      height: 100vh;
      flex-shrink: 0;
    }
  }
  
  .topbar {
    &__search {
      display: flex;
      max-width: 350px;
    }
    
    &__nav {
      display: flex;
    }
  }
}

// ===============================
// üñ•Ô∏è LARGE DESKTOP (lg: 1024px+)
// ===============================

@include breakpoints.respond-above("lg") {
  :root {
    --sidebar-width: #{map.get(map.get($responsive-layout, "desktop"), "sidebar-width")};
    --topbar-height: #{map.get(map.get($responsive-layout, "desktop"), "topbar-height")};
    --content-padding: #{map.get(map.get($responsive-layout, "desktop"), "content-padding")};
    --section-gap: #{map.get(map.get($responsive-layout, "desktop"), "section-gap")};
  }
  
  .layout {
    &--with-sidebar {
      .layout__main {
        margin-left: var(--sidebar-width);
        
        [dir="rtl"] & {
          margin-left: 0;
          margin-right: var(--sidebar-width);
        }
      }
    }
    
    &__sidebar {
      position: static;
      height: 100vh;
      flex-shrink: 0;
      
      &--collapsed {
        --sidebar-width: 60px;
      }
    }
  }
  
  .topbar {
    &__mobile-menu {
      display: none;
    }
    
    &__search {
      display: flex;
      max-width: 400px;
    }
    
    &__nav {
      display: flex;
    }
    
    &__user {
      &-info,
      &-dropdown {
        display: block;
      }
    }
  }
  
  .sidebar {
    &__toggle-btn {
      display: flex;
    }
  }
}

// ===============================
// üì∫ EXTRA LARGE SCREENS (xl: 1280px+)
// ===============================

@include breakpoints.respond-above("xl") {
  .layout {
    &__sidebar {
      &--extra-wide {
        --sidebar-width: 320px;
      }
    }
    
    &__content {
      max-width: 1400px;
      margin-left: auto;
      margin-right: auto;
    }
  }
  
  .page {
    &__container {
      max-width: 1400px;
    }
  }
  
  .dashboard {
    &__stats {
      grid-template-columns: repeat(5, 1fr);
    }
  }
}

// ===============================
// üîÑ ORIENTATION RESPONSIVE
// ===============================

// ÿßŸÑŸàÿ∂ÿπ ÿßŸÑÿ£ŸÅŸÇŸä ÿπŸÑŸâ ÿßŸÑÿ£ÿ¨Ÿáÿ≤ÿ© ÿßŸÑŸÖÿ≠ŸÖŸàŸÑÿ©
@media (orientation: landscape) and (max-height: 600px) {
  .layout {
    &__sidebar {
      height: 100vh;
      
      &__header {
        padding: var(--spacing-sm) var(--spacing-md);
      }
      
      &__menu {
        padding: var(--spacing-sm) 0;
      }
      
      &__menu-item {
        padding: var(--spacing-xs) var(--spacing-md);
      }
    }
  }
  
  .topbar {
    height: 48px;
    
    &__brand-logo {
      @include mixins.size(24px);
    }
  }
}

// ===============================
// üé® RESPONSIVE TYPOGRAPHY
// ===============================

@include breakpoints.mobile-layout {
  .page {
    &__header {
      &-title {
        @include mixins.text-style("title-large");
      }
    }
    
    &__section {
      &-title {
        @include mixins.text-style("title-medium");
      }
    }
  }
  
  .dashboard {
    &__widget {
      &-header {
        &-title {
          @include mixins.text-style("title-small");
        }
      }
    }
  }
}

// ===============================
// üöÄ PERFORMANCE OPTIMIZATIONS
// ===============================

// ÿ™ÿ≠ÿ≥ŸäŸÜ ÿßŸÑÿ£ÿØÿßÿ° ŸÑŸÑÿ£ÿ¨Ÿáÿ≤ÿ© ÿßŸÑŸÖÿ≠ŸÖŸàŸÑÿ©
@include breakpoints.mobile-layout {
  .layout {
    &__sidebar,
    &__main {
      will-change: transform;
    }
  }
  
  .topbar {
    will-change: transform;
  }
}

// ÿ™ŸÇŸÑŸäŸÑ ÿßŸÑÿ≠ÿ±ŸÉÿßÿ™ ÿπŸÑŸâ ÿßŸÑÿ£ÿ¨Ÿáÿ≤ÿ© ÿßŸÑÿ∂ÿπŸäŸÅÿ©
@media (max-width: 480px) and (max-height: 800px) {
  .layout,
  .topbar,
  .sidebar {
    * {
      transition-duration: 0.1s !important;
    }
  }
}

// ===============================
// üîß UTILITY RESPONSIVE CLASSES
// ===============================

// ÿ•ÿÆŸÅÿßÿ°/ÿ•ÿ∏Ÿáÿßÿ± ŸÖÿ™ÿ¨ÿßŸàÿ®
.hide-mobile {
  @include breakpoints.mobile-layout {
    display: none !important;
  }
}

.hide-tablet {
  @include breakpoints.tablet-layout {
    display: none !important;
  }
}

.hide-desktop {
  @include breakpoints.desktop-layout {
    display: none !important;
  }
}

.show-mobile {
  display: none !important;
  
  @include breakpoints.mobile-layout {
    display: block !important;
  }
}

.show-tablet {
  display: none !important;
  
  @include breakpoints.tablet-layout {
    display: block !important;
  }
}

.show-desktop {
  display: none !important;
  
  @include breakpoints.desktop-layout {
    display: block !important;
  }
}

// ŸÅÿ¶ÿßÿ™ ŸÖÿ≥ÿßÿπÿØÿ© ŸÑŸÑÿπÿ±ÿ∂ ÿßŸÑŸÖÿ™ÿ¨ÿßŸàÿ®
.w-mobile-full {
  @include breakpoints.mobile-layout {
    width: 100% !important;
  }
}

.w-tablet-auto {
  @include breakpoints.tablet-layout {
    width: auto !important;
  }
}

.w-desktop-fit {
  @include breakpoints.desktop-layout {
    width: fit-content !important;
  }
}

// ŸÅÿ¶ÿßÿ™ ŸÖÿ≥ÿßÿπÿØÿ© ŸÑŸÑŸÖÿ≥ÿßŸÅÿßÿ™ ÿßŸÑŸÖÿ™ÿ¨ÿßŸàÿ®ÿ©
.p-mobile-sm {
  @include breakpoints.mobile-layout {
    padding: var(--spacing-sm) !important;
  }
}

.p-tablet-md {
  @include breakpoints.tablet-layout {
    padding: var(--spacing-md) !important;
  }
}

.p-desktop-lg {
  @include breakpoints.desktop-layout {
    padding: var(--spacing-lg) !important;
  }
}

// ===============================
// üéØ ACCESSIBILITY RESPONSIVE
// ===============================

// ÿ≤ŸäÿßÿØÿ© ÿßŸÑŸÖÿ≥ÿßÿ≠ÿßÿ™ ŸÑŸÑŸÖÿ≥ ÿπŸÑŸâ ÿßŸÑÿ£ÿ¨Ÿáÿ≤ÿ© ÿßŸÑŸÖÿ≠ŸÖŸàŸÑÿ©
@include breakpoints.mobile-layout {
  .topbar__action-btn,
  .sidebar__menu-item,
  .sidebar__toggle-btn {
    min-height: 44px;
    min-width: 44px;
  }
}

// ÿ™ÿ≠ÿ≥ŸäŸÜ ÿßŸÑÿ™ÿ±ŸÉŸäÿ≤ ŸÑŸÑŸàÿ≠ÿ© ÿßŸÑŸÖŸÅÿßÿ™Ÿäÿ≠
@include breakpoints.desktop-layout {
  .layout {
    &:focus-within {
      .sidebar__menu-item:focus {
        outline: 2px solid var(--color-primary);
        outline-offset: 2px;
      }
    }
  }
}

// ===============================
// üìÑ PRINT RESPONSIVE
// ===============================

@media print {
  .layout {
    &__sidebar,
    &__header,
    &__footer {
      display: none !important;
    }
    
    &__main {
      margin: 0 !important;
      max-width: none !important;
    }
    
    &__content {
      padding: 0 !important;
    }
  }
  
  .page {
    &__header {
      border-bottom: 1px solid #000 !important;
      break-after: avoid;
    }
    
    &__section {
      break-inside: avoid;
    }
  }
  
  .hide-print {
    display: none !important;
  }
  
  .show-print {
    display: block !important;
  }
}

// ===============================
// ‚ö° REDUCED MOTION SUPPORT
// ===============================

@media (prefers-reduced-motion: reduce) {
  .layout,
  .topbar,
  .sidebar {
    &,
    *,
    *::before,
    *::after {
      animation-duration: 0.01ms !important;
      animation-iteration-count: 1 !important;
      transition-duration: 0.01ms !important;
      scroll-behavior: auto !important;
    }
  }
}

// ===============================
// üåê RTL RESPONSIVE ADJUSTMENTS
// ===============================

[dir="rtl"] {
  @include breakpoints.mobile-layout {
    .layout__sidebar {
      transform: translateX(100%);
      
      &--open {
        transform: translateX(0);
      }
    }
  }
  
  .topbar {
    &__actions {
      margin-left: 0;
      margin-right: auto;
    }
  }
  
  .layout {
    &--with-sidebar {
      .layout__main {
        @include breakpoints.desktop-layout {
          margin-left: 0;
          margin-right: var(--sidebar-width);
        }
      }
    }
  }
} 