# ๐ ูุซุงุฆู ุงุณุชูุฑุงุฏุงุช Frontend Auth Repository

## ๐ฏ ุงููุฏู ูู ูุฐุง ุงูููู
ุดุฑุญ ููุตู ููุงุฆุฏุฉ ูู ุงุณุชูุฑุงุฏ ูู `frontend-auth-repository.ts` ูููููุฉ ุงุณุชุฎุฏุงูู ููุชูุงูู ุงูุชุงู ูุน Backend ูุงูุฃููุงุน.

---

## ๐ ุงูุงุณุชูุฑุงุฏุงุช ุงูุฃุณุงุณูุฉ ูููุตุงุฏูุฉ

### `AuthMethod` - ุทุฑู ุงููุตุงุฏูุฉ ุงููุชุงุญุฉ
```typescript
interface AuthMethod {
  type: AuthProvider;                    // ููุน ุงููุตุงุฏูุฉ (email, phone, google)
  verified: boolean;                     // ูู ุชู ุงูุชุญูู ูู ูุฐู ุงูุทุฑููุฉ
  created_at: FirebaseTimestamp;         // ูุชู ุชู ุฅุถุงูุฉ ูุฐู ุงูุทุฑููุฉ
  last_used?: FirebaseTimestamp;         // ุขุฎุฑ ุงุณุชุฎุฏุงู ููุฐู ุงูุทุฑููุฉ
  metadata?: object;                     // ุจูุงูุงุช ุฅุถุงููุฉ
}
```
**๐ฏ ุงูุงุณุชุฎุฏุงู ูู Repository:**
- `getUserAuthMethods()`: ุฌูุจ ุฌููุน ุทุฑู ุงููุตุงุฏูุฉ ูููุณุชุฎุฏู
- `getAuthProviderFromMethod()`: ุชุญุฏูุฏ ููุน ููุฏู ุงููุตุงุฏูุฉ
- ุนุฑุถ ุฅุนุฏุงุฏุงุช ุงูุฃูุงู ูู ุตูุญุฉ ุงูุญุณุงุจ

---

### `PhoneVerification` - ุจูุงูุงุช ุงูุชุญูู ูู ุงููุงุชู ุงูุนุฑุงูู
```typescript
interface PhoneVerification extends BaseEntity {
  phone: string;                         // ุฑูู ุงููุงุชู (ุจุฏูู ุฑูุฒ ุงูุจูุฏ)
  country_code: string;                  // ุฑูุฒ ุงูุจูุฏ (+964 ููุนุฑุงู)
  otp_code: string;                      // ุฑูุฒ OTP (6 ุฃุฑูุงู)
  expires_at: FirebaseTimestamp;         // ูุชู ููุชูู ุตูุงุญูุฉ ุงูุฑูุฒ
  attempts: number;                      // ุนุฏุฏ ูุญุงููุงุช ุงูุชุญูู
  verified: boolean;                     // ูู ุชู ุงูุชุญูู ุจูุฌุงุญ
  status: VerificationStatus;            // ุญุงูุฉ ุงูุชุญูู
}
```
**๐ฏ ุงูุงุณุชุฎุฏุงู ูู Repository:**
- `getPhoneVerificationStatus()`: ุชุชุจุน ุญุงูุฉ ุงูุชุญูู ูู ุงููุงุชู
- ุฅุฏุงุฑุฉ cache OTP ููุนูููุงุช ุงูุชุญูู
- ุนุฑุถ ุชูุฏู ุนูููุฉ ุงูุชุญูู ูููุณุชุฎุฏู

---

### `AuthSecuritySettings` - ุฅุนุฏุงุฏุงุช ุงูุฃูุงู
```typescript
interface AuthSecuritySettings {
  max_login_attempts: number;            // ุงูุญุฏ ุงูุฃูุตู ููุญุงููุงุช ุงูุฏุฎูู
  login_lockout_duration_minutes: number; // ูุฏุฉ ุงูุญุฌุจ ุจุงูุฏูุงุฆู
  otp_expiry_minutes: number;            // ูุฏุฉ ุงูุชูุงุก OTP ุจุงูุฏูุงุฆู
  max_otp_attempts: number;              // ุงูุญุฏ ุงูุฃูุตู ููุญุงููุงุช OTP
  session_timeout_hours: number;        // ุงูุชูุงุก ุงูุฌูุณุฉ ุจุงูุณุงุนุงุช
  require_phone_verification: boolean;   // ุฅูุฒุงู ุชุญูู ุงููุงุชู
  require_email_verification: boolean;   // ุฅูุฒุงู ุชุญูู ุงูุจุฑูุฏ
}
```
**๐ฏ ุงูุงุณุชุฎุฏุงู ูู Repository:**
- `getSecuritySettings()`: ุงูุญุตูู ุนูู ุฅุนุฏุงุฏุงุช ุงูุฃูุงู ุงูุญุงููุฉ
- ุชุทุจูู ูููุฏ ุงูุฃูุงู ูู ุงูุชุทุจูู
- ุฅุนุฏุงุฏุงุช ุตูุญุฉ ุงูุฃูุงู ูู ุงูููู ุงูุดุฎุตู

---

### `AuthProvider` - ุฃููุงุน ููุฏูู ุงููุตุงุฏูุฉ
```typescript
type AuthProvider = 'email' | 'phone' | 'google';
```
**๐ฏ ุงูุงุณุชุฎุฏุงู ูู Repository:**
- `getAuthProviderFromMethod()`: ุชุญุฏูุฏ ููุน ุงููุตุงุฏูุฉ
- ููุชุฑุฉ ุงูุฅุญุตุงุฆูุงุช ุญุณุจ ููุน ุงููุตุงุฏูุฉ
- ุชุณุฌูู ุงูุฃูุดุทุฉ ูุน ููุน ุงููุตุงุฏูุฉ ุงูุตุญูุญ

---

### `FirebaseTimestamp` - ููุน ุงูุชูููุช ูู Firebase
```typescript
type FirebaseTimestamp = Timestamp; // ูู Firebase Admin SDK
```
**๐ฏ ุงูุงุณุชุฎุฏุงู ูู Repository:**
- `logLocalAuthActivity()`: ุชุณุฌูู ุงูููุช ุจุงูููุน ุงูุตุญูุญ
- ูุนุงูุฌุฉ ุชูุงุฑูุฎ ุงูุชูุงุก OTP ูุงูุฌูุณุงุช
- ุงูุชูุงูู ูุน ูุงุนุฏุฉ ุจูุงูุงุช Firebase

---

## ๐ ุจูุงูุงุช ุงูุชุณุฌูู ูุชุณุฌูู ุงูุฏุฎูู

### `EmailRegistrationData` / `PhoneRegistrationData` / `GoogleRegistrationData`
**๐ฏ ุงูุงุณุชุฎุฏุงู:**
- `registerWithEmail()` / `registerWithPhone()` / `registerWithGoogle()`
- ุถูุงู Type Safety ููุจูุงูุงุช ุงููุงุฑุฏุฉ
- ุงูุชุญูู ูู ุตุญุฉ ุงูุจูุงูุงุช ูุจู ุงูุฅุฑุณุงู ููู Backend

### `EmailLoginData` / `PhoneLoginData` / `GoogleLoginData`
**๐ฏ ุงูุงุณุชุฎุฏุงู:**
- `loginWithEmail()` / `loginWithPhone()` / `loginWithGoogle()`
- ุชูุญูุฏ ูููู ุงูุจูุงูุงุช ูุน Backend
- ุณูููุฉ ุงูุชุทููุฑ ูุงูุตูุงูุฉ

---

## ๐ฏ ูุชุงุฆุฌ ุงูุนูููุงุช

### `AuthResult` - ูุชูุฌุฉ ุนูููุงุช ุงููุตุงุฏูุฉ
```typescript
interface AuthResult {
  success: boolean;                      // ูู ุงูุนูููุฉ ูุฌุญุช
  user?: User;                           // ุจูุงูุงุช ุงููุณุชุฎุฏู
  token?: string;                        // JWT token
  needs_role_selection: boolean;         // ูู ูุญุชุงุฌ ุงุฎุชูุงุฑ ุฏูุฑ
  needs_phone_verification: boolean;     // ูู ูุญุชุงุฌ ุชุญูู ูุงุชู
  message: string;                       // ุฑุณุงูุฉ ูููุณุชุฎุฏู
}
```
**๐ฏ ุงูุงุณุชุฎุฏุงู:**
- ุฅุฑุฌุงุน ููุญุฏ ูุฌููุน ุนูููุงุช ุงูุชุณุฌูู ูุงูุฏุฎูู
- ุฅุฏุงุฑุฉ ุชุฏูู ุงููุณุชุฎุฏู ุจุนุฏ ุงููุตุงุฏูุฉ
- ุนุฑุถ ุงูุฑุณุงุฆู ุงูููุงุณุจุฉ ูููุณุชุฎุฏู

### `OTPSendResult` / `OTPVerifyResult`
**๐ฏ ุงูุงุณุชุฎุฏุงู:**
- `sendOTP()` / `verifyOTP()` / `resendOTP()`
- ุฅุฏุงุฑุฉ ุนูููุฉ OTP ุจุงูุชูุตูู
- ุนุฑุถ ุญุงูุฉ ุงูุฅุฑุณุงู ูุงูุชุญูู ูููุณุชุฎุฏู

---

## ๐ ุงูุฅุญุตุงุฆูุงุช ูุงูุชุญูููุงุช

### `RegistrationStats` - ุฅุญุตุงุฆูุงุช ุงูุชุณุฌูู
**๐ฏ ุงูุงุณุชุฎุฏุงู:**
- `getRegistrationStats()`: ูููุญุฉ ุชุญูู ุงูุฃุฏูู
- ุชุญููู ูุนุงููุฉ ุทุฑู ุงูุชุณุฌูู ุงููุฎุชููุฉ
- ุชูุงุฑูุฑ ููู ุงููุณุชุฎุฏููู

### `AuthMethodUsageStats` - ุฅุญุตุงุฆูุงุช ุงุณุชุฎุฏุงู ุทุฑู ุงููุตุงุฏูุฉ
**๐ฏ ุงูุงุณุชุฎุฏุงู:**
- `getAuthMethodUsageStats()`: ูุชุญููู ุณููู ุงููุณุชุฎุฏููู
- ุชุญุณูู ุชุฌุฑุจุฉ ุงููุณุชุฎุฏู
- ุงุชุฎุงุฐ ูุฑุงุฑุงุช ุงูููุชุฌ

### `AuthActivityLog` - ุณุฌู ุฃูุดุทุฉ ุงููุตุงุฏูุฉ
**๐ฏ ุงูุงุณุชุฎุฏุงู:**
- `getAuthActivityLog()`: ููุฃูุงู ูุงููุฑุงูุจุฉ
- `logLocalAuthActivity()`: ุชุณุฌูู ุงูุฃูุดุทุฉ ูุญููุงู
- ูุดู ุงููุดุงุท ุงููุดุจูู

---

## ๐ ุงูุฃููุงุน ุงููุณุงุนุฏุฉ

### `AuthSessionState` - ุญุงูุฉ ุฌูุณุฉ ุงููุตุงุฏูุฉ
**๐ฏ ุงูุงุณุชุฎุฏุงู:**
- `getLocalSessionState()`: ุฅุฏุงุฑุฉ ุญุงูุฉ ุงูุฌูุณุฉ
- ุชุชุจุน ุญุงูุฉ ุงููุตุงุฏูุฉ ูู ุงูุชุทุจูู
- ุฅุฏุงุฑุฉ ุงูุชูุฌูู ูุงูุตูุงุญูุงุช

### `ID` - ููุน ุงููุนุฑู ุงููุฑูุฏ
**๐ฏ ุงูุงุณุชุฎุฏุงู:**
- ุฌููุน ุงูุนูููุงุช ุงูุชู ุชุณุชุฎุฏู ูุนุฑูุงุช
- Type Safety ูููุนุฑูุงุช
- ุงูุชูุงูู ูุน ูุงุนุฏุฉ ุงูุจูุงูุงุช

### `User` - ููุน ุงููุณุชุฎุฏู
**๐ฏ ุงูุงุณุชุฎุฏุงู:**
- ุฅุฑุฌุงุน ุจูุงูุงุช ุงููุณุชุฎุฏู ูู ุงููุชุงุฆุฌ
- cache ุงููุณุชุฎุฏููู
- ุงูุชูุงูู ูุน ุฃููุงุน ุงููุณุชุฎุฏููู

### `FrontendQueryOptions` - ุฎูุงุฑุงุช ุงูุงุณุชุนูุงู
**๐ฏ ุงูุงุณุชุฎุฏุงู:**
- ุฌููุน ุนูููุงุช ุงูุจุญุซ ูุงูููุชุฑุฉ
- ุฅุฏุงุฑุฉ cache ูุงูุตูุญุงุช
- ุงูุชูุงูู ูุน ูุงุฌูุฉ BaseRepository

---

## โ ุงูุชูุงูู ูุน Backend

### ๐ ุฑุจุท ูุน AuthService.ts (1,430 ุณุทุฑ)
ุฌููุน ุงูุนูููุงุช ูู `FrontendAuthRepository` ุชุชูุงูู ูุน:
- `AuthService.registerWithEmail()` โ `registerWithEmail()`
- `AuthService.loginWithPhone()` โ `loginWithPhone()`
- `AuthService.sendOTP()` โ `sendOTP()`
- `AuthService.getUserAuthMethods()` โ `getUserAuthMethods()`

### ๐ ุฑุจุท ูุน APIs
ุฌููุน ุงูู APIs ูุฑุจูุทุฉ ุจุงูุฃููุงุน ุงูุตุญูุญุฉ:
- `/api/auth/register/email` โ `EmailRegistrationData`
- `/api/auth/login/phone` โ `PhoneLoginData`
- `/api/auth/send-otp` โ `OTPSendRequest`
- `/api/auth/methods/:userId` โ `AuthMethod[]`

---

## ๐ฏ ุงูุฎูุงุตุฉ

**ูู ุงุณุชูุฑุงุฏ ูู ุบุฑุถ ูุญุฏุฏ ูููุณุชุฎุฏู ูุนููุงู ูู Repository:**
- โ **ุงุณุชูุฑุงุฏุงุช ุงูุจูุงูุงุช**: ููุนูููุงุช ุงูุฃุณุงุณูุฉ (ุชุณุฌููุ ุฏุฎููุ OTP)
- โ **ุงุณุชูุฑุงุฏุงุช ุงููุชุงุฆุฌ**: ูุฅุฑุฌุงุน ููุญุฏ ูููุธู
- โ **ุงุณุชูุฑุงุฏุงุช ุงูุฅุญุตุงุฆูุงุช**: ููุชุญูููุงุช ูุงุชุฎุงุฐ ุงููุฑุงุฑุงุช
- โ **ุงุณุชูุฑุงุฏุงุช ุงููุณุงุนุฏุฉ**: ููู Type Safety ูุงูุชูุงูู

**๐ ุงูุชูุงูู 100%:**
- ูุน Backend AuthService (1,430 ุณุทุฑ)
- ูุน ุฃููุงุน @depth-studio/types (314 ุณุทุฑ)
- ูุน BaseRepository Pattern (508 ุณุทุฑ)

**๐ซ ูุง ููุฌุฏ ุงุณุชูุฑุงุฏุงุช ุบูุฑ ูุณุชุฎุฏูุฉ** - ูู ููุน ูู ุฏูุฑ ููุงุฆุฏุฉ ูู ุงููุธุงู! 