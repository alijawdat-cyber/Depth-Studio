<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ğŸ¯ Depth Studio API Tester</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Arial', sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            color: #333;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
        }

        .header {
            text-align: center;
            color: white;
            margin-bottom: 30px;
        }

        .header h1 {
            font-size: 2.5rem;
            margin-bottom: 10px;
        }

        .base-url {
            background: rgba(255, 255, 255, 0.1);
            padding: 15px;
            border-radius: 10px;
            margin-bottom: 30px;
            color: white;
            text-align: center;
            font-size: 1.1rem;
        }

        .systems-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(350px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }

        .system-card {
            background: white;
            border-radius: 15px;
            padding: 20px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.1);
            transition: transform 0.3s ease;
        }

        .system-card:hover {
            transform: translateY(-5px);
        }

        .system-header {
            display: flex;
            align-items: center;
            margin-bottom: 15px;
            padding-bottom: 10px;
            border-bottom: 2px solid #f0f0f0;
        }

        .system-icon {
            font-size: 1.5rem;
            margin-left: 10px;
        }

        .system-title {
            font-size: 1.3rem;
            font-weight: bold;
            color: #333;
        }

        .endpoint-group {
            margin-bottom: 15px;
        }

        .endpoint {
            background: #f8f9fa;
            border: 1px solid #e9ecef;
            border-radius: 8px;
            margin-bottom: 10px;
            overflow: hidden;
        }

        .endpoint-header {
            padding: 12px 15px;
            background: #343a40;
            color: white;
            cursor: pointer;
            display: flex;
            justify-content: space-between;
            align-items: center;
            font-size: 0.9rem;
        }

        .endpoint-header:hover {
            background: #495057;
        }

        .method {
            padding: 4px 8px;
            border-radius: 4px;
            font-weight: bold;
            font-size: 0.8rem;
        }

        .method.GET { background: #28a745; }
        .method.POST { background: #007bff; }
        .method.PUT { background: #ffc107; color: #000; }
        .method.PATCH { background: #17a2b8; }
        .method.DELETE { background: #dc3545; }

        .endpoint-content {
            padding: 15px;
            display: none;
        }

        .endpoint-content.active {
            display: block;
        }

        .form-group {
            margin-bottom: 15px;
        }

        .form-group label {
            display: block;
            margin-bottom: 5px;
            font-weight: bold;
            color: #555;
        }

        .form-group input,
        .form-group textarea,
        .form-group select {
            width: 100%;
            padding: 10px;
            border: 1px solid #ddd;
            border-radius: 5px;
            font-size: 0.9rem;
        }

        .form-group textarea {
            height: 100px;
            resize: vertical;
        }

        .btn {
            background: #007bff;
            color: white;
            padding: 10px 20px;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            font-size: 0.9rem;
            transition: background 0.3s ease;
        }

        .btn:hover {
            background: #0056b3;
        }

        .btn.test {
            background: #28a745;
        }

        .btn.test:hover {
            background: #1e7e34;
        }

        .response-area {
            margin-top: 15px;
            padding: 15px;
            background: #f8f9fa;
            border-radius: 5px;
            border: 1px solid #e9ecef;
        }

        .response-area pre {
            background: #2d3748;
            color: #e2e8f0;
            padding: 15px;
            border-radius: 5px;
            overflow-x: auto;
            font-size: 0.8rem;
            line-height: 1.4;
        }

        .auth-section {
            background: white;
            padding: 20px;
            border-radius: 15px;
            margin-bottom: 20px;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
        }

        .auth-token {
            width: 100%;
            padding: 10px;
            border: 1px solid #ddd;
            border-radius: 5px;
            margin-bottom: 10px;
        }

        .quick-test {
            background: white;
            padding: 20px;
            border-radius: 15px;
            margin-bottom: 20px;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
        }

        .quick-test-buttons {
            display: flex;
            gap: 10px;
            flex-wrap: wrap;
        }

        .status-indicator {
            display: inline-block;
            width: 10px;
            height: 10px;
            border-radius: 50%;
            margin-left: 5px;
        }

        .status-indicator.success { background: #28a745; }
        .status-indicator.error { background: #dc3545; }
        .status-indicator.loading { background: #ffc107; }

        @media (max-width: 768px) {
            .systems-grid {
                grid-template-columns: 1fr;
            }
            
            .quick-test-buttons {
                flex-direction: column;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>ğŸ¯ Depth Studio API Tester</h1>
            <p>Ø§Ø®ØªØ¨Ø§Ø± Ø´Ø§Ù…Ù„ Ù„Ø¬Ù…ÙŠØ¹ Ø§Ù„Ù€ APIs</p>
        </div>

        <div class="base-url">
            <strong>ğŸŒ Ø§Ù„Ø±Ø§Ø¨Ø· Ø§Ù„Ø£Ø³Ø§Ø³ÙŠ:</strong>
            <span id="baseUrl">https://us-central1-depth-studio.cloudfunctions.net/api</span>
        </div>

        <div class="auth-section">
            <h3>ğŸ” Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª Ø§Ù„Ù…ØµØ§Ø¯Ù‚Ø©</h3>
            <input type="text" class="auth-token" id="authToken" placeholder="Ø£Ø¯Ø®Ù„ JWT Token Ù‡Ù†Ø§ (Ø§Ø®ØªÙŠØ§Ø±ÙŠ)">
            <p style="color: #666; font-size: 0.9rem;">
                ğŸ’¡ Ø¨Ø¹Ø¶ Ø§Ù„Ù€ endpoints ØªØ­ØªØ§Ø¬ Ù…ØµØ§Ø¯Ù‚Ø©. Ø£Ø¯Ø®Ù„ Ø§Ù„Ù€ token Ù‡Ù†Ø§ Ù„Ø§Ø³ØªØ®Ø¯Ø§Ù…Ù‡ ÙÙŠ Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø·Ù„Ø¨Ø§Øª.
            </p>
        </div>

        <div class="quick-test">
            <h3>âš¡ Ø§Ø®ØªØ¨Ø§Ø±Ø§Øª Ø³Ø±ÙŠØ¹Ø©</h3>
            <div class="quick-test-buttons">
                <button class="btn test" onclick="quickTest('health')">ğŸ¥ Health Check</button>
                <button class="btn test" onclick="quickTest('devInfo')">ğŸ§ª Dev Info</button>
                <button class="btn test" onclick="quickTest('userStats')">ğŸ‘¤ User Stats</button>
                <button class="btn test" onclick="quickTest('brandStats')">ğŸ¢ Brand Stats</button>
                <button class="btn test" onclick="quickTest('phoneValidation')">ğŸ“± Phone Validation</button>
            </div>
            <div id="quickTestResult" class="response-area" style="display: none;"></div>
        </div>

        <div class="systems-grid">
            <!-- Authentication System -->
            <div class="system-card">
                <div class="system-header">
                    <span class="system-icon">ğŸ”</span>
                    <span class="system-title">Ù†Ø¸Ø§Ù… Ø§Ù„Ù…ØµØ§Ø¯Ù‚Ø©</span>
                </div>
                
                <div class="endpoint">
                    <div class="endpoint-header" onclick="toggleEndpoint(this)">
                        <span><span class="method POST">POST</span> ØªØ³Ø¬ÙŠÙ„ Ø¨Ø§Ù„Ø¥ÙŠÙ…ÙŠÙ„</span>
                        <span>â–¼</span>
                    </div>
                    <div class="endpoint-content">
                        <form onsubmit="sendRequest(event, 'POST', '/api/auth/register/email')">
                            <div class="form-group">
                                <label>Ø§Ù„Ø¥ÙŠÙ…ÙŠÙ„:</label>
                                <input type="email" name="email" value="test@example.com" required>
                            </div>
                            <div class="form-group">
                                <label>ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ±:</label>
                                <input type="password" name="password" value="SecurePass123!" required>
                            </div>
                            <div class="form-group">
                                <label>ØªØ£ÙƒÙŠØ¯ ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ±:</label>
                                <input type="password" name="confirm_password" value="SecurePass123!" required>
                            </div>
                            <div class="form-group">
                                <label>Ø§Ù„Ø§Ø³Ù… Ø§Ù„ÙƒØ§Ù…Ù„:</label>
                                <input type="text" name="full_name" value="Ø£Ø­Ù…Ø¯ Ù…Ø­Ù…Ø¯ Ø§Ù„Ø¹Ø±Ø§Ù‚ÙŠ" required>
                            </div>
                            <div class="form-group">
                                <label>Ø§Ù„Ù‡Ø§ØªÙ (Ø§Ø®ØªÙŠØ§Ø±ÙŠ):</label>
                                <input type="text" name="phone" value="+9647701234567" placeholder="+9647701234567">
                            </div>
                            <div class="form-group">
                                <label>
                                    <input type="checkbox" name="accept_terms" value="true" checked required>
                                    Ø£ÙˆØ§ÙÙ‚ Ø¹Ù„Ù‰ Ø§Ù„Ø´Ø±ÙˆØ· ÙˆØ§Ù„Ø£Ø­ÙƒØ§Ù…
                                </label>
                            </div>
                            <button type="submit" class="btn">Ø¥Ø±Ø³Ø§Ù„</button>
                        </form>
                        <div class="response-area"></div>
                    </div>
                </div>

                <div class="endpoint">
                    <div class="endpoint-header" onclick="toggleEndpoint(this)">
                        <span><span class="method POST">POST</span> ØªØ³Ø¬ÙŠÙ„ Ø¯Ø®ÙˆÙ„ Ø¨Ø§Ù„Ø¥ÙŠÙ…ÙŠÙ„</span>
                        <span>â–¼</span>
                    </div>
                    <div class="endpoint-content">
                        <form onsubmit="sendRequest(event, 'POST', '/api/auth/login/email')">
                            <div class="form-group">
                                <label>Ø§Ù„Ø¥ÙŠÙ…ÙŠÙ„:</label>
                                <input type="email" name="email" required>
                            </div>
                            <div class="form-group">
                                <label>ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ±:</label>
                                <input type="password" name="password" required>
                            </div>
                            <button type="submit" class="btn">Ø¥Ø±Ø³Ø§Ù„</button>
                        </form>
                        <div class="response-area"></div>
                    </div>
                </div>

                <div class="endpoint">
                    <div class="endpoint-header" onclick="toggleEndpoint(this)">
                        <span><span class="method POST">POST</span> Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ø±Ù‚Ù… Ø§Ù„Ù‡Ø§ØªÙ</span>
                        <span>â–¼</span>
                    </div>
                    <div class="endpoint-content">
                        <form onsubmit="sendRequest(event, 'POST', '/api/auth/validate-phone')">
                            <div class="form-group">
                                <label>Ø±Ù‚Ù… Ø§Ù„Ù‡Ø§ØªÙ:</label>
                                <input type="text" name="phone" placeholder="+9647701234567" required>
                            </div>
                            <div class="form-group">
                                <label>Ø±Ù…Ø² Ø§Ù„Ø¨Ù„Ø¯:</label>
                                <input type="text" name="country_code" value="+964" required>
                            </div>
                            <button type="submit" class="btn">Ø¥Ø±Ø³Ø§Ù„</button>
                        </form>
                        <div class="response-area"></div>
                    </div>
                </div>
            </div>

            <!-- Users System -->
            <div class="system-card">
                <div class="system-header">
                    <span class="system-icon">ğŸ‘¤</span>
                    <span class="system-title">Ù†Ø¸Ø§Ù… Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…ÙŠÙ†</span>
                </div>

                <div class="endpoint">
                    <div class="endpoint-header" onclick="toggleEndpoint(this)">
                        <span><span class="method GET">GET</span> Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…ÙŠÙ†</span>
                        <span>â–¼</span>
                    </div>
                    <div class="endpoint-content">
                        <button onclick="sendGetRequest('/api/users/stats', this)" class="btn">Ø¬Ù„Ø¨ Ø§Ù„Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª</button>
                        <div class="response-area"></div>
                    </div>
                </div>

                <div class="endpoint">
                    <div class="endpoint-header" onclick="toggleEndpoint(this)">
                        <span><span class="method GET">GET</span> Ø§Ù„Ø¨Ø­Ø« ÙÙŠ Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…ÙŠÙ†</span>
                        <span>â–¼</span>
                    </div>
                    <div class="endpoint-content">
                        <form onsubmit="sendSearchRequest(event, '/api/users/search')">
                            <div class="form-group">
                                <label>ÙƒÙ„Ù…Ø© Ø§Ù„Ø¨Ø­Ø«:</label>
                                <input type="text" name="keyword" placeholder="Ø§Ø³Ù… Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…">
                            </div>
                            <div class="form-group">
                                <label>Ø§Ù„Ø¯ÙˆØ±:</label>
                                <select name="role">
                                    <option value="">Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø£Ø¯ÙˆØ§Ø±</option>
                                    <option value="admin">Ù…Ø¯ÙŠØ±</option>
                                    <option value="photographer">Ù…ØµÙˆØ±</option>
                                    <option value="brand_coordinator">Ù…Ù†Ø³Ù‚ Ø¨Ø±Ø§Ù†Ø¯</option>
                                </select>
                            </div>
                            <div class="form-group">
                                <label>Ø§Ù„ØµÙØ­Ø©:</label>
                                <input type="number" name="page" value="1" min="1">
                            </div>
                            <div class="form-group">
                                <label>Ø¹Ø¯Ø¯ Ø§Ù„Ù†ØªØ§Ø¦Ø¬:</label>
                                <input type="number" name="limit" value="10" min="1" max="100">
                            </div>
                            <button type="submit" class="btn">Ø§Ù„Ø¨Ø­Ø«</button>
                        </form>
                        <div class="response-area"></div>
                    </div>
                </div>
            </div>

            <!-- Brands System -->
            <div class="system-card">
                <div class="system-header">
                    <span class="system-icon">ğŸ¢</span>
                    <span class="system-title">Ù†Ø¸Ø§Ù… Ø§Ù„Ø¨Ø±Ø§Ù†Ø¯Ø§Øª</span>
                </div>

                <div class="endpoint">
                    <div class="endpoint-header" onclick="toggleEndpoint(this)">
                        <span><span class="method GET">GET</span> Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª Ø§Ù„Ø¨Ø±Ø§Ù†Ø¯Ø§Øª</span>
                        <span>â–¼</span>
                    </div>
                    <div class="endpoint-content">
                        <button onclick="sendGetRequest('/api/brands/stats', this)" class="btn">Ø¬Ù„Ø¨ Ø§Ù„Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª</button>
                        <div class="response-area"></div>
                    </div>
                </div>

                <div class="endpoint">
                    <div class="endpoint-header" onclick="toggleEndpoint(this)">
                        <span><span class="method POST">POST</span> Ø¥Ù†Ø´Ø§Ø¡ Ø¨Ø±Ø§Ù†Ø¯ Ø¬Ø¯ÙŠØ¯</span>
                        <span>â–¼</span>
                    </div>
                    <div class="endpoint-content">
                        <form onsubmit="sendRequest(event, 'POST', '/api/brands')">
                            <div class="form-group">
                                <label>Ø§Ø³Ù… Ø§Ù„Ø¨Ø±Ø§Ù†Ø¯:</label>
                                <input type="text" name="name" required>
                            </div>
                            <div class="form-group">
                                <label>Ø§Ù„ÙˆØµÙ:</label>
                                <textarea name="description" required></textarea>
                            </div>
                            <div class="form-group">
                                <label>Ø§Ù„ØµÙ†Ø§Ø¹Ø©:</label>
                                <select name="industry" required>
                                    <option value="">Ø§Ø®ØªØ± Ø§Ù„ØµÙ†Ø§Ø¹Ø©</option>
                                    <option value="food_beverage">Ø·Ø¹Ø§Ù… ÙˆÙ…Ø´Ø±ÙˆØ¨Ø§Øª</option>
                                    <option value="fashion">Ø£Ø²ÙŠØ§Ø¡</option>
                                    <option value="technology">ØªÙƒÙ†ÙˆÙ„ÙˆØ¬ÙŠØ§</option>
                                    <option value="automotive">Ø³ÙŠØ§Ø±Ø§Øª</option>
                                    <option value="real_estate">Ø¹Ù‚Ø§Ø±Ø§Øª</option>
                                </select>
                            </div>
                            <div class="form-group">
                                <label>Ø§Ù„Ù†ÙˆØ¹:</label>
                                <select name="type" required>
                                    <option value="">Ø§Ø®ØªØ± Ø§Ù„Ù†ÙˆØ¹</option>
                                    <option value="restaurant">Ù…Ø·Ø¹Ù…</option>
                                    <option value="retail">Ù…ØªØ¬Ø±</option>
                                    <option value="service">Ø®Ø¯Ù…Ø©</option>
                                    <option value="ecommerce">ØªØ¬Ø§Ø±Ø© Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠØ©</option>
                                </select>
                            </div>
                            <div class="form-group">
                                <label>Ø§Ù„Ø¥ÙŠÙ…ÙŠÙ„:</label>
                                <input type="email" name="contact_email" required>
                            </div>
                            <div class="form-group">
                                <label>Ø§Ù„Ù‡Ø§ØªÙ:</label>
                                <input type="text" name="phone">
                            </div>
                            <button type="submit" class="btn">Ø¥Ù†Ø´Ø§Ø¡ Ø§Ù„Ø¨Ø±Ø§Ù†Ø¯</button>
                        </form>
                        <div class="response-area"></div>
                    </div>
                </div>
            </div>

            <!-- Notifications System -->
            <div class="system-card">
                <div class="system-header">
                    <span class="system-icon">ğŸ””</span>
                    <span class="system-title">Ù†Ø¸Ø§Ù… Ø§Ù„Ø¥Ø´Ø¹Ø§Ø±Ø§Øª</span>
                </div>

                <div class="endpoint">
                    <div class="endpoint-header" onclick="toggleEndpoint(this)">
                        <span><span class="method GET">GET</span> Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª Ø§Ù„Ø¥Ø´Ø¹Ø§Ø±Ø§Øª</span>
                        <span>â–¼</span>
                    </div>
                    <div class="endpoint-content">
                        <button onclick="sendGetRequest('/api/notifications/stats', this)" class="btn">Ø¬Ù„Ø¨ Ø§Ù„Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª</button>
                        <div class="response-area"></div>
                    </div>
                </div>

                <div class="endpoint">
                    <div class="endpoint-header" onclick="toggleEndpoint(this)">
                        <span><span class="method POST">POST</span> Ø¥Ø±Ø³Ø§Ù„ Ø¥Ø´Ø¹Ø§Ø±</span>
                        <span>â–¼</span>
                    </div>
                    <div class="endpoint-content">
                        <form onsubmit="sendRequest(event, 'POST', '/api/notifications')">
                            <div class="form-group">
                                <label>Ø§Ù„Ù…Ø³ØªÙ„Ù… (User ID):</label>
                                <input type="text" name="recipient_id" required>
                            </div>
                            <div class="form-group">
                                <label>Ø§Ù„Ø¹Ù†ÙˆØ§Ù†:</label>
                                <input type="text" name="title" required>
                            </div>
                            <div class="form-group">
                                <label>Ø§Ù„Ø±Ø³Ø§Ù„Ø©:</label>
                                <textarea name="message" required></textarea>
                            </div>
                            <div class="form-group">
                                <label>Ø§Ù„Ù†ÙˆØ¹:</label>
                                <select name="type" required>
                                    <option value="info">Ù…Ø¹Ù„ÙˆÙ…Ø§Øª</option>
                                    <option value="warning">ØªØ­Ø°ÙŠØ±</option>
                                    <option value="campaign_notification">Ø¥Ø´Ø¹Ø§Ø± Ø­Ù…Ù„Ø©</option>
                                    <option value="payment_notification">Ø¥Ø´Ø¹Ø§Ø± Ø¯ÙØ¹</option>
                                </select>
                            </div>
                            <div class="form-group">
                                <label>Ø§Ù„Ø£ÙˆÙ„ÙˆÙŠØ©:</label>
                                <select name="priority">
                                    <option value="low">Ù…Ù†Ø®ÙØ¶Ø©</option>
                                    <option value="medium" selected>Ù…ØªÙˆØ³Ø·Ø©</option>
                                    <option value="high">Ø¹Ø§Ù„ÙŠØ©</option>
                                    <option value="urgent">Ø¹Ø§Ø¬Ù„Ø©</option>
                                </select>
                            </div>
                            <button type="submit" class="btn">Ø¥Ø±Ø³Ø§Ù„ Ø§Ù„Ø¥Ø´Ø¹Ø§Ø±</button>
                        </form>
                        <div class="response-area"></div>
                    </div>
                </div>
            </div>

            <!-- Health Check -->
            <div class="system-card">
                <div class="system-header">
                    <span class="system-icon">ğŸ¥</span>
                    <span class="system-title">ÙØ­Øµ Ø§Ù„ØµØ­Ø©</span>
                </div>

                <div class="endpoint">
                    <div class="endpoint-header" onclick="toggleEndpoint(this)">
                        <span><span class="method GET">GET</span> ÙØ­Øµ ØµØ­Ø© Ø§Ù„Ù†Ø¸Ø§Ù…</span>
                        <span>â–¼</span>
                    </div>
                    <div class="endpoint-content">
                        <button onclick="sendGetRequest('/health', this)" class="btn">ÙØ­Øµ Ø§Ù„ØµØ­Ø©</button>
                        <div class="response-area"></div>
                    </div>
                </div>

                <div class="endpoint">
                    <div class="endpoint-header" onclick="toggleEndpoint(this)">
                        <span><span class="method GET">GET</span> Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø§Ù„Ù†Ø¸Ø§Ù…</span>
                        <span>â–¼</span>
                    </div>
                    <div class="endpoint-content">
                        <button onclick="sendGetRequest('', this)" class="btn">Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø§Ù„Ù†Ø¸Ø§Ù…</button>
                        <div class="response-area"></div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        const BASE_URL = 'https://us-central1-depth-studio.cloudfunctions.net/api';

        function toggleEndpoint(header) {
            const content = header.nextElementSibling;
            const arrow = header.querySelector('span:last-child');
            
            if (content.classList.contains('active')) {
                content.classList.remove('active');
                arrow.textContent = 'â–¼';
            } else {
                content.classList.add('active');
                arrow.textContent = 'â–²';
            }
        }

        function getAuthToken() {
            return document.getElementById('authToken').value.trim();
        }

        function getHeaders() {
            const headers = {
                'Content-Type': 'application/json'
            };
            
            const token = getAuthToken();
            if (token) {
                headers['Authorization'] = `Bearer ${token}`;
            }
            
            return headers;
        }

        function showResponse(element, response, isError = false) {
            const responseArea = element.querySelector('.response-area') || element.nextElementSibling;
            responseArea.style.display = 'block';
            
            const statusClass = isError ? 'error' : 'success';
            const statusText = isError ? 'Ø®Ø·Ø£' : 'Ù†Ø¬Ø­';
            
            responseArea.innerHTML = `
                <div style="margin-bottom: 10px;">
                    <strong>Ø§Ù„Ø­Ø§Ù„Ø©:</strong> 
                    <span class="status-indicator ${statusClass}"></span>
                    ${statusText}
                </div>
                <pre>${JSON.stringify(response, null, 2)}</pre>
            `;
        }

        function showLoading(element) {
            const responseArea = element.querySelector('.response-area') || element.nextElementSibling;
            responseArea.style.display = 'block';
            responseArea.innerHTML = `
                <div>
                    <span class="status-indicator loading"></span>
                    Ø¬Ø§Ø±ÙŠ Ø§Ù„ØªØ­Ù…ÙŠÙ„...
                </div>
            `;
        }

        async function sendRequest(event, method, endpoint) {
            event.preventDefault();
            
            const form = event.target;
            const formData = new FormData(form);
            const data = {};
            
            for (let [key, value] of formData.entries()) {
                // Handle checkboxes
                if (form.querySelector(`[name="${key}"][type="checkbox"]`)) {
                    data[key] = value === 'true';
                } else {
                    data[key] = value;
                }
            }
            
            // Handle unchecked checkboxes
            const checkboxes = form.querySelectorAll('input[type="checkbox"]');
            checkboxes.forEach(checkbox => {
                if (!formData.has(checkbox.name)) {
                    data[checkbox.name] = false;
                }
            });
            
            showLoading(form.parentElement);
            
            try {
                const response = await fetch(`${BASE_URL}${endpoint}`, {
                    method: method,
                    headers: getHeaders(),
                    body: JSON.stringify(data)
                });
                
                const result = await response.json();
                showResponse(form.parentElement, result, !response.ok);
                
            } catch (error) {
                showResponse(form.parentElement, { error: error.message }, true);
            }
        }

        async function sendGetRequest(endpoint, element) {
            showLoading(element.parentElement);
            
            try {
                const response = await fetch(`${BASE_URL}${endpoint}`, {
                    method: 'GET',
                    headers: getHeaders()
                });
                
                const result = await response.json();
                showResponse(element.parentElement, result, !response.ok);
                
            } catch (error) {
                showResponse(element.parentElement, { error: error.message }, true);
            }
        }

        async function sendSearchRequest(event, endpoint) {
            event.preventDefault();
            
            const form = event.target;
            const formData = new FormData(form);
            const params = new URLSearchParams();
            
            for (let [key, value] of formData.entries()) {
                if (value) {
                    params.append(key, value);
                }
            }
            
            const url = `${BASE_URL}${endpoint}?${params.toString()}`;
            
            showLoading(form.parentElement);
            
            try {
                const response = await fetch(url, {
                    method: 'GET',
                    headers: getHeaders()
                });
                
                const result = await response.json();
                showResponse(form.parentElement, result, !response.ok);
                
            } catch (error) {
                showResponse(form.parentElement, { error: error.message }, true);
            }
        }

        async function quickTest(testType) {
            const resultDiv = document.getElementById('quickTestResult');
            resultDiv.style.display = 'block';
            resultDiv.innerHTML = '<div><span class="status-indicator loading"></span> Ø¬Ø§Ø±ÙŠ Ø§Ù„Ø§Ø®ØªØ¨Ø§Ø±...</div>';
            
            let endpoint = '';
            let method = 'GET';
            let body = null;
            
            switch(testType) {
                case 'health':
                    endpoint = '/health';
                    break;
                case 'devInfo':
                    endpoint = '';
                    break;
                case 'userStats':
                    endpoint = '/api/users/stats';
                    break;
                case 'brandStats':
                    endpoint = '/api/brands/stats';
                    break;
                case 'phoneValidation':
                    endpoint = '/api/auth/validate-phone';
                    method = 'POST';
                    body = JSON.stringify({
                        phone: '+9647701234567',
                        country_code: '+964'
                    });
                    break;
            }
            
            try {
                const options = {
                    method: method,
                    headers: getHeaders()
                };
                
                if (body) {
                    options.body = body;
                }
                
                const response = await fetch(`${BASE_URL}${endpoint}`, options);
                const result = await response.json();
                
                const statusClass = response.ok ? 'success' : 'error';
                const statusText = response.ok ? 'Ù†Ø¬Ø­' : 'Ø®Ø·Ø£';
                
                resultDiv.innerHTML = `
                    <div style="margin-bottom: 10px;">
                        <strong>Ø§Ø®ØªØ¨Ø§Ø± ${testType}:</strong>
                        <span class="status-indicator ${statusClass}"></span>
                        ${statusText}
                    </div>
                    <pre>${JSON.stringify(result, null, 2)}</pre>
                `;
                
            } catch (error) {
                resultDiv.innerHTML = `
                    <div style="margin-bottom: 10px;">
                        <strong>Ø§Ø®ØªØ¨Ø§Ø± ${testType}:</strong>
                        <span class="status-indicator error"></span>
                        Ø®Ø·Ø£
                    </div>
                    <pre>${JSON.stringify({ error: error.message }, null, 2)}</pre>
                `;
            }
        }

        // Auto-expand first endpoint in each system
        document.addEventListener('DOMContentLoaded', function() {
            const firstEndpoints = document.querySelectorAll('.system-card .endpoint:first-of-type .endpoint-header');
            firstEndpoints.forEach(header => {
                // toggleEndpoint(header);
            });
        });
    </script>
</body>
</html> 