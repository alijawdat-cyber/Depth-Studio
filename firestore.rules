rules_version = '2';

// ğŸ”’ Ù‚ÙˆØ§Ø¹Ø¯ Ø£Ù…Ø§Ù† Firestore Ø´Ø§Ù…Ù„Ø© ÙˆÙ…Ø­ÙƒÙ…Ø© - Depth Studio
// ğŸ“… ØªÙ… Ø¥Ù†Ø´Ø§Ø¤Ù‡Ø§: 31 Ù…Ø§ÙŠÙˆ 2025
// ğŸ‘¤ Ø§Ù„Ù…Ø³Ø¤ÙˆÙ„: Ø¹Ù„ÙŠ Ø¬ÙˆØ¯Øª
// ğŸ¯ Ø§Ù„Ù‡Ø¯Ù: Ø§Ø³ØªØ¨Ø¯Ø§Ù„ Ø§Ù„Ù‚ÙˆØ§Ø¹Ø¯ Ø§Ù„Ù…Ø¤Ù‚ØªØ© Ù‚Ø¨Ù„ 28 ÙŠÙˆÙ†ÙŠÙˆ 2025

service cloud.firestore {
  match /databases/{database}/documents {
    
    // ==========================================
    // ğŸŒ± TEMPORARY SEEDING RULES (Ù‚ÙˆØ§Ø¹Ø¯ Ø§Ù„Ø²Ø±Ø§Ø¹Ø© Ø§Ù„Ù…Ø¤Ù‚ØªØ©)
    // ==========================================
    // Ø§Ù„Ø³Ù…Ø§Ø­ Ø¨Ø§Ù„ÙƒØªØ§Ø¨Ø© Ù„Ù„Ù…Ø¬Ù…ÙˆØ¹Ø§Øª Ø§Ù„Ø£Ø³Ø§Ø³ÙŠØ© Ø¨Ø¯ÙˆÙ† Ù…ØµØ§Ø¯Ù‚Ø© Ù„Ù„Ø²Ø±Ø§Ø¹Ø© Ø§Ù„Ø£ÙˆÙ„ÙŠØ© ÙÙ‚Ø·
    match /roles/{document} {
      allow read, write: if true;
    }
    match /templates/{document} {
      allow read, write: if true;
    }
    match /content/{document} {
      allow read, write: if true;
    }
    match /campaigns/{document} {
      allow read, write: if true;
    }
    match /settings/{document} {
      allow read, write: if true;
    }
    match /notifications/{document} {
      allow read, write: if true;
    }
    match /users/{document} {
      allow read, write: if true;
    }
    match /user_permissions/{document} {
      allow read, write: if true;
    }
    match /brands/{document} {
      allow read, write: if true;
    }
    match /brand_coordinators/{document} {
      allow read, write: if true;
    }
    match /photographer_profiles/{document} {
      allow read, write: if true;
    }
    match /content_categories/{document} {
      allow read, write: if true;
    }
    match /equipment/{document} {
      allow read, write: if true;
    }
    
    // ==========================================
    // ğŸ› ï¸ HELPER FUNCTIONS (Ø¯ÙˆØ§Ù„ Ù…Ø³Ø§Ø¹Ø¯Ø©)
    // ==========================================
    
    // Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„
    function isAuthenticated() {
      return request.auth != null;
    }
    
    // Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ù…Ù„ÙƒÙŠØ© Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…
    function isOwner(userId) {
      return request.auth.uid == userId;
    }
    
    // Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† ØµÙ„Ø§Ø­ÙŠØ© Super Admin
    function isSuperAdmin() {
      return isAuthenticated() && 
             exists(/databases/$(database)/documents/users/$(request.auth.uid)) &&
             get(/databases/$(database)/documents/users/$(request.auth.uid)).data.primary_role == 'super_admin';
    }
    
    // Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† ØµÙ„Ø§Ø­ÙŠØ© Marketing Coordinator
    function isMarketingCoordinator() {
      return isAuthenticated() && 
             exists(/databases/$(database)/documents/users/$(request.auth.uid)) &&
             get(/databases/$(database)/documents/users/$(request.auth.uid)).data.primary_role == 'marketing_coordinator';
    }
    
    // Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† ØµÙ„Ø§Ø­ÙŠØ© Brand Coordinator
    function isBrandCoordinator() {
      return isAuthenticated() && 
             exists(/databases/$(database)/documents/users/$(request.auth.uid)) &&
             get(/databases/$(database)/documents/users/$(request.auth.uid)).data.primary_role == 'brand_coordinator';
    }
    
    // Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† ØµÙ„Ø§Ø­ÙŠØ© Photographer
    function isPhotographer() {
      return isAuthenticated() && 
             exists(/databases/$(database)/documents/users/$(request.auth.uid)) &&
             get(/databases/$(database)/documents/users/$(request.auth.uid)).data.primary_role == 'photographer';
    }
    
    // Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ø§Ù„ØµÙ„Ø§Ø­ÙŠØ§Øª Ø§Ù„Ø¥Ø¯Ø§Ø±ÙŠØ© (Super Admin Ø£Ùˆ Marketing Coordinator)
    function hasAdminAccess() {
      return isSuperAdmin() || isMarketingCoordinator();
    }
    
    // Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† ØµÙ„Ø§Ø­ÙŠØ© Ù…Ø­Ø¯Ø¯Ø© ÙÙŠ user_permissions
    function hasPermission(permissionType, action) {
      return isAuthenticated() && 
             exists(/databases/$(database)/documents/user_permissions/$(request.auth.uid)) &&
             get(/databases/$(database)/documents/user_permissions/$(request.auth.uid)).data.crud_permissions[permissionType][action] == true;
    }
    
    // Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ø§Ù„ÙˆØµÙˆÙ„ Ù„Ø¨Ø±Ø§Ù†Ø¯ Ù…Ø­Ø¯Ø¯
    function hasBrandAccess(brandId) {
      return isSuperAdmin() || 
             (isBrandCoordinator() && 
              exists(/databases/$(database)/documents/brand_coordinators/$(request.auth.uid)) &&
              get(/databases/$(database)/documents/brand_coordinators/$(request.auth.uid)).data.brand_id == brandId) ||
             hasAdminAccess();
    }
    
    // ==========================================
    // ğŸ‘¥ USERS COLLECTION (Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…ÙŠÙ†)
    // ==========================================
    match /users/{userId} {
      // Ø§Ù„Ù‚Ø±Ø§Ø¡Ø©: Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… Ù†ÙØ³Ù‡ Ø£Ùˆ Ø§Ù„Ù…Ø¯Ø±Ø§Ø¡
      allow read: if isOwner(userId) || hasAdminAccess() || hasPermission('users', 'read');
      
      // Ø§Ù„Ø¥Ù†Ø´Ø§Ø¡: Super Admin Ø£Ùˆ Ø§Ù„ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø°Ø§ØªÙŠ Ù„Ù„Ù…Ø³ØªØ®Ø¯Ù…ÙŠÙ† Ø§Ù„Ø¬Ø¯Ø¯
      // ğŸ”¥ Ø­Ù„ Ø§Ù„Ù…Ø´ÙƒÙ„Ø©: Ø§Ù„Ø³Ù…Ø§Ø­ Ù„Ù„Ù…Ø³ØªØ®Ø¯Ù…ÙŠÙ† Ø§Ù„Ø¬Ø¯Ø¯ Ø¨Ø¥Ù†Ø´Ø§Ø¡ Ù…Ù„ÙØ§ØªÙ‡Ù…
      allow create: if isSuperAdmin() || 
                       (isOwner(userId) && request.auth.uid == userId) ||
                       // Ø´Ø±Ø· Ø®Ø§Øµ Ù„Ù„Ù…Ø³ØªØ®Ø¯Ù…ÙŠÙ† Ø§Ù„Ø¬Ø¯Ø¯ Ø£Ø«Ù†Ø§Ø¡ Ø§Ù„ØªØ³Ø¬ÙŠÙ„
                       (request.auth != null && 
                        request.auth.uid == userId &&
                        (request.resource.data.primary_role == 'new_user' || 
                         request.resource.data.primary_role == 'photographer') && // Ù…Ø¤Ù‚Øª Ù„Ù„ØªÙˆØ§ÙÙ‚
                        request.resource.data.firebase_uid == request.auth.uid);
      
      // Ø§Ù„ØªØ­Ø¯ÙŠØ«: Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… Ù†ÙØ³Ù‡ Ù„Ø¨ÙŠØ§Ù†Ø§ØªÙ‡ Ø§Ù„Ø£Ø³Ø§Ø³ÙŠØ©ØŒ Ø£Ùˆ Super Admin Ù„Ù„ÙƒÙ„
      // ğŸ”¥ ØªØ­Ø¯ÙŠØ« Ø¬Ø¯ÙŠØ¯: Ø§Ù„Ø³Ù…Ø§Ø­ Ù„Ù„Ù…Ø³ØªØ®Ø¯Ù…ÙŠÙ† Ø§Ù„Ø¬Ø¯Ø¯ Ø¨ØªØ­Ø¯ÙŠØ« Ø¯ÙˆØ±Ù‡Ù… Ù…Ø±Ø© ÙˆØ§Ø­Ø¯Ø©
      allow update: if (isOwner(userId) && (
                        // Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… Ø§Ù„Ø¹Ø§Ø¯ÙŠ - Ù„Ø§ ÙŠÙ…ÙƒÙ†Ù‡ ØªØ­Ø¯ÙŠØ« Ø§Ù„Ø¯ÙˆØ± ÙˆØ§Ù„UID
                        (!("primary_role" in request.resource.data.diff(resource.data).changedKeys()) &&
                         !("firebase_uid" in request.resource.data.diff(resource.data).changedKeys())) ||
                        // Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… Ø§Ù„Ø¬Ø¯ÙŠØ¯ - ÙŠÙ…ÙƒÙ†Ù‡ ØªØ­Ø¯ÙŠØ« Ø¯ÙˆØ±Ù‡ Ù…Ø±Ø© ÙˆØ§Ø­Ø¯Ø© ÙÙ‚Ø· Ø¥Ø°Ø§ ÙƒØ§Ù† new_user
                        (resource.data.primary_role == 'new_user' && 
                         resource.data.status == 'pending_role_setup' &&
                         request.resource.data.primary_role in ['photographer', 'brand_coordinator', 'marketing_coordinator'] &&
                         request.resource.data.status in ['pending_approval'])
                      )) ||
                       isSuperAdmin() ||
                       hasPermission('users', 'update');
      
      // Ø§Ù„Ø­Ø°Ù: Super Admin ÙÙ‚Ø·
      allow delete: if isSuperAdmin() || hasPermission('users', 'delete');
    }
    
    // ==========================================
    // ğŸ” USER_PERMISSIONS COLLECTION (Ø§Ù„ØµÙ„Ø§Ø­ÙŠØ§Øª)
    // ==========================================
    match /user_permissions/{userId} {
      // Ø§Ù„Ù‚Ø±Ø§Ø¡Ø©: Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… Ù†ÙØ³Ù‡ Ø£Ùˆ Ø§Ù„Ù…Ø¯Ø±Ø§Ø¡
      allow read: if isOwner(userId) || hasAdminAccess();
      
      // Ø§Ù„Ø¥Ù†Ø´Ø§Ø¡ ÙˆØ§Ù„ØªØ­Ø¯ÙŠØ« ÙˆØ§Ù„Ø­Ø°Ù: Super Admin ÙÙ‚Ø·
      allow create, update, delete: if isSuperAdmin();
    }
    
    // ==========================================
    // ğŸ‘¨â€ğŸ’¼ PHOTOGRAPHER_PROFILES COLLECTION (Ù…Ù„ÙØ§Øª Ø§Ù„Ù…ØµÙˆØ±ÙŠÙ†)
    // ==========================================
    match /photographer_profiles/{profileId} {
      // Ø§Ù„Ù‚Ø±Ø§Ø¡Ø©: Ø§Ù„Ù…ØµÙˆØ± Ù†ÙØ³Ù‡ Ø£Ùˆ Ø§Ù„Ù…Ø¯Ø±Ø§Ø¡
      allow read: if get(/databases/$(database)/documents/photographer_profiles/$(profileId)).data.user_id == request.auth.uid ||
                     hasAdminAccess() ||
                     hasPermission('users', 'read');
      
      // Ø§Ù„Ø¥Ù†Ø´Ø§Ø¡: Super Admin Ø£Ùˆ Ø§Ù„Ù…ØµÙˆØ± Ù†ÙØ³Ù‡ (Ù„Ù…Ø±Ø© ÙˆØ§Ø­Ø¯Ø©)
      allow create: if (request.resource.data.user_id == request.auth.uid && isPhotographer()) ||
                       isSuperAdmin();
      
      // Ø§Ù„ØªØ­Ø¯ÙŠØ«: Ø§Ù„Ù…ØµÙˆØ± Ù†ÙØ³Ù‡ Ù„Ù„Ø¨ÙŠØ§Ù†Ø§Øª ØºÙŠØ± Ø§Ù„Ù…Ø§Ù„ÙŠØ©ØŒ Ø£Ùˆ Ø§Ù„Ù…Ø¯Ø±Ø§Ø¡ Ù„Ù„ÙƒÙ„
      allow update: if (resource.data.user_id == request.auth.uid && 
                        // Ø§Ù„Ù…ØµÙˆØ± Ù„Ø§ ÙŠÙ…ÙƒÙ†Ù‡ ØªØ¹Ø¯ÙŠÙ„ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù…Ø§Ù„ÙŠØ©
                        !("financial_info" in request.resource.data.diff(resource.data).changedKeys()) &&
                        !("performance_stats" in request.resource.data.diff(resource.data).changedKeys())) ||
                       hasAdminAccess();
      
      // Ø§Ù„Ø­Ø°Ù: Super Admin ÙÙ‚Ø·
      allow delete: if isSuperAdmin();
    }
    
    // ==========================================
    // ğŸ‘” BRAND_COORDINATORS COLLECTION (Ù…Ù†Ø³Ù‚ÙŠ Ø§Ù„Ø¨Ø±Ø§Ù†Ø¯Ø§Øª)
    // ==========================================
    match /brand_coordinators/{coordinatorId} {
      // Ø§Ù„Ù‚Ø±Ø§Ø¡Ø©: Ø§Ù„Ù…Ù†Ø³Ù‚ Ù†ÙØ³Ù‡ Ø£Ùˆ Ø§Ù„Ù…Ø¯Ø±Ø§Ø¡ Ø£Ùˆ Super Admin
      allow read: if get(/databases/$(database)/documents/brand_coordinators/$(coordinatorId)).data.user_id == request.auth.uid ||
                     hasAdminAccess();
      
      // Ø§Ù„Ø¥Ù†Ø´Ø§Ø¡ ÙˆØ§Ù„ØªØ­Ø¯ÙŠØ« ÙˆØ§Ù„Ø­Ø°Ù: Super Admin ÙÙ‚Ø·
      allow create, update, delete: if isSuperAdmin();
    }
    
    // ==========================================
    // ğŸ¢ BRANDS COLLECTION (Ø§Ù„Ø¨Ø±Ø§Ù†Ø¯Ø§Øª)
    // ==========================================
    match /brands/{brandId} {
      // Ø§Ù„Ù‚Ø±Ø§Ø¡Ø©: Ø¬Ù…ÙŠØ¹ Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…ÙŠÙ† Ø§Ù„Ù…ØµØ±Ø­ Ù„Ù‡Ù…
      allow read: if isAuthenticated() && (
                     hasAdminAccess() ||
                     hasBrandAccess(brandId) ||
                     hasPermission('brands', 'read')
                  );
      
      // Ø§Ù„Ø¥Ù†Ø´Ø§Ø¡: Super Admin ÙÙ‚Ø·
      allow create: if isSuperAdmin() || hasPermission('brands', 'create');
      
      // Ø§Ù„ØªØ­Ø¯ÙŠØ«: Super Admin Ø£Ùˆ Brand Coordinator Ù„Ù„Ø¨Ø±Ø§Ù†Ø¯ Ø§Ù„Ù…Ø®ØµØµ Ù„Ù‡
      allow update: if isSuperAdmin() || 
                       hasBrandAccess(brandId) ||
                       hasPermission('brands', 'update');
      
      // Ø§Ù„Ø­Ø°Ù: Super Admin ÙÙ‚Ø·
      allow delete: if isSuperAdmin() || hasPermission('brands', 'delete');
    }
    
    // ==========================================
    // ğŸ“‚ CONTENT_CATEGORIES COLLECTION (Ø§Ù„ÙØ¦Ø§Øª)
    // ==========================================
    match /content_categories/{categoryId} {
      // Ø§Ù„Ù‚Ø±Ø§Ø¡Ø©: Ø¬Ù…ÙŠØ¹ Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…ÙŠÙ† Ø§Ù„Ù…ØµØ±Ø­ Ù„Ù‡Ù…
      allow read: if isAuthenticated();
      
      // Ø§Ù„Ø¥Ù†Ø´Ø§Ø¡ ÙˆØ§Ù„ØªØ­Ø¯ÙŠØ« ÙˆØ§Ù„Ø­Ø°Ù: Super Admin ÙÙ‚Ø·
      allow create, update, delete: if isSuperAdmin() || hasAdminAccess();
    }
    
    // ==========================================
    // ğŸª EQUIPMENT COLLECTION (Ø§Ù„Ù…Ø¹Ø¯Ø§Øª)
    // ==========================================
    match /equipment/{equipmentId} {
      // Ø§Ù„Ù‚Ø±Ø§Ø¡Ø©: Ø¬Ù…ÙŠØ¹ Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…ÙŠÙ† Ø§Ù„Ù…ØµØ±Ø­ Ù„Ù‡Ù…
      allow read: if isAuthenticated();
      
      // Ø§Ù„Ø¥Ù†Ø´Ø§Ø¡ ÙˆØ§Ù„ØªØ­Ø¯ÙŠØ«: Super Admin Ø£Ùˆ Marketing Coordinator
      allow create, update: if hasAdminAccess();
      
      // Ø§Ù„Ø­Ø°Ù: Super Admin ÙÙ‚Ø·
      allow delete: if isSuperAdmin();
    }
    
    // ==========================================
    // ğŸ¬ SMART_CAMPAIGNS COLLECTION (Ø§Ù„Ø­Ù…Ù„Ø§Øª Ø§Ù„Ø°ÙƒÙŠØ©)
    // ==========================================
    match /smart_campaigns/{campaignId} {
      // Ø§Ù„Ù‚Ø±Ø§Ø¡Ø©: Ø¬Ù…ÙŠØ¹ Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…ÙŠÙ† Ø§Ù„Ù…ØµØ±Ø­ Ù„Ù‡Ù…
      allow read: if isAuthenticated() && (
                     hasAdminAccess() ||
                     hasPermission('campaigns', 'read')
                  );
      
      // Ø§Ù„Ø¥Ù†Ø´Ø§Ø¡: Super Admin Ø£Ùˆ Marketing Coordinator
      allow create: if hasAdminAccess() || hasPermission('campaigns', 'create');
      
      // Ø§Ù„ØªØ­Ø¯ÙŠØ«: Super Admin Ø£Ùˆ Marketing Coordinator Ø£Ùˆ Brand Coordinator Ù„Ù„Ø­Ù…Ù„Ø§Øª Ø§Ù„ØªÙŠ ØªØ®Øµ Ø¨Ø±Ø§Ù†Ø¯Ù‡Ù…
      allow update: if hasAdminAccess() || 
                       hasPermission('campaigns', 'update') ||
                       (isBrandCoordinator() && 
                        resource.data.campaign_inputs.target_brands != null &&
                        request.auth.uid in resource.data.campaign_inputs.target_brands);
      
      // Ø§Ù„Ø­Ø°Ù: Super Admin ÙÙ‚Ø·
      allow delete: if isSuperAdmin() || hasPermission('campaigns', 'delete');
    }
    
    // ==========================================
    // ğŸ“‹ CAMPAIGN_TASKS COLLECTION (Ù…Ù‡Ø§Ù… Ø§Ù„Ø­Ù…Ù„Ø§Øª)
    // ==========================================
    match /campaign_tasks/{taskId} {
      // Ø§Ù„Ù‚Ø±Ø§Ø¡Ø©: Ø§Ù„Ù…ØµÙˆØ± Ø§Ù„Ù…ÙƒÙ„Ù Ø£Ùˆ Ø§Ù„Ù…Ø¯Ø±Ø§Ø¡ Ø£Ùˆ Brand Coordinator Ù„Ù„Ø¨Ø±Ø§Ù†Ø¯ Ø§Ù„Ù…Ø­Ø¯Ø¯
      allow read: if isAuthenticated() && (
                     resource.data.assigned_photographer == request.auth.uid ||
                     hasAdminAccess() ||
                     hasBrandAccess(resource.data.brand_id) ||
                     hasPermission('tasks', 'read')
                  );
      
      // Ø§Ù„Ø¥Ù†Ø´Ø§Ø¡: Super Admin Ø£Ùˆ Marketing Coordinator
      allow create: if hasAdminAccess() || hasPermission('tasks', 'create');
      
      // Ø§Ù„ØªØ­Ø¯ÙŠØ«: Ø§Ù„Ù…ØµÙˆØ± Ø§Ù„Ù…ÙƒÙ„Ù Ù„ØªØ­Ø¯ÙŠØ« Ø§Ù„Ø­Ø§Ù„Ø©ØŒ Ø£Ùˆ Ø§Ù„Ù…Ø¯Ø±Ø§Ø¡ØŒ Ø£Ùˆ Brand Coordinator Ù„Ù„Ø¨Ø±Ø§Ù†Ø¯
      allow update: if (resource.data.assigned_photographer == request.auth.uid && 
                        // Ø§Ù„Ù…ØµÙˆØ± ÙŠÙ…ÙƒÙ†Ù‡ ØªØ­Ø¯ÙŠØ« Ø§Ù„Ø­Ø§Ù„Ø© ÙˆØ§Ù„Ù…Ù„Ø§Ø­Ø¸Ø§Øª ÙÙ‚Ø·
                        request.resource.data.diff(resource.data).changedKeys().hasOnly(['status', 'actual_start_time', 'actual_end_time', 'photographer_notes'])) ||
                       hasAdminAccess() ||
                       hasBrandAccess(resource.data.brand_id) ||
                       hasPermission('tasks', 'update');
      
      // Ø§Ù„Ø­Ø°Ù: Super Admin ÙÙ‚Ø·
      allow delete: if isSuperAdmin() || hasPermission('tasks', 'delete');
    }
    
    // ==========================================
    // ğŸ”” CAMPAIGN_NOTIFICATIONS COLLECTION (Ø¥Ø´Ø¹Ø§Ø±Ø§Øª Ø§Ù„Ø­Ù…Ù„Ø§Øª)
    // ==========================================
    match /campaign_notifications/{notificationId} {
      // Ø§Ù„Ù‚Ø±Ø§Ø¡Ø©: Ø§Ù„Ù…Ø³ØªÙ‚Ø¨Ù„ Ø§Ù„Ù…Ø­Ø¯Ø¯ Ø£Ùˆ Ø§Ù„Ù…Ø¯Ø±Ø§Ø¡
      allow read: if isAuthenticated() && (
                     resource.data.recipient_user_id == request.auth.uid ||
                     hasAdminAccess()
                  );
      
      // Ø§Ù„Ø¥Ù†Ø´Ø§Ø¡: Ø§Ù„Ù†Ø¸Ø§Ù… (Super Admin) Ø£Ùˆ Marketing Coordinator
      allow create: if hasAdminAccess();
      
      // Ø§Ù„ØªØ­Ø¯ÙŠØ«: Ø§Ù„Ù…Ø³ØªÙ‚Ø¨Ù„ Ù„ØªØ­Ø¯ÙŠØ¯ Ø§Ù„Ù‚Ø±Ø§Ø¡Ø©ØŒ Ø£Ùˆ Ø§Ù„Ù…Ø¯Ø±Ø§Ø¡
      allow update: if (resource.data.recipient_user_id == request.auth.uid && 
                        request.resource.data.diff(resource.data).changedKeys().hasOnly(['is_read', 'read_at'])) ||
                       hasAdminAccess();
      
      // Ø§Ù„Ø­Ø°Ù: Super Admin ÙÙ‚Ø·
      allow delete: if isSuperAdmin();
    }
    
    // ==========================================
    // ğŸ—‚ï¸ CONTENT COLLECTION (Ø§Ù„Ù…Ø­ØªÙˆÙ‰ Ø§Ù„Ù…Ø±ÙÙˆØ¹)
    // ==========================================
    match /content/{contentId} {
      // Ø§Ù„Ù‚Ø±Ø§Ø¡Ø©: Ø§Ù„Ù…ØµÙˆØ± Ø§Ù„Ù…Ø§Ù„Ùƒ Ø£Ùˆ Ø§Ù„Ù…Ø¯Ø±Ø§Ø¡ Ø£Ùˆ Brand Coordinator Ù„Ù„Ø¨Ø±Ø§Ù†Ø¯ Ø§Ù„Ù…Ø­Ø¯Ø¯
      allow read: if isAuthenticated() && (
                     resource.data.uploaded_by == request.auth.uid ||
                     hasAdminAccess() ||
                     hasBrandAccess(resource.data.brand_id) ||
                     hasPermission('content', 'read')
                  );
      
      // Ø§Ù„Ø¥Ù†Ø´Ø§Ø¡: Ø§Ù„Ù…ØµÙˆØ± Ø§Ù„Ù…Ø®ÙˆÙ„ Ø£Ùˆ Ø§Ù„Ù…Ø¯Ø±Ø§Ø¡
      allow create: if isAuthenticated() && (
                        isPhotographer() ||
                        hasAdminAccess() ||
                        hasPermission('content', 'create')
                     );
      
      // Ø§Ù„ØªØ­Ø¯ÙŠØ«: Ø§Ù„Ù…ØµÙˆØ± Ø§Ù„Ù…Ø§Ù„Ùƒ Ù„Ù„Ù…Ù„Ø§Ø­Ø¸Ø§ØªØŒ Ø£Ùˆ Ø§Ù„Ù…Ø¯Ø±Ø§Ø¡ Ù„Ù„Ù…Ø±Ø§Ø¬Ø¹Ø© ÙˆØ§Ù„Ù…ÙˆØ§ÙÙ‚Ø©
      allow update: if (resource.data.uploaded_by == request.auth.uid && 
                        request.resource.data.diff(resource.data).changedKeys().hasOnly(['photographer_notes', 'tags'])) ||
                       hasAdminAccess() ||
                       hasBrandAccess(resource.data.brand_id) ||
                       hasPermission('content', 'update');
      
      // Ø§Ù„Ø­Ø°Ù: Ø§Ù„Ù…ØµÙˆØ± Ø§Ù„Ù…Ø§Ù„Ùƒ Ø£Ùˆ Super Admin
      allow delete: if resource.data.uploaded_by == request.auth.uid ||
                       isSuperAdmin() ||
                       hasPermission('content', 'delete');
    }
    
    // ==========================================
    // ğŸ’¬ MESSAGES COLLECTION (Ø§Ù„Ø±Ø³Ø§Ø¦Ù„ ÙˆØ§Ù„ØªÙˆØ§ØµÙ„)
    // ==========================================
    match /messages/{messageId} {
      // Ø§Ù„Ù‚Ø±Ø§Ø¡Ø©: Ø§Ù„Ù…Ø±Ø³Ù„ Ø£Ùˆ Ø§Ù„Ù…Ø³ØªÙ‚Ø¨Ù„ Ø£Ùˆ Ø§Ù„Ù…Ø¯Ø±Ø§Ø¡
      allow read: if isAuthenticated() && (
                     resource.data.sender_id == request.auth.uid ||
                     resource.data.recipient_id == request.auth.uid ||
                     hasAdminAccess()
                  );
      
      // Ø§Ù„Ø¥Ù†Ø´Ø§Ø¡: Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… Ø§Ù„Ù…ØµØ±Ø­ Ù„Ù‡
      allow create: if isAuthenticated() && request.resource.data.sender_id == request.auth.uid;
      
      // Ø§Ù„ØªØ­Ø¯ÙŠØ«: Ø§Ù„Ù…Ø³ØªÙ‚Ø¨Ù„ Ù„ØªØ­Ø¯ÙŠØ¯ Ø§Ù„Ù‚Ø±Ø§Ø¡Ø©ØŒ Ø£Ùˆ Ø§Ù„Ù…Ø±Ø³Ù„ Ù„Ù„ØªØ¹Ø¯ÙŠÙ„
      allow update: if (resource.data.recipient_id == request.auth.uid && 
                        request.resource.data.diff(resource.data).changedKeys().hasOnly(['is_read', 'read_at'])) ||
                       (resource.data.sender_id == request.auth.uid &&
                        request.resource.data.diff(resource.data).changedKeys().hasOnly(['message_text'])) ||
                       hasAdminAccess();
      
      // Ø§Ù„Ø­Ø°Ù: Ø§Ù„Ù…Ø±Ø³Ù„ Ø£Ùˆ Super Admin
      allow delete: if resource.data.sender_id == request.auth.uid || isSuperAdmin();
    }
    
    // ==========================================
    // ğŸ“Š REPORTS COLLECTION (Ø§Ù„ØªÙ‚Ø§Ø±ÙŠØ±)
    // ==========================================
    match /reports/{reportId} {
      // Ø§Ù„Ù‚Ø±Ø§Ø¡Ø©: Ø­Ø³Ø¨ Ù†ÙˆØ¹ Ø§Ù„ØªÙ‚Ø±ÙŠØ± ÙˆØ§Ù„ØµÙ„Ø§Ø­ÙŠØ§Øª
      allow read: if isAuthenticated() && (
                     hasAdminAccess() ||
                     hasPermission('reports', 'read') ||
                     // Brand Coordinator ÙŠÙ…ÙƒÙ†Ù‡ Ø±Ø¤ÙŠØ© ØªÙ‚Ø§Ø±ÙŠØ± Ø¨Ø±Ø§Ù†Ø¯Ù‡Ù… ÙÙ‚Ø·
                     (isBrandCoordinator() && resource.data.brand_id != null && hasBrandAccess(resource.data.brand_id))
                  );
      
      // Ø§Ù„Ø¥Ù†Ø´Ø§Ø¡: Ø§Ù„Ù…Ø¯Ø±Ø§Ø¡ ÙÙ‚Ø·
      allow create: if hasAdminAccess() || hasPermission('reports', 'create');
      
      // Ø§Ù„ØªØ­Ø¯ÙŠØ« ÙˆØ§Ù„Ø­Ø°Ù: Super Admin ÙÙ‚Ø·
      allow update, delete: if isSuperAdmin();
    }
    
    // ==========================================
    // âš™ï¸ SYSTEM_SETTINGS COLLECTION (Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª Ø§Ù„Ù†Ø¸Ø§Ù…)
    // ==========================================
    match /system_settings/{settingId} {
      // Ø§Ù„Ù‚Ø±Ø§Ø¡Ø©: Ø§Ù„Ù…Ø¯Ø±Ø§Ø¡ ÙÙ‚Ø·
      allow read: if hasAdminAccess();
      
      // Ø§Ù„Ø¥Ù†Ø´Ø§Ø¡ ÙˆØ§Ù„ØªØ­Ø¯ÙŠØ« ÙˆØ§Ù„Ø­Ø°Ù: Super Admin ÙÙ‚Ø·
      allow create, update, delete: if isSuperAdmin();
    }
    
    // ==========================================
    // ğŸ—‘ï¸ CATCH-ALL RULE (Ù‚Ø§Ø¹Ø¯Ø© Ø§Ù„Ø£Ù…Ø§Ù† Ø§Ù„Ø§ÙØªØ±Ø§Ø¶ÙŠØ©)
    // ==========================================
    // Ø±ÙØ¶ Ø§Ù„ÙˆØµÙˆÙ„ Ù„Ø£ÙŠ collection ØºÙŠØ± Ù…Ø­Ø¯Ø¯ ØµØ±Ø§Ø­Ø©
    match /{document=**} {
      allow read, write: if false;
    }
  }
}

// ==========================================
// ğŸ“ Ù…Ù„Ø§Ø­Ø¸Ø§Øª Ù…Ù‡Ù…Ø©:
// ==========================================
//
// 1. Ù‡Ø°Ù‡ Ø§Ù„Ù‚ÙˆØ§Ø¹Ø¯ ØªØ¯Ø¹Ù… Ù†Ø¸Ø§Ù… Ø§Ù„ØµÙ„Ø§Ø­ÙŠØ§Øª Ø§Ù„Ø¯ÙŠÙ†Ø§Ù…ÙŠÙƒÙŠ Ø§Ù„ÙƒØ§Ù…Ù„
// 2. Super Admin Ù„Ù‡ ØµÙ„Ø§Ø­ÙŠØ§Øª ÙƒØ§Ù…Ù„Ø© Ø¹Ù„Ù‰ ÙƒÙ„ Ø´ÙŠØ¡
// 3. Marketing Coordinator Ù„Ù‡ ØµÙ„Ø§Ø­ÙŠØ§Øª ÙˆØ§Ø³Ø¹Ø© ÙˆÙ„ÙƒÙ† Ù…Ø­Ø¯ÙˆØ¯Ø©
// 4. Brand Coordinator Ù…Ù‚ÙŠØ¯ Ø¨Ø¨Ø±Ø§Ù†Ø¯Ù‡Ù… Ø§Ù„Ù…Ø®ØµØµ ÙÙ‚Ø·
// 5. Photographer Ù…Ù‚ÙŠØ¯ Ø¨Ù…Ù‡Ø§Ù…Ù‡Ù… ÙˆÙ…Ø­ØªÙˆØ§Ù‡Ù… ÙÙ‚Ø·
// 6. Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø¹Ù…Ù„ÙŠØ§Øª Ù…Ø­Ù…ÙŠØ© ÙˆÙ…Ø³Ø¬Ù„Ø©
// 7. Ù„Ø§ ÙŠÙ…ÙƒÙ† Ø§Ù„ÙˆØµÙˆÙ„ Ù„Ø£ÙŠ collection ØºÙŠØ± Ù…Ø­Ø¯Ø¯
//
// âš ï¸ ØªØ­Ø°ÙŠØ±: Ø§Ø®ØªØ¨Ø± Ù‡Ø°Ù‡ Ø§Ù„Ù‚ÙˆØ§Ø¹Ø¯ Ø¬ÙŠØ¯Ø§Ù‹ Ù‚Ø¨Ù„ Ø§Ù„Ù†Ø´Ø± ÙÙŠ Ø§Ù„Ø¥Ù†ØªØ§Ø¬!
//
// ğŸ”„ Ø¢Ø®Ø± ØªØ­Ø¯ÙŠØ«: 31 Ù…Ø§ÙŠÙˆ 2025
// ğŸ‘¨â€ğŸ’» Ø§Ù„Ù…Ø·ÙˆØ±: Ø¹Ù„ÙŠ Ø¬ÙˆØ¯Øª