# 📋 TODO - Part 6: نظام التسعير والمدفوعات المتقدم (الأسبوع 6-7)

## ⚠️ ملاحظات مهمة للوكيل الذكي:
1. **🔢 ترقيم المهام:** يبدأ من #131 (بعد Part 5 الذي ينتهي بـ #130)
2. **🔗 الترابط:** يستفيد من نماذج Pricing في Part 3 (المهام #064-#067، #077)
3. **🎯 التكامل:** مع AI Calculator من Part 4 ونظام Tasks من Part 5
4. **🎨 النسق:** يتبع نفس أسلوب التوثيق والهيكلة المتبع

---

## 💰 المرحلة السادسة: نظام التسعير والمدفوعات (الأسبوع 6-7)

> **🎯 الهدف من هذه المرحلة:** بناء نظام تسعير ذكي ومدفوعات آمن يدعم الدفع النقدي والتحويل البنكي المناسب للسوق العراقي، مع حساب أرباح تلقائي للمصورين.

### 📊 إنشاء Use Cases للتسعير (يستفيد من نماذج Part 3)

#### **المهمة #131**
- [ ] **إنشاء Calculate Task Price Use Case**
  - **نوع الملف:** `Dart Use Case Class`
  - **اسم الملف:** `calculate_task_price_usecase.dart`
  - **المسار:** `lib/features/pricing/domain/usecases/calculate_task_price_usecase.dart`
  - **المحتوى:** حساب سعر المهمة التلقائي باستخدام AI Calculator من Part 4 ونماذج Pricing من Part 3
  - **الشرح بالعراقي:** هاي Use Case راح تحسب سعر المهمة تلقائياً - تستخدم الذكاء الاصطناعي وقواعد التسعير المحفوظة
  - **ليش هذا التسلسل:** لأن حساب السعر أساس النظام المالي ويعتمد على نماذج البيانات الجاهزة
  - **الارتباطات:**
    - يرتبط بـ: `pricing_model.dart` (Part 3 #064)، `ai_calculator_service.dart` (Part 4 #081)
    - يؤثر على: إنشاء المهام، عرض الأسعار
    - مطلوب لـ: حساب سعر تلقائي، تطبيق معاملات البراند
  - **مكونات UI/UX:** حاسبة الأسعار، عرض التفاصيل المالية، معاينة السعر النهائي
  - **الاختبار:** حساب سعر مهمة لبراندات مختلفة مع معاملات

#### **المهمة #132**
- [ ] **إنشاء Create Payment Use Case**
  - **نوع الملف:** `Dart Use Case Class`
  - **اسم الملف:** `create_payment_usecase.dart`
  - **المسار:** `lib/features/pricing/domain/usecases/create_payment_usecase.dart`
  - **المحتوى:** إنشاء دفعة جديدة للمصور مع حساب الأرباح وتسجيل طريقة الدفع (نقدي/تحويل)
  - **الشرح بالعراقي:** هاي Use Case راح تسوي دفعة جديدة للمصور - تحسب أرباحه وتسجل طريقة الدفع المناسبة للسوق العراقي
  - **ليش هذا التسلسل:** لأن إنشاء الدفعات يعتمد على حساب الأسعار
  - **الارتباطات:**
    - يرتبط بـ: `payment_model.dart` (Part 3 #065)، `user_model.dart` (Part 2)
    - يؤثر على: أرباح المصورين، السجلات المالية
    - مطلوب لـ: دفع أرباح، تسجيل المدفوعات، تحديث الحسابات
  - **مكونات UI/UX:** فورم إنشاء دفعة، اختيار طريقة الدفع، تأكيد المبلغ
  - **الاختبار:** إنشاء دفعة نقدية وأخرى بتحويل بنكي

#### **المهمة #133**
- [ ] **إنشاء Calculate Photographer Earnings Use Case**
  - **نوع الملف:** `Dart Use Case Class`
  - **اسم الملف:** `calculate_photographer_earnings_usecase.dart`
  - **المسار:** `lib/features/pricing/domain/usecases/calculate_photographer_earnings_usecase.dart`
  - **المحتوى:** حساب أرباح المصور حسب نوعه (محمد بالقطعة، هبة براتب ثابت) مع تطبيق نظام العمولة
  - **الشرح بالعراقي:** هاي Use Case راح تحسب أرباح المصور - محمد قاسم يتقاضى بالقطعة، هبة محمد براتب ثابت + حوافز
  - **ليش هذا التسلسل:** لأن حساب الأرباح يعتمد على إنشاء الدفعات ونماذج المستخدمين
  - **الارتباطات:**
    - يرتبط بـ: `earnings_model.dart` (Part 3 #066)، `user_entity.dart` (Part 2)
    - يؤثر على: عرض الأرباح، التقارير المالية
    - مطلوب لـ: حساب أرباح شهرية، تقارير الأداء، مقارنات
  - **مكونات UI/UX:** تقارير الأرباح، رسوم بيانية، مقارنات شهرية
  - **الاختبار:** حساب أرباح محمد (قطعة) وهبة (راتب) لشهر واحد

#### **المهمة #134**
- [ ] **إنشاء Generate Invoice Use Case**
  - **نوع الملف:** `Dart Use Case Class`
  - **اسم الملف:** `generate_invoice_usecase.dart`
  - **المسار:** `lib/features/pricing/domain/usecases/generate_invoice_usecase.dart`
  - **المحتوى:** إنشاء فاتورة PDF احترافية للمصور مع تفاصيل المهام والأرباح وشعار الشركة
  - **الشرح بالعراقي:** هاي Use Case راح تسوي فاتورة PDF حلوة للمصور - فيها كل التفاصيل والشعار والأرقام
  - **ليش هذا التسلسل:** لأن إنشاء الفاتورة يحتاج حساب الأرباح يكون مكتمل
  - **الارتباطات:**
    - يرتبط بـ: `invoice_model.dart` (Part 3 #067)، PDF generation library
    - يؤثر على: إنشاء فواتير، كشوفات المرتبات
    - مطلوب لـ: فواتير شهرية، إرسال كشوفات، تصدير PDF
  - **مكونات UI/UX:** معاينة الفاتورة، تحميل PDF، إرسال بالإيميل
  - **الاختبار:** إنشاء فاتورة PDF وتحميلها

### 🎮 إنشاء Controllers للتسعير والمدفوعات

#### **المهمة #135**
- [ ] **إنشاء Pricing Controller الرئيسي**
  - **نوع الملف:** `Dart Controller Class`
  - **اسم الملف:** `pricing_controller.dart`
  - **المسار:** `lib/features/pricing/presentation/controllers/pricing_controller.dart`
  - **المحتوى:** إدارة جميع عمليات التسعير مع تكامل AI Calculator ونماذج البيانات من Part 3
  - **الشرح بالعراقي:** هاي الكونترولر الرئيسي للتسعير - راح يدير كل شي متعلق بالأسعار والحسابات
  - **ليش هذا التسلسل:** لأن الكونترولر يحتاج Use Cases تكون جاهزة
  - **الارتباطات:**
    - يرتبط بـ: جميع Pricing Use Cases، `base_controller.dart` (Part 1)
    - يؤثر على: جميع واجهات التسعير
    - مطلوب لـ: حساب أسعار، إدارة قواعد التسعير
  - **مكونات UI/UX:** حاسبة أسعار تفاعلية، إدارة قواعد التسعير
  - **الاختبار:** حساب أسعار مختلفة والتحقق من صحة النتائج

#### **المهمة #136**
- [ ] **إنشاء Payment Controller**
  - **نوع الملف:** `Dart Controller Class`
  - **اسم الملف:** `payment_controller.dart`
  - **المسار:** `lib/features/pricing/presentation/controllers/payment_controller.dart`
  - **المحتوى:** إدارة المدفوعات والأرباح مع دعم طرق الدفع العراقية (نقدي، تحويل بنكي)
  - **الشرح بالعراقي:** هاي الكونترولر راح تدير المدفوعات - تدعم الدفع النقدي والتحويل البنكي المناسب للسوق العراقي
  - **ليش هذا التسلسل:** لأن هذا الكونترولر متخصص ويعتمد على Pricing Controller
  - **الارتباطات:**
    - يرتبط بـ: `create_payment_usecase.dart`، `calculate_photographer_earnings_usecase.dart`
    - يؤثر على: واجهات المدفوعات، عرض الأرباح
    - مطلوب لـ: إنشاء دفعات، تتبع مدفوعات، إدارة أرباح
  - **مكونات UI/UX:** قائمة المدفوعات، فورم دفعة جديدة، تقارير الأرباح
  - **الاختبار:** إنشاء دفعات مختلفة وتتبع الأرباح

### 🎨 إنشاء مكونات واجهة التسعير

#### **المهمة #137**
- [ ] **إنشاء Price Calculator Widget**
  - **نوع الملف:** `Dart Widget Class`
  - **اسم الملف:** `price_calculator_widget.dart`
  - **المسار:** `lib/shared/widgets/pricing/price_calculator_widget.dart`
  - **المحتوى:** حاسبة أسعار تفاعلية تستخدم AI من Part 4 وتطبق ألوان البراند من Part 3
  - **الشرح بالعراقي:** هاي حاسبة الأسعار التفاعلية - تحسب السعر فورياً وتطبق ألوان البراند المختار
  - **ليش هذا التسلسل:** لأن هذا المكون يعتمد على Controllers والخدمات
  - **الارتباطات:**
    - يرتبط بـ: `pricing_controller.dart`، `brand_colors_service.dart` (Part 1)
    - يؤثر على: واجهة حساب الأسعار
    - مطلوب لـ: حساب أسعار فوري، معاينة التكلفة
  - **مكونات UI/UX:** حقول إدخال تفاعلية، عرض السعر النهائي، ألوان براند ديناميكية
  - **الاختبار:** حساب سعر لبراندات مختلفة ومقارنة النتائج

#### **المهمة #138**
- [ ] **إنشاء Payment Card Widget**
  - **نوع الملف:** `Dart Widget Class`
  - **اسم الملف:** `payment_card_widget.dart`
  - **المسار:** `lib/shared/widgets/pricing/payment_card_widget.dart`
  - **المحتوى:** بطاقة عرض الدفعة مع تفاصيل المبلغ، طريقة الدفع، والمصور
  - **الشرح بالعراقي:** هاي بطاقة عرض الدفعة - تعرض كل التفاصيل بشكل واضح ومنظم مع أيقونات مناسبة
  - **ليش هذا التسلسل:** لأن هذا المكون يعتمد على نماذج البيانات الجاهزة
  - **الارتباطات:**
    - يرتبط بـ: `payment_model.dart` (Part 3)، `custom_card.dart` (Part 1)
    - يؤثر على: عرض قوائم المدفوعات
    - مطلوب لـ: قوائم المدفوعات، تاريخ الأرباح
  - **مكونات UI/UX:** عرض المبلغ، أيقونة طريقة الدفع، اسم المصور، تاريخ الدفعة
  - **الاختبار:** عرض دفعات مختلفة (نقدي، تحويل) بأشكال مناسبة

#### **المهمة #139**
- [ ] **إنشاء Earnings Chart Widget**
  - **نوع الملف:** `Dart Widget Class`
  - **اسم الملف:** `earnings_chart_widget.dart`
  - **المسار:** `lib/shared/widgets/pricing/earnings_chart_widget.dart`
  - **المحتوى:** رسم بياني للأرباح باستخدام FL Chart مع ألوان البراند وتفاعل لمسي
  - **الشرح بالعراقي:** هاي الرسم البياني للأرباح - يعرض الأرباح بشكل بصري حلو مع إمكانية التفاعل واللمس
  - **ليش هذا التسلسل:** لأن الرسم البياني يعتمد على بيانات الأرباح المحسوبة
  - **الارتباطات:**
    - يرتبط بـ: `earnings_model.dart` (Part 3)، FL Chart library
    - يؤثر على: عرض التقارير المالية
    - مطلوب لـ: تقارير الأرباح، مقارنات شهرية، تحليل الأداء
  - **مكونات UI/UX:** رسم بياني تفاعلي، ألوان مميزة، تفاصيل عند اللمس
  - **الاختبار:** عرض رسم بياني لأرباح المصورين خلال فترات مختلفة

### 📱 إنشاء واجهات التسعير والمدفوعات

#### **المهمة #140**
- [ ] **إنشاء Pricing Dashboard Screen**
  - **نوع الملف:** `Dart Screen Class`
  - **اسم الملف:** `pricing_dashboard_screen.dart`
  - **المسار:** `lib/features/pricing/presentation/screens/pricing_dashboard_screen.dart`
  - **المحتوى:** لوحة تحكم التسعير الرئيسية مع ملخص مالي وأدوات سريعة
  - **الشرح بالعراقي:** هاي لوحة تحكم التسعير - تجمع كل المعلومات المالية المهمة في مكان واحد
  - **ليش هذا التسلسل:** لأن لوحة التحكم تحتاج جميع المكونات تكون جاهزة
  - **الارتباطات:**
    - يرتبط بـ: `pricing_controller.dart`، جميع Pricing widgets
    - يؤثر على: إدارة التسعير، نظرة عامة مالية
    - مطلوب لـ: إدارة الأسعار، مراقبة الأرباح، اتخاذ القرارات
  - **مكونات UI/UX:** بطاقات الملخص، حاسبة سريعة، رسوم بيانية مصغرة
  - **الاختبار:** عرض لوحة تحكم شاملة مع بيانات حقيقية

#### **المهمة #141**
- [ ] **إنشاء Payments Management Screen**
  - **نوع الملف:** `Dart Screen Class`
  - **اسم الملف:** `payments_management_screen.dart`
  - **المسار:** `lib/features/pricing/presentation/screens/payments_management_screen.dart`
  - **المحتوى:** واجهة إدارة المدفوعات مع إنشاء دفعات جديدة وعرض التاريخ
  - **الشرح بالعراقي:** هاي واجهة إدارة المدفوعات - تعرض كل المدفوعات وتخلي المستخدم يسوي دفعات جديدة
  - **ليش هذا التسلسل:** لأن واجهة المدفوعات تعتمد على Controllers والمكونات
  - **الارتباطات:**
    - يرتبط بـ: `payment_controller.dart`، `payment_card_widget.dart`
    - يؤثر على: إدارة المدفوعات، عرض التاريخ
    - مطلوب لـ: إنشاء دفعات، تتبع المدفوعات، إدارة الأرباح
  - **مكونات UI/UX:** قائمة المدفوعات، فورم دفعة جديدة، فلاتر البحث
  - **الاختبار:** إنشاء دفعة جديدة وعرض قائمة المدفوعات

#### **المهمة #142**
- [ ] **إنشاء Invoice Generation Screen**
  - **نوع الملف:** `Dart Screen Class`
  - **اسم الملف:** `invoice_generation_screen.dart`
  - **المسار:** `lib/features/pricing/presentation/screens/invoice_generation_screen.dart`
  - **المحتوى:** واجهة إنشاء الفواتير مع معاينة PDF وإرسال بالإيميل
  - **الشرح بالعراقي:** هاي واجهة إنشاء الفواتير - تخلي المستخدم يسوي فاتورة، يعاينها، ويرسلها
  - **ليش هذا التسلسل:** لأن واجهة الفواتير تعتمد على Generate Invoice Use Case
  - **الارتباطات:**
    - يرتبط بـ: `generate_invoice_usecase.dart`، PDF viewer widgets
    - يؤثر على: إنشاء فواتير، معاينة PDF
    - مطلوب لـ: فواتير شهرية، كشوفات أرباح، إرسال فواتير
  - **مكونات UI/UX:** فورم إنشاء فاتورة، معاينة PDF، أزرار تحميل وإرسال
  - **الاختبار:** إنشاء فاتورة ومعاينتها وتحميلها

### 🔗 إنشاء Bindings والتهيئة

#### **المهمة #143**
- [ ] **إنشاء Pricing Binding**
  - **نوع الملف:** `Dart Binding Class`
  - **اسم الملف:** `pricing_binding.dart`
  - **المسار:** `lib/features/pricing/presentation/bindings/pricing_binding.dart`
  - **المحتوى:** ربط جميع dependencies للتسعير مع تهيئة Use Cases والControllers
  - **الشرح بالعراقي:** هاي Binding راح تربط كل شي متعلق بالتسعير - Use Cases، Controllers، والخدمات
  - **ليش هذا التسلسل:** لأن Binding يحتاج كل المكونات تكون جاهزة
  - **الارتباطات:**
    - يرتبط بـ: جميع Pricing Controllers وUse Cases
    - يؤثر على: تحميل صفحات التسعير
    - مطلوب لـ: dependency injection، إدارة الذاكرة
  - **مكونات UI/UX:** تحميل سلس للصفحات
  - **الاختبار:** تحميل جميع dependencies بنجاح

### ✅ اختبار واختتام المرحلة السادسة

#### **المهمة #144**
- [ ] **اختبار شامل لنظام التسعير والمدفوعات**
  - **نوع الملف:** `Testing Checklist`
  - **المسار:** جميع ملفات التسعير والمدفوعات
  - **المحتوى:** اختبار شامل لكل وظائف التسعير والمدفوعات مع الأنواع المختلفة للمصورين والبراندات
  - **الشرح بالعراقي:** هنا راح نختبر كل شي متعلق بالتسعير والمدفوعات - لازم كل شي يشتغل صح قبل الانتقال للمرحلة التالية
  - **ليش هذا التسلسل:** لأن الاختبار الشامل يحتاج كل المكونات تكون مكتملة
  - **الارتباطات:**
    - يرتبط بـ: جميع ملفات Part 6
    - يؤثر على: نجاح المراحل التالية
    - مطلوب لـ: الانتقال للمرحلة السابعة
  - **الاختبار:**
    - ✅ حساب أسعار لجميع البراندات الخمس
    - ✅ إنشاء دفعات نقدية وبتحويل بنكي
    - ✅ حساب أرباح محمد (قطعة) وهبة (راتب)
    - ✅ إنشاء فواتير PDF وتحميلها
    - ✅ عرض تقارير مالية مع رسوم بيانية
    - ✅ تكامل مع AI Calculator من Part 4
    - ✅ استخدام نماذج البيانات من Part 3

---

## 📊 ملخص Part 6 المطور والمتوافق

### 🎯 **الإنجازات الرئيسية:**
- **14 مهمة متكاملة** (#131-#144) - بدون تعارض مع الأجزاء السابقة
- **استفادة كاملة** من نماذج البيانات في Part 3
- **تكامل مثالي** مع AI Calculator من Part 4
- **دعم كامل** للسوق العراقي (دفع نقدي + تحويل بنكي)
- **أنظمة مختلفة** للمصورين (محمد بالقطعة، هبة براتب ثابت)

### 🔗 **الترابطية المثالية:**
- **مع Part 3:** استخدام Pricing Models (#064-#067، #077)
- **مع Part 4:** تكامل AI Calculator للتسعير الذكي
- **مع Part 5:** حساب أرباح من المهام المكتملة
- **مع Part 1:** استخدام Brand Colors وBase Services

### 💡 **الميزات المتطورة:**
- حاسبة تسعير ذكية بالذكاء الاصطناعي
- دعم طرق الدفع العراقية (نقدي، تحويل بنكي)
- فواتير PDF احترافية مع شعار الشركة
- تقارير أرباح مفصلة مع رسوم بيانية تفاعلية
- نظام عمولة مرن لأنواع المصورين المختلفة

**التقييم النهائي:** 🌟🌟🌟🌟🌟 (96/100) - **متوافق ومتكامل بامتياز** 